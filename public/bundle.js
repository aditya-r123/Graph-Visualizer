(()=>{"use strict";var e={56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},72:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var o={},a=[],s=0;s<e.length;s++){var d=e[s],l=r.base?d[0]+r.base:d[0],c=o[l]||0,h="".concat(l," ").concat(c);o[l]=c+1;var g=n(h),p={css:d[1],media:d[2],sourceMap:d[3],supports:d[4],layer:d[5]};if(-1!==g)t[g].references++,t[g].updater(p);else{var m=i(p,r);r.byIndex=s,t.splice(s,0,{identifier:h,updater:m,references:1})}a.push(h)}return a}function i(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,i){var o=r(e=e||[],i=i||{});return function(e){e=e||[];for(var a=0;a<o.length;a++){var s=n(o[a]);t[s].references--}for(var d=r(e,i),l=0;l<o.length;l++){var c=n(o[l]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}o=d}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n}).join("")},t.i=function(e,n,r,i,o){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var s=0;s<this.length;s++){var d=this[s][0];null!=d&&(a[d]=!0)}for(var l=0;l<e.length;l++){var c=[].concat(e[l]);r&&a[c[0]]||(void 0!==o&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=o),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),i&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=i):c[4]="".concat(i)),t.push(c))}},t}},365:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(601),i=n.n(r),o=n(314),a=n.n(o)()(i());a.push([e.id,'/* Reset and Base Styles */\n* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\nhtml, body {\n    margin: 0;\n    padding: 0;\n    width: 100%;\n    height: 100%;\n    overflow: auto !important; /* Allow scrollbars */\n}\n\n:root {\n    /* Dark Theme (Default) */\n    --primary-color: #6366f1;\n    --primary-dark: #4f46e5;\n    --secondary-color: #8b5cf6;\n    --accent-color: #06b6d4;\n    --success-color: #10b981;\n    --danger-color: #ef4444;\n    --warning-color: #f59e0b;\n    --info-color: #3b82f6;\n    \n    --bg-primary: #0f172a;\n    --bg-secondary: #1e293b;\n    --bg-tertiary: #334155;\n    --bg-card: rgba(30, 41, 59, 0.8);\n    \n    --text-primary: #f8fafc;\n    --text-secondary: #cbd5e1;\n    --text-muted: #64748b;\n    \n    --border-color: #475569;\n    --border-light: #64748b;\n    \n    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);\n    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);\n    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);\n    --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);\n    \n    --radius-sm: 0.375rem;\n    --radius-md: 0.5rem;\n    --radius-lg: 0.75rem;\n    --radius-xl: 1rem;\n    \n    --transition: all 0.9s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n/* Light Theme */\n[data-theme="light"] {\n    --primary-color: #6366f1;\n    --primary-dark: #4f46e5;\n    --secondary-color: #8b5cf6;\n    --accent-color: #06b6d4;\n    --success-color: #10b981;\n    --danger-color: #ef4444;\n    --warning-color: #f59e0b;\n    --info-color: #3b82f6;\n    \n    --bg-primary: #87ceeb;\n    --bg-secondary: #b0e0e6;\n    --bg-tertiary: #add8e6;\n    --bg-card: rgba(176, 224, 230, 0.9);\n    \n    --text-primary: #1e293b;\n    --text-secondary: #475569;\n    --text-muted: #64748b;\n    \n    --border-color: #87cefa;\n    --border-light: #b0e0e6;\n    \n    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);\n    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);\n    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);\n    --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);\n}\n\nbody {\n    font-family: \'Inter\', -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif;\n    background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);\n    color: var(--text-primary);\n    min-height: 100vh;\n    overflow: auto !important; /* Allow scrollbars */\n    transition: var(--transition);\n    margin: 0;\n    padding: 0;\n}\n\n/* App Container */\n.app-container {\n    display: grid;\n    grid-template-columns: 280px 1fr;\n    grid-template-rows: 1fr;\n    height: 100vh;\n    gap: 0;\n    margin: 0;\n    padding: 0;\n    overflow-x: auto !important;\n    min-width: 0;\n}\n\n/* Fade out sidebars when instructions are active */\n.app-container.instructions-active .sidebar,\n.app-container.instructions-active .right-sidebar {\n    opacity: 0.3;\n    pointer-events: none;\n    transition: opacity 0.3s ease;\n}\n\n/* Sidebar */\n.sidebar {\n    background: var(--bg-secondary);\n    display: flex;\n    flex-direction: column;\n    overflow-y: auto;\n    scrollbar-width: thin;\n    scrollbar-color: var(--border-color) transparent;\n    transition: var(--transition);\n    margin-left: 0;\n    padding-left: 0;\n}\n\n.sidebar::-webkit-scrollbar {\n    width: 6px;\n}\n\n.sidebar::-webkit-scrollbar-track {\n    background: transparent;\n}\n\n.sidebar::-webkit-scrollbar-thumb {\n    background: var(--border-color);\n    border-radius: 3px;\n}\n\n.sidebar-header {\n    padding: 1rem;\n    border-bottom: 1px solid var(--border-color);\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n}\n\n.logo {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    cursor: pointer;\n    transition: all 0.1s cubic-bezier(0.4, 0, 0.2, 1);\n    padding: 0.25rem;\n    border-radius: var(--radius-md);\n    position: relative;\n    overflow: hidden;\n    \n    /* CSS Custom Properties for dynamic glow */\n    --glow-intensity: 0.3;\n    --glow-radius: 20px;\n    --glow-opacity: 0.3;\n    --pulse-frequency: 2s;\n    --glow-hue: 240;\n}\n\n.logo::before {\n    content: \'\';\n    position: absolute;\n    top: 0;\n    left: -100%;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.2), transparent);\n    transition: left 0.6s ease;\n    z-index: 1;\n}\n\n.logo.logo-hover::before {\n    left: 100%;\n}\n\n.logo i {\n    font-size: 1.25rem;\n    color: var(--primary-color);\n    transition: all 0.1s cubic-bezier(0.4, 0, 0.2, 1);\n    position: relative;\n    z-index: 2;\n}\n\n.logo.logo-hover i {\n    color: hsl(var(--glow-hue), 70%, 70%);\n    transform: scale(1.05);\n    filter: drop-shadow(0 0 8px hsla(var(--glow-hue), 70%, 70%, 0.6));\n    animation: logoIconPulse 2s ease-in-out infinite;\n}\n\n.logo h1 {\n    font-size: 1rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    transition: all 0.1s cubic-bezier(0.4, 0, 0.2, 1);\n    position: relative;\n    z-index: 2;\n    text-shadow: 0 0 0 transparent;\n}\n\n.logo.logo-hover h1 {\n    color: hsl(var(--glow-hue), 70%, 95%);\n    text-shadow: 0 0 6px hsla(var(--glow-hue), 70%, 70%, 0.5);\n    transform: scale(1.02);\n    animation: logoTextGlow 2s ease-in-out infinite;\n}\n\n.logo.logo-hover {\n    background: linear-gradient(135deg, \n        hsla(var(--glow-hue), 70%, 70%, 0.1) 0%, \n        hsla(calc(var(--glow-hue) + 30), 70%, 70%, 0.1) 50%, \n        hsla(calc(var(--glow-hue) + 60), 70%, 70%, 0.1) 100%);\n    box-shadow: 0 0 12px hsla(var(--glow-hue), 70%, 70%, 0.3);\n    transform: translateY(-2px);\n}\n\n@keyframes logoIconPulse {\n    0%, 100% {\n        transform: scale(1.05);\n        filter: drop-shadow(0 0 8px hsla(var(--glow-hue), 70%, 70%, 0.6));\n    }\n    50% {\n        transform: scale(1.08);\n        filter: drop-shadow(0 0 12px hsla(var(--glow-hue), 70%, 70%, 0.8));\n    }\n}\n\n@keyframes logoTextGlow {\n    0%, 100% {\n        text-shadow: 0 0 6px hsla(var(--glow-hue), 70%, 70%, 0.5);\n    }\n    50% {\n        text-shadow: 0 0 10px hsla(var(--glow-hue), 70%, 70%, 0.7);\n    }\n}\n\n.header-buttons {\n    display: flex;\n    align-items: center;\n    gap: 0.25rem;\n}\n\n.help-btn {\n    background: var(--bg-tertiary);\n    border: 1px solid var(--border-color);\n    border-radius: var(--radius-md);\n    padding: 0.375rem;\n    color: var(--text-primary);\n    cursor: pointer;\n    transition: var(--transition);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 32px;\n    height: 32px;\n}\n\n.help-btn:hover {\n    background: var(--border-color);\n    transform: scale(1.05);\n    color: var(--primary-color);\n}\n\n.help-btn i {\n    font-size: 1rem;\n}\n\n\n\n.theme-toggle {\n    background: var(--bg-tertiary);\n    border: 1px solid var(--border-color);\n    border-radius: var(--radius-md);\n    padding: 0.375rem;\n    color: var(--text-primary);\n    cursor: pointer;\n    transition: var(--transition);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 32px;\n    height: 32px;\n}\n\n.theme-toggle:hover {\n    background: var(--border-color);\n    transform: scale(1.05);\n}\n\n.theme-icon {\n    position: relative;\n    width: 20px;\n    height: 20px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    z-index: 1;\n}\n\n.sun-icon,\n.moon-icon {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n    filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.1));\n}\n\n.sun-icon {\n    opacity: 0;\n    transform: translate(-50%, -50%) scale(0.7) rotate(-15deg);\n}\n\n.moon-icon {\n    opacity: 1;\n    transform: translate(-50%, -50%) scale(0.9);\n}\n\n/* Dark theme - show moon (default) */\n[data-theme="dark"] .sun-icon {\n    opacity: 0;\n    transform: translate(-50%, -50%) scale(0.7) rotate(-15deg);\n}\n\n[data-theme="dark"] .moon-icon {\n    opacity: 1;\n    transform: translate(-50%, -50%) scale(0.9);\n}\n\n/* Light theme - show sun */\n[data-theme="light"] .sun-icon {\n    opacity: 1;\n    transform: translate(-50%, -50%) scale(0.9) rotate(0deg);\n}\n\n[data-theme="light"] .moon-icon {\n    opacity: 0;\n    transform: translate(-50%, -50%) scale(0.7) rotate(15deg);\n}\n\n/* Eye tracking animation */\n.eye-socket {\n    transition: all 0.1s ease-out;\n}\n\n.eye {\n    transition: all 0.1s ease-out;\n}\n\n.pupil {\n    transition: all 0.1s ease-out;\n    transform-origin: center;\n}\n\n.sidebar-content {\n    flex: 1;\n    padding: 1.5rem;\n    overflow-y: auto;\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n}\n\n/* Scroll Indicator */\n.scroll-indicator {\n    position: absolute;\n    bottom: 0.5rem;\n    right: 0.5rem;\n    background: var(--bg-card);\n    border: 1px solid var(--border-color);\n    border-radius: var(--radius-md);\n    padding: 0.5rem 0.75rem;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    z-index: 10;\n    opacity: 0;\n    transition: var(--transition);\n    box-shadow: var(--shadow-md);\n    backdrop-filter: blur(10px);\n    max-width: 200px;\n}\n\n.scroll-indicator.show {\n    opacity: 1;\n    animation: slideInUp 0.3s ease-out;\n}\n\n.scroll-arrow {\n    color: var(--primary-color);\n    animation: bounce 2s infinite;\n    font-size: 0.875rem;\n}\n\n.scroll-text {\n    font-size: 0.75rem;\n    color: var(--text-secondary);\n    font-weight: 500;\n    white-space: nowrap;\n}\n\n@keyframes slideInUp {\n    from {\n        opacity: 0;\n        transform: translateY(10px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n@keyframes bounce {\n    0%, 20%, 50%, 80%, 100% {\n        transform: translateY(0);\n    }\n    40% {\n        transform: translateY(-3px);\n    }\n    60% {\n        transform: translateY(-1px);\n    }\n}\n\n.control-section {\n    background: var(--bg-secondary);\n    border-radius: var(--radius-lg);\n    padding: 1.25rem;\n    border: 1px solid var(--border-color);\n    transition: var(--transition);\n}\n\n.control-section h3 {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    font-size: 0.875rem;\n    font-weight: 600;\n    color: var(--text-secondary);\n    margin-bottom: 1rem;\n    text-transform: uppercase;\n    letter-spacing: 0.05em;\n}\n\n.control-section h3 i {\n    color: var(--primary-color);\n}\n\n.control-group {\n    margin-bottom: 1.25rem;\n}\n\n.control-group:last-child {\n    margin-bottom: 0;\n}\n\n.control-group label {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    font-size: 0.875rem;\n    font-weight: 500;\n    color: var(--text-primary);\n    margin-bottom: 0.5rem;\n}\n\n.control-group label i {\n    color: var(--accent-color);\n    width: 16px;\n}\n\n.control-group small {\n    font-size: 0.75rem;\n    color: var(--text-muted);\n    margin-top: 0.25rem;\n    display: block;\n}\n\n.slider-container {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.slider-container input[type="range"] {\n    flex: 1;\n    height: 6px;\n    background: var(--bg-tertiary);\n    border-radius: 3px;\n    outline: none;\n    -webkit-appearance: none;\n}\n\n.slider-container input[type="range"]::-webkit-slider-thumb {\n    -webkit-appearance: none;\n    width: 18px;\n    height: 18px;\n    background: var(--primary-color);\n    border-radius: 50%;\n    cursor: pointer;\n    transition: var(--transition);\n}\n\n.slider-container input[type="range"]::-webkit-slider-thumb:hover {\n    background: var(--primary-dark);\n    transform: scale(1.1);\n}\n\n.slider-container span {\n    font-size: 0.875rem;\n    font-weight: 600;\n    color: var(--primary-color);\n    min-width: 2rem;\n    text-align: center;\n}\n\n.control-group input[type="number"],\n.control-group input[type="text"],\n.control-group select {\n    width: 100%;\n    padding: 0.75rem;\n    background: var(--bg-tertiary);\n    border: 1px solid var(--border-color);\n    border-radius: var(--radius-md);\n    color: var(--text-primary);\n    font-size: 0.875rem;\n    transition: var(--transition);\n    appearance: none;\n    -webkit-appearance: none;\n    -moz-appearance: textfield;\n}\n\n.control-group input[type="number"]:focus,\n.control-group input[type="text"]:focus,\n.control-group select:focus {\n    outline: none;\n    border-color: var(--primary-color);\n    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);\n}\n\n.control-group input[type="number"]::placeholder,\n.control-group input[type="text"]::placeholder {\n    color: var(--text-muted);\n    font-size: 0.75rem;\n}\n\n/* Override browser default styling for number inputs */\n.control-group input[type="number"] {\n    background: var(--bg-tertiary) !important;\n    color: var(--text-primary) !important;\n}\n\n/* Remove spinner buttons from number inputs */\n.control-group input[type="number"]::-webkit-outer-spin-button,\n.control-group input[type="number"]::-webkit-inner-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n}\n\n.control-group input[type="number"]::-moz-inner-spin-button,\n.control-group input[type="number"]::-moz-outer-spin-button {\n    -moz-appearance: textfield;\n}\n\n/* Color input styles */\n.control-group input[type="color"] {\n    width: 100%;\n    height: 40px;\n    border: 1px solid var(--border-color);\n    border-radius: var(--radius-md);\n    background: var(--bg-secondary);\n    cursor: pointer;\n    transition: var(--transition);\n    padding: 0;\n    appearance: none;\n    -webkit-appearance: none;\n}\n\n.control-group input[type="color"]:hover {\n    border-color: var(--primary-color);\n    transform: scale(1.02);\n}\n\n.control-group input[type="color"]:focus {\n    outline: none;\n    border-color: var(--primary-color);\n    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);\n}\n\n/* Color input webkit styles */\n.control-group input[type="color"]::-webkit-color-swatch-wrapper {\n    padding: 0;\n    border-radius: var(--radius-md);\n}\n\n.control-group input[type="color"]::-webkit-color-swatch {\n    border: none;\n    border-radius: var(--radius-md);\n    box-shadow: var(--shadow-sm);\n}\n\n.edit-label-container {\n    display: flex;\n    gap: 0.5rem;\n    align-items: center;\n}\n\n.edit-label-container input {\n    flex: 1;\n}\n\n.edit-label-buttons {\n    display: flex;\n    gap: 0.25rem;\n}\n\n.btn-sm {\n    padding: 0.375rem 0.5rem;\n    font-size: 0.75rem;\n    min-width: auto;\n    width: 32px;\n    height: 32px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.btn-sm i {\n    font-size: 0.75rem;\n}\n\n/* Modal Styles */\n.modal-overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(0, 0, 0, 0.7);\n    backdrop-filter: blur(10px);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    z-index: 1000;\n    animation: fadeIn 0.3s ease-out;\n}\n\n.modal-content {\n    background: var(--bg-card);\n    border: 1px solid var(--border-color);\n    border-radius: var(--radius-lg);\n    padding: 2rem;\n    max-width: 500px;\n    width: 90%;\n    max-height: 80vh;\n    overflow-y: auto;\n    box-shadow: var(--shadow-xl);\n    animation: slideIn 0.3s ease-out;\n}\n\n.modal-content h3 {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n    font-size: 1.25rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    margin-bottom: 1rem;\n}\n\n.modal-content h3 i {\n    color: var(--primary-color);\n}\n\n.modal-content p {\n    color: var(--text-secondary);\n    margin-bottom: 1.5rem;\n    line-height: 1.6;\n}\n\n.modal-buttons {\n    display: flex;\n    gap: 0.75rem;\n    justify-content: flex-end;\n    margin-top: 1.5rem;\n}\n\n.load-options {\n    display: flex;\n    flex-direction: column;\n    gap: 1.5rem;\n}\n\n.load-section {\n    border: 1px solid var(--border-color);\n    border-radius: var(--radius-md);\n    padding: 1rem;\n}\n\n.load-section h4 {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    font-size: 0.875rem;\n    font-weight: 600;\n    color: var(--text-secondary);\n    margin-bottom: 0.75rem;\n    text-transform: uppercase;\n    letter-spacing: 0.05em;\n}\n\n.load-section h4 i {\n    color: var(--primary-color);\n}\n\n.load-graphs-list {\n    max-height: 350px;\n    overflow-y: auto;\n}\n\n.load-graph-item {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0.3rem 0.5rem;\n    border: 1px solid var(--border-color);\n    border-radius: var(--radius-md);\n    margin-bottom: 0.2rem;\n    background: var(--bg-secondary);\n    transition: var(--transition);\n    min-height: 32px;\n}\n\n.load-graph-actions {\n    display: flex;\n    gap: 0.15rem;\n    align-items: center;\n}\n\n.load-graph-item:hover {\n    background: var(--bg-tertiary);\n    border-color: var(--primary-color);\n}\n\n.load-graph-item.pending-delete {\n    border-color: var(--danger-color);\n    border-width: 2px;\n    background: rgba(239, 68, 68, 0.1);\n    position: relative;\n}\n\n/* Always show solid colors for action buttons in pending-delete state */\n.load-graph-item.pending-delete .load-graph-actions .confirm-delete-btn {\n    background: var(--success-color) !important;\n    color: white !important;\n    border: 1px solid var(--success-color) !important;\n}\n\n.load-graph-item.pending-delete .load-graph-actions .delete-btn {\n    background: var(--danger-color) !important;\n    color: white !important;\n    border: 1px solid var(--danger-color) !important;\n}\n\n/* Light blue edit button for load window */\n.load-graph-actions .edit-name-btn {\n    border-color: #60a5fa !important;\n    color: #60a5fa !important;\n}\n\n.load-graph-actions .edit-name-btn:hover {\n    background: #60a5fa !important;\n    color: white !important;\n    border-color: #60a5fa !important;\n}\n\n\n\n.load-graph-info {\n    flex: 1;\n}\n\n.load-graph-name {\n    font-weight: 600;\n    color: var(--text-primary);\n    margin-bottom: 0.12rem;\n    font-size: 0.92rem;\n}\n\n.load-graph-details {\n    font-size: 0.68rem;\n    color: var(--text-secondary);\n    margin-bottom: 0.12rem;\n}\n\n.load-graph-time {\n    font-size: 0.68rem;\n    color: var(--text-muted);\n}\n\n.load-graph-btn {\n    padding: 0.3rem 0.7rem;\n    font-size: 0.78rem;\n}\n\n.no-graphs {\n    text-align: center;\n    color: var(--text-muted);\n    font-style: italic;\n    padding: 1rem;\n}\n\n/* Buttons */\n.button-group {\n    display: flex;\n    flex-direction: column;\n    gap: 0.75rem;\n}\n\n.btn {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 0.5rem;\n    padding: 0.75rem 1rem;\n    border: none;\n    border-radius: var(--radius-md);\n    font-size: 0.875rem;\n    font-weight: 500;\n    cursor: pointer;\n    transition: var(--transition);\n    text-decoration: none;\n    position: relative;\n    overflow: hidden;\n}\n\n.btn:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n    transform: none !important;\n}\n\n.btn::before {\n    content: \'\';\n    position: absolute;\n    top: 0;\n    left: -100%;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);\n    transition: left 0.5s;\n}\n\n.btn:hover:not(:disabled)::before {\n    left: 100%;\n}\n\n.btn-primary {\n    background: linear-gradient(135deg, #818cf8, #6366f1);\n    color: white;\n}\n\n.btn-primary:hover:not(:disabled) {\n    background: linear-gradient(135deg, #6366f1, #4f46e5);\n    transform: translateY(-2px);\n    box-shadow: var(--shadow-lg);\n    color: white;\n}\n\n.btn-primary.active {\n    background: linear-gradient(135deg, var(--success-color), #059669);\n    animation: pulse 2s infinite;\n}\n\n.btn-secondary {\n    background: var(--bg-tertiary);\n    color: var(--text-primary);\n    border: 1px solid var(--border-color);\n}\n\n.btn-secondary:hover:not(:disabled) {\n    background: var(--border-color);\n    transform: translateY(-1px);\n}\n\n.btn-success {\n    background: linear-gradient(135deg, #34d399, #10b981);\n    color: white;\n}\n\n.btn-success:hover:not(:disabled) {\n    background: linear-gradient(135deg, #10b981, #059669);\n    transform: translateY(-2px);\n    box-shadow: var(--shadow-lg);\n    color: white;\n}\n\n.btn-danger {\n    background: linear-gradient(135deg, #f87171, #ef4444);\n    color: white;\n}\n\n.btn-danger:hover:not(:disabled) {\n    background: linear-gradient(135deg, #ef4444, #dc2626);\n    transform: translateY(-2px);\n    box-shadow: var(--shadow-lg);\n    color: white;\n}\n\n.btn-warning {\n    background: linear-gradient(135deg, #fbbf24, #d97706);\n    color: white;\n}\n\n.btn-warning:hover:not(:disabled) {\n    background: linear-gradient(135deg, #f59e0b, #b45309);\n    transform: translateY(-2px);\n    box-shadow: var(--shadow-lg);\n    color: white;\n}\n\n.btn-info {\n    background: linear-gradient(135deg, #60a5fa, #2563eb);\n    color: white;\n}\n\n.btn-info:hover:not(:disabled) {\n    background: linear-gradient(135deg, #3b82f6, #1d4ed8);\n    transform: translateY(-2px);\n    box-shadow: var(--shadow-lg);\n    color: white;\n}\n\n/* Saved Graphs */\n.saved-graphs {\n    margin-top: 0.5rem;\n    padding-top: 0.5rem;\n}\n\n.saved-graphs h4 {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    font-size: 0.75rem;\n    font-weight: 600;\n    color: var(--text-secondary);\n    margin-bottom: 0.75rem;\n    text-transform: uppercase;\n    letter-spacing: 0.05em;\n}\n\n.saved-graphs h4 i {\n    color: var(--accent-color);\n}\n\n.saved-graphs-list {\n    max-height: 350px;\n    overflow-y: auto;\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n}\n\n.saved-graph-item {\n    background: var(--bg-tertiary);\n    border: 1px solid var(--border-color);\n    border-radius: var(--radius-sm);\n    padding: 0.5rem;\n    cursor: pointer;\n    transition: var(--transition);\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    position: relative;\n    margin-bottom: 0.25rem;\n}\n\n.saved-graph-name {\n    font-size: 0.8rem;\n    font-weight: 500;\n    color: var(--text-primary);\n    margin-bottom: 0.12rem;\n}\n\n.saved-graph-details {\n    font-size: 0.68rem;\n    color: var(--text-muted);\n}\n\n.saved-graph-time {\n    font-size: 0.65rem;\n    color: var(--text-muted);\n    font-style: italic;\n    margin-top: 0.12rem;\n}\n\n.saved-graph-actions button {\n    background: none;\n    border: none;\n    color: var(--text-muted);\n    cursor: pointer;\n    padding: 0.18rem 0.3rem;\n    border-radius: var(--radius-sm);\n    transition: var(--transition);\n    font-size: 0.8rem;\n}\n\n.saved-graph-item:hover {\n    background: var(--border-color);\n    transform: translateX(2px);\n    border-color: var(--primary-color);\n}\n\n.saved-graph-item::before {\n    content: \'📁\';\n    position: absolute;\n    left: -20px;\n    top: 50%;\n    transform: translateY(-50%);\n    opacity: 0;\n    transition: var(--transition);\n    font-size: 0.875rem;\n}\n\n.saved-graph-item:hover::before {\n    opacity: 1;\n    left: -15px;\n}\n\n.saved-graph-info {\n    flex: 1;\n}\n\n.saved-graph-name {\n    font-size: 0.8rem;\n    font-weight: 500;\n    color: var(--text-primary);\n    margin-bottom: 0.12rem;\n}\n\n.saved-graph-details {\n    font-size: 0.68rem;\n    color: var(--text-muted);\n}\n\n.saved-graph-time {\n    font-size: 0.65rem;\n    color: var(--text-muted);\n    font-style: italic;\n    margin-top: 0.12rem;\n}\n\n.saved-graph-actions {\n    display: flex;\n    gap: 0.2rem;\n}\n\n.saved-graph-actions button {\n    padding: 0.18rem 0.3rem;\n    font-size: 0.8rem;\n}\n\n.saved-graph-actions button:hover {\n    background: var(--border-color);\n    color: var(--text-primary);\n}\n\n.saved-graph-actions .edit-name-btn:hover {\n    color: var(--info-color);\n}\n\n.saved-graph-actions .delete-btn:hover {\n    color: var(--danger-color);\n}\n\n.saved-graph-item.pending-delete {\n    border-color: var(--danger-color);\n    border-width: 2px;\n    background: rgba(239, 68, 68, 0.1);\n    position: relative;\n}\n\n/* Always show solid colors for action buttons in pending-delete state */\n.saved-graph-item.pending-delete .saved-graph-actions .confirm-delete-btn {\n    background: var(--success-color) !important;\n    color: white !important;\n    border: 1px solid var(--success-color) !important;\n}\n\n.saved-graph-item.pending-delete .saved-graph-actions .delete-btn {\n    background: var(--danger-color) !important;\n    color: white !important;\n    border: 1px solid var(--danger-color) !important;\n}\n\n.saved-graph-item.pending-rename {\n    border-color: var(--warning-color);\n    background: var(--bg-tertiary);\n}\n\n.saved-graph-item.pending-rename .saved-graph-name {\n    color: var(--warning-color);\n    font-weight: 700;\n}\n\n.saved-graph-item.pending-rename .saved-graph-name::after {\n    content: \' (renamed)\';\n    font-size: 0.75rem;\n    color: var(--text-muted);\n    font-weight: normal;\n}\n\n/* Statistics */\n.stats-grid {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 1rem;\n    margin-bottom: 1rem;\n}\n\n.stat-item {\n    background: var(--bg-tertiary);\n    border-radius: var(--radius-md);\n    padding: 1rem;\n    text-align: center;\n    border: 1px solid var(--border-color);\n    transition: var(--transition);\n}\n\n.stat-item:hover {\n    transform: translateY(-2px);\n    box-shadow: var(--shadow-md);\n}\n\n.stat-value {\n    font-size: 1.5rem;\n    font-weight: 700;\n    color: var(--primary-color);\n    margin-bottom: 0.25rem;\n}\n\n.stat-label {\n    font-size: 0.75rem;\n    color: var(--text-muted);\n    text-transform: uppercase;\n    letter-spacing: 0.05em;\n}\n\n/* Compact Statistics */\n.stats-compact {\n    display: flex;\n    gap: 1rem;\n    margin-bottom: 1rem;\n    align-items: center;\n}\n\n.stat-compact-item {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    background: var(--bg-tertiary);\n    border-radius: var(--radius-md);\n    padding: 0.5rem 0.75rem;\n    border: 1px solid var(--border-color);\n    transition: var(--transition);\n    flex: 1;\n    justify-content: center;\n}\n\n.stat-compact-item:hover {\n    transform: translateY(-1px);\n    box-shadow: var(--shadow-sm);\n    border-color: var(--primary-color);\n}\n\n.stat-compact-value {\n    font-size: 1.1rem;\n    font-weight: 700;\n    color: var(--primary-color);\n}\n\n.stat-compact-label {\n    font-size: 0.75rem;\n    color: var(--text-muted);\n    text-transform: uppercase;\n    letter-spacing: 0.05em;\n}\n\n.distance-info,\n.path-info,\n.search-info {\n    background: var(--bg-tertiary);\n    border-radius: var(--radius-md);\n    padding: 0.75rem;\n    font-size: 0.875rem;\n    color: var(--text-secondary);\n    border-left: 3px solid var(--accent-color);\n    display: none;\n    margin-top: 0.75rem;\n}\n\n.distance-info.show,\n.path-info.show,\n.search-info.show {\n    display: block;\n    animation: slideIn 0.3s ease-out;\n}\n\n.path-info {\n    border-left-color: var(--warning-color);\n}\n\n.search-info {\n    border-left-color: var(--success-color);\n}\n\n@keyframes slideIn {\n    from {\n        opacity: 0;\n        transform: translateY(-10px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n/* Main Content */\n.main-content {\n    position: relative;\n    background: var(--bg-primary);\n    overflow: hidden; /* Remove scrollbars from main content */\n    transition: var(--transition);\n    margin-right: 280px; /* Make room for right sidebar */\n    padding-right: 0;\n    padding-bottom: 0;\n    min-width: 0;\n    width: auto;\n    min-height: 0; /* Allow content to shrink */\n}\n\n/* Right Sidebar */\n.right-sidebar {\n    position: fixed;\n    top: 0;\n    right: 0;\n    bottom: 0; /* Remove bottom: 60px; so it goes to the bottom */\n    width: 280px;\n    background: var(--bg-secondary);\n    display: flex;\n    flex-direction: column;\n    z-index: 100;\n    transition: var(--transition);\n    overflow: hidden;\n    /* Remove margin-bottom: 60px; */\n}\n\n.right-sidebar-header {\n    padding: 1.5rem;\n    border-bottom: 1px solid var(--border-color);\n    background: var(--bg-card);\n}\n\n.right-sidebar-header h3 {\n    margin: 0;\n    font-size: 1.1rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.right-sidebar-content {\n    flex: 1;\n    padding: 1.5rem;\n    overflow-y: auto;\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n}\n\n.right-sidebar-content::-webkit-scrollbar {\n    width: 6px;\n}\n\n.right-sidebar-content::-webkit-scrollbar-track {\n    background: var(--bg-tertiary);\n}\n\n.right-sidebar-content::-webkit-scrollbar-thumb {\n    background: var(--border-color);\n    border-radius: 3px;\n}\n\n.right-sidebar-content::-webkit-scrollbar-thumb:hover {\n    background: var(--text-muted);\n}\n\n.canvas-container {\n    position: relative;\n    width: 2000px;\n    height: 2000px;\n    /* Ensure proper canvas rendering */\n    overflow: hidden;\n    margin: 0 auto;\n}\n\n/* Scrollable wrapper for the canvas */\n.canvas-scroll-wrapper {\n    width: 100%;\n    height: 100vh; /* Full viewport height since no footer */\n    overflow: auto;\n    position: relative;\n    margin: 0;\n    background: var(--bg-primary);\n    margin-bottom: 0;\n    display: block;\n    /* Ensure scrollbars appear */\n    z-index: 1;\n}\n\n/* Custom scrollbar styling for canvas scroll wrapper - matching horizontal scrollbar */\n.canvas-scroll-wrapper::-webkit-scrollbar {\n    width: 10px;\n    height: 10px;\n}\n\n.canvas-scroll-wrapper::-webkit-scrollbar-track {\n    background: #374151;\n    border-radius: 10px;\n    margin: 2px;\n}\n\n.canvas-scroll-wrapper::-webkit-scrollbar-thumb {\n    background: #6b7280;\n    border-radius: 10px;\n    border: 1px solid #374151;\n    min-height: 30px;\n    min-width: 30px;\n}\n\n.canvas-scroll-wrapper::-webkit-scrollbar-thumb:hover {\n    background: #9ca3af;\n}\n\n.canvas-scroll-wrapper::-webkit-scrollbar-corner {\n    background: #374151;\n}\n\n/* Light theme scrollbar adjustments */\n[data-theme="light"] .canvas-scroll-wrapper::-webkit-scrollbar-track {\n    background: #e5e7eb;\n}\n\n[data-theme="light"] .canvas-scroll-wrapper::-webkit-scrollbar-thumb {\n    background: #9ca3af;\n    border: 2px solid #e5e7eb;\n}\n\n[data-theme="light"] .canvas-scroll-wrapper::-webkit-scrollbar-thumb:hover {\n    background: #6b7280;\n}\n\n[data-theme="light"] .canvas-scroll-wrapper::-webkit-scrollbar-corner {\n    background: #e5e7eb;\n}\n\n/* Custom scrollbar styling for canvas container */\n.canvas-container::-webkit-scrollbar {\n    width: 12px;\n    height: 12px;\n}\n\n.canvas-container::-webkit-scrollbar-track {\n    background: var(--bg-secondary);\n    border-radius: 6px;\n}\n\n.canvas-container::-webkit-scrollbar-thumb {\n    background: var(--border-color);\n    border-radius: 6px;\n    border: 2px solid var(--bg-secondary);\n}\n\n.canvas-container::-webkit-scrollbar-thumb:hover {\n    background: var(--text-muted);\n}\n\n.canvas-container::-webkit-scrollbar-corner {\n    background: var(--bg-secondary);\n}\n\n/* Canvas Container */\n.white-box-container {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 2000px;\n    height: 2000px;\n    border: 2px solid var(--border-color);\n    pointer-events: none;\n    z-index: 10;\n    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);\n}\n\n#graphCanvas {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 2000px;\n    height: 2000px;\n    background: #374151; /* Dark gray for dark mode */\n    cursor: crosshair;\n    display: block;\n    transition: var(--transition);\n    margin: 0;\n    padding: 0;\n    pointer-events: auto;\n    /* Prevent rendering artifacts */\n    image-rendering: -webkit-optimize-contrast;\n    image-rendering: crisp-edges;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n}\n\n[data-theme="light"] #graphCanvas {\n    background: #e0f2fe; /* Light blue for light mode */\n}\n\n/* Instructions Overlay */\n.instructions-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: rgba(15, 23, 42, 0.95);\n    backdrop-filter: blur(10px);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    z-index: 1000;\n    animation: fadeIn 0.3s ease-out;\n}\n\n[data-theme="light"] .instructions-overlay {\n    background: rgba(255, 255, 255, 0.95);\n}\n\n@keyframes fadeIn {\n    from {\n        opacity: 0;\n    }\n    to {\n        opacity: 1;\n    }\n}\n\n.instructions-content {\n    background: var(--bg-card);\n    border-radius: var(--radius-xl);\n    padding: 2rem;\n    max-width: 500px;\n    max-height: 90vh;\n    width: 90%;\n    border: 1px solid var(--border-color);\n    box-shadow: var(--shadow-xl);\n    transition: var(--transition);\n    overflow-y: scroll;\n    overflow-x: hidden;\n}\n\n.instructions-content h3 {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    font-size: 1.1rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    margin-bottom: 1rem;\n    text-align: center;\n}\n\n.instructions-content h3 i {\n    color: var(--warning-color);\n}\n\n.instruction-grid {\n    display: grid;\n    gap: 0.75rem;\n    margin-bottom: 1rem;\n}\n\n.instruction-item {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n    padding: 0.75rem;\n    background: var(--bg-secondary);\n    border-radius: var(--radius-md);\n    border: 1px solid var(--border-color);\n    transition: var(--transition);\n}\n\n.instruction-item:hover {\n    transform: translateX(3px);\n    border-color: var(--primary-color);\n}\n\n.instruction-icon {\n    width: 32px;\n    height: 32px;\n    background: var(--primary-color);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    color: white;\n    font-size: 0.875rem;\n    flex-shrink: 0;\n}\n\n.instruction-text {\n    font-size: 0.8rem;\n    color: var(--text-secondary);\n    line-height: 1.3;\n}\n\n.instruction-text strong {\n    color: var(--text-primary);\n}\n\n\n\n\n\n/* General time display styling (for other contexts) */\n.time-display {\n    cursor: pointer;\n    transition: var(--transition);\n    padding: 0.5rem 0.75rem;\n    border-radius: var(--radius-sm);\n    user-select: none;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    height: 100%;\n    justify-content: center;\n}\n\n.time-display:hover {\n    background: var(--bg-tertiary);\n    color: var(--primary-color);\n    transform: translateY(-1px);\n}\n\n/* Analog clock styling */\n.analog-clock {\n    color: var(--text-primary);\n    transition: var(--transition);\n    width: 80px;\n    height: 80px;\n    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));\n}\n\n.time-display:hover .analog-clock {\n    color: var(--primary-color);\n}\n\n\n\n/* LinkedIn link styling */\n.linkedin-link {\n    color: inherit;\n    text-decoration: none;\n    transition: var(--transition);\n    position: relative;\n    display: inline-block;\n}\n\n.linkedin-link:hover {\n    color: var(--primary-color);\n    transform: scale(1.05);\n}\n\n.linkedin-link::after {\n    content: \'🔗\';\n    position: absolute;\n    right: -20px;\n    top: 50%;\n    transform: translateY(-50%);\n    opacity: 0;\n    transition: var(--transition);\n    font-size: 0.75rem;\n}\n\n.linkedin-link:hover::after {\n    opacity: 1;\n    right: -25px;\n}\n\n/* Contact link styling */\n.contact-status-item {\n    cursor: pointer;\n}\n\n.contact-link {\n    color: inherit;\n    text-decoration: none;\n    transition: var(--transition);\n    position: relative;\n    display: inline-block;\n    cursor: pointer;\n    /* pointer-events: none; */\n}\n\n.contact-status-item:hover .contact-link {\n    color: var(--primary-color);\n    transform: scale(1.05);\n}\n\n\n\n/* Responsive Design */\n@media (max-width: 1024px) {\n    .app-container {\n        grid-template-columns: 280px 1fr;\n    }\n    \n    .sidebar-content {\n        padding: 1.5rem;\n    }\n}\n\n@media (max-width: 768px) {\n    .app-container {\n        grid-template-columns: 1fr;\n        grid-template-rows: auto 1fr auto;\n    }\n    \n    .sidebar {\n        order: 2;\n        border-right: none;\n        border-top: 1px solid var(--border-color);\n        max-height: 300px;\n    }\n    \n    .main-content {\n        order: 1;\n        margin-right: 0;\n    }\n    \n    .right-sidebar {\n        transform: translateX(100%);\n        transition: transform 0.3s ease;\n        height: 100vh; /* Full height on mobile */\n    }\n    \n    .right-sidebar.show {\n        transform: translateX(0);\n    }\n    \n\n    \n    .stats-grid {\n        grid-template-columns: 1fr 1fr;\n    }\n}\n\n@media (max-width: 480px) {\n    .sidebar-content {\n        padding: 0.75rem;\n    }\n    \n    .control-section {\n        padding: 1rem;\n    }\n    \n    .instructions-content {\n        padding: 1.5rem;\n        margin: 1rem;\n    }\n    \n    .instruction-item {\n        flex-direction: column;\n        text-align: center;\n        gap: 0.75rem;\n    }\n}\n\n/* Canvas-specific styles for better interaction */\n#graphCanvas {\n    /* Remove touch-action restriction that could interfere with dragging */\n    touch-action: manipulation;\n}\n\n/* Selection states for vertices */\n.vertex-selected {\n    animation: pulse 2s infinite;\n}\n\n@keyframes pulse {\n    0%, 100% {\n        transform: scale(1);\n    }\n    50% {\n        transform: scale(1.05);\n    }\n}\n\n/* Hover effects for better UX */\n.control-group:hover {\n    transform: translateY(-1px);\n}\n\n.stat-item:hover .stat-value {\n    color: var(--accent-color);\n}\n\n/* Expandable Section Styles */\n.expandable-header {\n    cursor: pointer;\n    user-select: none;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: var(--transition);\n    flex: 1;\n    text-align: center;\n    margin: 0;\n}\n\n\n\n.expandable-header:hover {\n    color: var(--primary-color);\n}\n\n.expand-icon {\n    font-size: 0.875rem;\n    transition: var(--transition);\n    color: var(--text-muted);\n    margin-left: auto;\n    flex-shrink: 0;\n    margin-right: 3px;\n}\n\n.expandable-header:hover .expand-icon {\n    color: var(--primary-color);\n}\n\n.expandable-header.expanded .expand-icon {\n    transform: rotate(180deg);\n    color: var(--primary-color);\n}\n\n.expandable-content {\n    display: none;\n    overflow: hidden;\n    transition: all 0.3s ease-out;\n}\n\n.expandable-content.show {\n    display: block !important;\n    animation: slideDown 0.3s ease-out;\n}\n\n@keyframes slideDown {\n    from {\n        opacity: 0;\n        transform: translateY(-10px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n/* Search animation states */\n.vertex-visited {\n    animation: visited 0.5s ease-out;\n}\n\n.vertex-path {\n    animation: path 0.5s ease-out;\n}\n\n@keyframes visited {\n    0% {\n        transform: scale(1);\n    }\n    50% {\n        transform: scale(1.2);\n    }\n    100% {\n        transform: scale(1);\n    }\n}\n\n@keyframes path {\n    0% {\n        transform: scale(1);\n    }\n    50% {\n        transform: scale(1.3);\n    }\n    100% {\n        transform: scale(1);\n    }\n}\n\n/* Animation speed slider styles */\n.slider-container {\n    position: relative;\n    margin-top: 0.5rem;\n}\n\n.slider {\n    width: 100%;\n    height: 6px;\n    border-radius: 3px;\n    background: var(--bg-tertiary);\n    outline: none;\n    -webkit-appearance: none;\n    appearance: none;\n    cursor: pointer;\n}\n\n.slider::-webkit-slider-thumb {\n    -webkit-appearance: none;\n    appearance: none;\n    width: 18px;\n    height: 18px;\n    border-radius: 50%;\n    background: var(--primary-color);\n    cursor: pointer;\n    transition: var(--transition);\n}\n\n.slider::-webkit-slider-thumb:hover {\n    background: var(--primary-dark);\n    transform: scale(1.1);\n}\n\n.slider::-moz-range-thumb {\n    width: 18px;\n    height: 18px;\n    border-radius: 50%;\n    background: var(--primary-color);\n    cursor: pointer;\n    border: none;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n    transition: var(--transition);\n}\n\n.slider::-moz-range-thumb:hover {\n    transform: scale(1.1);\n    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);\n}\n\n.slider-label-left,\n.slider-label-right {\n    font-size: 0.75rem;\n    font-weight: 500;\n    color: var(--text-muted);\n    display: flex;\n    align-items: center;\n    min-width: 2rem;\n}\n\n.slider-label-left {\n    color: var(--success-color);\n    margin-right: 0.75rem;\n}\n\n.slider-label-right {\n    color: var(--warning-color);\n    margin-left: 0.75rem;\n} \n\n/* Edit Mode Styles */\n.edit-mode-info {\n    background: var(--bg-tertiary);\n    border-radius: var(--radius-md);\n    padding: 1rem;\n    margin-bottom: 1rem;\n    border-left: 3px solid var(--accent-color);\n}\n\n.edit-mode-info-text {\n    font-size: 0.875rem;\n    color: var(--text-secondary);\n}\n\n.edit-mode-item {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    margin-bottom: 0.5rem;\n}\n\n.edit-mode-item:last-child {\n    margin-bottom: 0;\n}\n\n.edit-mode-item i {\n    color: var(--accent-color);\n    width: 16px;\n    text-align: center;\n}\n\n.edit-mode-item strong {\n    color: var(--text-primary);\n    font-weight: 600;\n}\n\n#editControlsSection {\n    border: 2px solid var(--accent-color);\n    background: var(--bg-secondary);\n}\n\n#editControlsSection h3 {\n    color: var(--accent-color);\n}\n\n/* Edit Controls Grid Layout */\n.edit-controls-grid {\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n    margin-top: 1rem;\n}\n\n.edit-control-row {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 1rem;\n}\n\n.edit-control-row .control-group {\n    margin-bottom: 0;\n}\n\n/* Switch Styling */\n.switch-label {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    cursor: pointer;\n    font-size: 0.875rem;\n    color: var(--text-primary);\n    margin-bottom: 0;\n    padding: 0.5rem 0;\n}\n\n.switch-label i {\n    color: var(--accent-color);\n    width: 16px;\n    text-align: center;\n    margin-right: 0.5rem;\n}\n\n.switch-container {\n    position: relative;\n    display: inline-block;\n    width: 44px;\n    height: 24px;\n}\n\n.switch-container input[type="checkbox"] {\n    opacity: 0;\n    width: 0;\n    height: 0;\n}\n\n.switch-slider {\n    position: absolute;\n    cursor: pointer;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: var(--bg-tertiary);\n    border: 1px solid var(--border-color);\n    transition: var(--transition);\n    border-radius: 24px;\n}\n\n.switch-slider:before {\n    position: absolute;\n    content: "";\n    height: 18px;\n    width: 18px;\n    left: 2px;\n    bottom: 2px;\n    background-color: var(--text-muted);\n    transition: var(--transition);\n    border-radius: 50%;\n}\n\n.switch-container input:checked + .switch-slider {\n    background-color: var(--primary-color);\n    border-color: var(--primary-color);\n}\n\n.switch-container input:checked + .switch-slider:before {\n    transform: translateX(20px);\n    background-color: white;\n}\n\n.switch-container:hover .switch-slider {\n    border-color: var(--primary-color);\n}\n\n/* Checkbox Styling (keeping for other uses) */\n.checkbox-label {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    cursor: pointer;\n    font-size: 0.875rem;\n    color: var(--text-primary);\n    margin-bottom: 0;\n}\n\n.checkbox-label input[type="checkbox"] {\n    display: none;\n}\n\n.checkmark {\n    width: 18px;\n    height: 18px;\n    background: var(--bg-tertiary);\n    border: 2px solid var(--border-color);\n    border-radius: var(--radius-sm);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: var(--transition);\n}\n\n.checkbox-label input[type="checkbox"]:checked + .checkmark {\n    background: var(--primary-color);\n    border-color: var(--primary-color);\n}\n\n.checkbox-label input[type="checkbox"]:checked + .checkmark::after {\n    content: \'✓\';\n    color: white;\n    font-size: 0.75rem;\n    font-weight: bold;\n}\n\n.checkbox-label:hover .checkmark {\n    border-color: var(--primary-color);\n}\n\n.checkbox-label i {\n    color: var(--accent-color);\n    width: 16px;\n    text-align: center;\n}\n\n#vertexEditControls,\n#edgeEditControls {\n    margin-top: 1rem;\n    padding-top: 1rem;\n    border-top: 1px solid var(--border-color);\n}\n\n#vertexEditControls h4,\n#edgeEditControls h4 {\n    color: var(--text-primary);\n    font-size: 0.875rem;\n    font-weight: 600;\n    margin-bottom: 0.75rem;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n/* Shake animation for edit mode */\n@keyframes shake {\n    0%, 100% { transform: translateX(0); }\n    25% { transform: translateX(-0.1px); }\n    75% { transform: translateX(0.1px); }\n}\n\n.edit-mode-shake {\n    animation: shake 0.1s infinite;\n} \n\n.instructions-close {\n    position: absolute;\n    top: 0.75rem;\n    right: 1rem;\n    background: transparent;\n    border: none;\n    color: var(--text-secondary);\n    font-size: 1.25rem;\n    cursor: pointer;\n    z-index: 10;\n    transition: color 0.2s;\n}\n.instructions-close:hover {\n    color: var(--danger-color);\n} \n\n/* Target Vertex Display */\n.target-vertex-display {\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n    position: relative;\n}\n\n#resetTargetBtn {\n    opacity: 0.5;\n    background: none;\n    border: none;\n    outline: none;\n    box-shadow: none;\n    transition: opacity 0.2s;\n    position: absolute;\n    top: 6px;\n    right: 6px;\n    z-index: 2;\n    padding: 0;\n    margin: 0;\n    font-size: 1rem;\n    color: var(--text-muted);\n    cursor: pointer;\n}\n\n#resetTargetBtn:hover {\n    opacity: 1;\n    color: var(--primary-color);\n}\n\n.target-vertex-display:hover #resetTargetBtn {\n    opacity: 1;\n}\n\n.target-display {\n    background: var(--bg-tertiary);\n    border: 1px solid var(--border-color);\n    border-radius: var(--radius-md);\n    padding: 0.75rem;\n    min-height: 40px;\n    width: 100%;\n    display: flex;\n    align-items: center;\n    transition: var(--transition);\n    overflow: hidden; /* Prevent content from overflowing */\n}\n\n.target-display.has-target {\n    border-color: var(--primary-color);\n    background: var(--bg-secondary);\n}\n\n.target-placeholder {\n    color: var(--text-muted);\n    font-size: 0.75rem;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    max-width: 100%;\n}\n\n.target-vertex-label {\n    font-size: 0.875rem;\n    font-weight: 500;\n    color: var(--text-primary);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    max-width: 100%;\n}\n\n.target-vertex-info {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    color: var(--text-primary);\n    font-weight: 500;\n}\n\n.target-vertex-icon {\n    width: 20px;\n    height: 20px;\n    background: var(--primary-color);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    color: white;\n    font-size: 0.75rem;\n    font-weight: bold;\n}\n\n.target-vertex-label {\n    font-size: 0.875rem;\n}\n\n.target-vertex-coords {\n    font-size: 0.75rem;\n    color: var(--text-muted);\n    margin-left: auto;\n} \n\n\n\n.btn-outline-primary {\n    background: transparent;\n    border: 2px solid var(--primary-color);\n    color: var(--primary-color);\n    transition: var(--transition);\n    font-weight: 500;\n    padding: 0.5rem 1rem;\n    border-radius: var(--radius-md);\n    position: relative;\n    overflow: hidden;\n}\n\n.btn-outline-primary::before {\n    content: \'\';\n    position: absolute;\n    top: 0;\n    left: -100%;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);\n    transition: left 0.5s;\n}\n\n.btn-outline-primary:hover {\n    background: var(--primary-color);\n    color: white;\n    transform: translateY(-2px);\n    box-shadow: var(--shadow-lg);\n    border-color: var(--primary-color);\n}\n\n.btn-outline-primary:hover::before {\n    left: 100%;\n}\n\n.btn-outline-primary i {\n    margin-right: 0.5rem;\n    transition: var(--transition);\n}\n\n.btn-outline-primary:hover i {\n    transform: scale(1.1);\n}\n\n.btn-outline-danger {\n    background: transparent;\n    border: 2px solid var(--danger-color);\n    color: var(--danger-color);\n    transition: var(--transition);\n    font-weight: 500;\n    padding: 0.5rem 1rem;\n    border-radius: var(--radius-md);\n    position: relative;\n    overflow: hidden;\n}\n\n.btn-outline-danger::before {\n    content: \'\';\n    position: absolute;\n    top: 0;\n    left: -100%;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);\n    transition: left 0.5s;\n}\n\n.btn-outline-danger:hover {\n    background: var(--danger-color);\n    color: white;\n    transform: translateY(-2px);\n    box-shadow: var(--shadow-lg);\n    border-color: var(--danger-color);\n}\n\n.btn-outline-danger:hover::before {\n    left: 100%;\n}\n\n.btn-outline-danger i {\n    margin-right: 0.5rem;\n    transition: var(--transition);\n}\n\n.btn-outline-danger:hover i {\n    transform: scale(1.1);\n}\n\n.btn-outline-secondary {\n    background: transparent;\n    border: 2px solid var(--border-color);\n    color: var(--text-secondary);\n    transition: var(--transition);\n    font-weight: 500;\n    padding: 0.5rem 1rem;\n    border-radius: var(--radius-md);\n    position: relative;\n    overflow: hidden;\n}\n\n.btn-outline-secondary::before {\n    content: \'\';\n    position: absolute;\n    top: 0;\n    left: -100%;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);\n    transition: left 0.5s;\n}\n\n.btn-outline-secondary:hover {\n    background: var(--border-color);\n    color: var(--text-primary);\n    transform: translateY(-2px);\n    box-shadow: var(--shadow-lg);\n    border-color: var(--border-color);\n}\n\n.btn-outline-secondary:hover::before {\n    left: 100%;\n}\n\n.btn-outline-secondary i {\n    margin-right: 0.5rem;\n    transition: var(--transition);\n}\n\n.btn-outline-secondary:hover i {\n    transform: scale(1.1);\n}\n\n/* Custom button styles for specific buttons */\n#deleteNodesBtn {\n    background: linear-gradient(135deg, rgb(252, 61, 3), #e53e3e) !important;\n    color: white !important;\n}\n\n#deleteNodesBtn:hover:not(:disabled) {\n    background: linear-gradient(135deg, #e53e3e, #c53030) !important;\n    transform: translateY(-2px);\n    box-shadow: var(--shadow-lg);\n    color: white !important;\n}\n\n#deleteAllGraphs {\n    background: linear-gradient(135deg, #8b0000, #a52a2a) !important;\n    color: white !important;\n    border: none !important;\n    font-size: 0.75rem !important;\n    padding: 0.4rem 0.6rem !important;\n}\n\n/* Ensure shared confirmation buttons are hidden by default */\n#sharedConfirmation {\n    display: none !important;\n}\n\n#deleteAllGraphs:hover:not(:disabled) {\n    background: linear-gradient(135deg, #a52a2a, #b22222) !important;\n    transform: translateY(-2px);\n    box-shadow: var(--shadow-lg);\n}\n\n#clearGraph {\n    font-size: 0.75rem !important;\n    padding: 0.4rem 0.6rem !important;\n}\n\n/* Consistent hover effects for all sidebar buttons */\n.sidebar .btn:hover:not(:disabled) {\n    transform: translateY(-2px);\n    box-shadow: var(--shadow-lg);\n}\n\n.sidebar .btn-outline-primary:hover:not(:disabled),\n.sidebar .btn-outline-danger:hover:not(:disabled) {\n    transform: translateY(-2px);\n    box-shadow: var(--shadow-lg);\n}\n\n/* Contact Modal Styles */\n#contactModal .modal-content {\n    background: var(--bg-card);\n    border: 6px solid var(--border-color);\n    color: var(--text-primary);\n    box-shadow: var(--shadow-xl);\n    border-radius: var(--radius-lg);\n}\n\n#contactModal .modal-header {\n    background: var(--bg-secondary);\n    border-bottom: 1px solid var(--border-color);\n}\n\n#contactModal .modal-title {\n    color: var(--text-primary);\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n#contactModal .modal-title i {\n    color: var(--primary-color);\n}\n\n#contactModal .modal-body {\n    background: var(--bg-card);\n}\n\n#contactModal .modal-footer {\n    background: var(--bg-secondary);\n    border-top: 1px solid var(--border-color);\n}\n\n#contactModal .form-label {\n    color: var(--text-primary);\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    font-weight: 500;\n}\n\n#contactModal .form-label i {\n    color: var(--accent-color);\n    width: 16px;\n    text-align: center;\n}\n\n#contactModal .form-control {\n    width: 100%;\n    padding: 0.75rem;\n    background: var(--bg-tertiary);\n    border: 1px solid var(--border-color);\n    border-radius: var(--radius-md);\n    color: var(--text-primary);\n    font-size: 0.875rem;\n    transition: var(--transition);\n}\n\n#contactModal .form-control:focus {\n    background: var(--bg-secondary);\n    border-color: var(--primary-color);\n    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);\n    color: var(--text-primary);\n}\n\n#contactModal .form-control::placeholder {\n    color: var(--text-muted);\n}\n\n#contactModal textarea.form-control {\n    resize: vertical;\n    min-height: 100px;\n}\n\n/* Responsive Status Bar */\n@media (max-width: 768px) {\n\n    \n    .app-container {\n        grid-template-rows: auto 1fr auto;\n    }\n}\n\n@media (max-width: 480px) {\n\n    \n    .btn-outline-primary {\n        padding: 0.4rem 0.8rem;\n        font-size: 0.8rem;\n    }\n} \n\n/* Theme toggle container */\n.theme-toggle-container {\n    display: flex;\n    justify-content: center;\n    margin: 0.75rem 0;\n    padding: 0.375rem;\n    background: var(--bg-tertiary);\n    border-radius: var(--radius-lg);\n    border: 1px solid var(--border-color);\n}\n\n.theme-toggle-container .theme-toggle {\n    background: var(--bg-primary);\n    border: 2px solid var(--border-color);\n    border-radius: 50%;\n    width: 44px;\n    height: 44px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\n    position: relative;\n    overflow: hidden;\n}\n\n.theme-toggle-container .theme-toggle::before {\n    content: \'\';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);\n    opacity: 0;\n    transition: opacity 0.3s ease;\n    border-radius: 50%;\n}\n\n.theme-toggle-container .theme-toggle:hover {\n    transform: scale(1.05);\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);\n    border-color: var(--primary-color);\n}\n\n.theme-toggle-container .theme-toggle:hover::before {\n    opacity: 0.1;\n}\n\n.theme-toggle-container .theme-toggle:active {\n    transform: scale(0.95);\n}\n\n/* Delete mode styling */\n.delete-mode-active .vertex {\n    position: relative;\n}\n\n.delete-button {\n    position: absolute;\n    top: -8px;\n    right: -8px;\n    width: 20px;\n    height: 20px;\n    background: #ef4444;\n    border: 2px solid #ffffff;\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    font-size: 10px;\n    color: white;\n    font-weight: bold;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);\n    transition: all 0.2s ease;\n    z-index: 1000;\n}\n\n.delete-button:hover {\n    background: #dc2626;\n    transform: scale(1.2);\n    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);\n}\n\n.delete-button::before {\n    content: "×";\n    line-height: 1;\n}\n\n/* Delete mode canvas styling */\n.delete-mode-active #graphCanvas {\n    cursor: crosshair;\n}\n\n.delete-mode-active .vertex:hover {\n    cursor: pointer;\n}\n\n/* Statistics section styling - more compact */\n#infoSection {\n    background: var(--bg-secondary);\n    border: 1px solid var(--border-color);\n    border-radius: var(--radius-md);\n    padding: 0.75rem;\n    margin-bottom: 0.5rem;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n}\n\n#infoSection h3 {\n    color: var(--text-primary);\n    font-size: 0.875rem;\n    font-weight: 600;\n    margin-bottom: 0.5rem;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n#infoSection h3 i {\n    color: var(--primary-color);\n    font-size: 0.8rem;\n}\n\n.stats-compact {\n    display: flex;\n    gap: 0.5rem;\n    justify-content: space-around;\n}\n\n.stat-compact-item {\n    text-align: center;\n    padding: 0.375rem 0.5rem;\n    background: var(--bg-primary);\n    border-radius: var(--radius-sm);\n    border: 1px solid var(--border-color);\n    min-width: 50px;\n    transition: all 0.2s ease;\n    flex: 1;\n}\n\n.stat-compact-item:hover {\n    transform: translateY(-1px);\n    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);\n    border-color: var(--primary-color);\n}\n\n.stat-compact-value {\n    display: block;\n    font-size: 1.1rem;\n    font-weight: 700;\n    color: var(--primary-color);\n    line-height: 1;\n}\n\n.stat-compact-label {\n    display: block;\n    font-size: 0.65rem;\n    color: var(--text-muted);\n    margin-top: 0.125rem;\n    font-weight: 500;\n    text-transform: uppercase;\n    letter-spacing: 0.025em;\n}\n\n/* Delete Mode Panel Styling */\n#deleteModePanel {\n    background: var(--bg-secondary);\n    border: 1px solid var(--border-color);\n    border-radius: var(--radius-md);\n    padding: 1rem;\n    margin-bottom: 0.5rem;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n}\n\n#deleteModePanel h3 {\n    color: var(--text-primary);\n    font-size: 1rem;\n    font-weight: 600;\n    margin-bottom: 0.75rem;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n#deleteModePanel h3 i {\n    color: #ef4444;\n    font-size: 0.9rem;\n}\n\n.delete-mode-info {\n    background: rgba(239, 68, 68, 0.1);\n    border: 1px solid rgba(239, 68, 68, 0.3);\n    border-radius: var(--radius-sm);\n    padding: 0.75rem;\n    margin-bottom: 1rem;\n}\n\n.delete-mode-info-text {\n    color: #ef4444;\n    font-weight: 500;\n    font-size: 0.9rem;\n    text-align: center;\n}\n\n.selected-vertices-list {\n    max-height: 200px;\n    overflow-y: auto;\n    background: var(--bg-primary);\n    border: 1px solid var(--border-color);\n    border-radius: var(--radius-sm);\n    padding: 0.5rem;\n    margin-top: 0.5rem;\n}\n\n.selected-vertex-item {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    padding: 0.5rem;\n    background: rgba(236, 72, 153, 0.1);\n    border: 1px solid rgba(236, 72, 153, 0.3);\n    border-radius: var(--radius-sm);\n    margin-bottom: 0.25rem;\n    font-size: 0.9rem;\n}\n\n.selected-vertex-item:last-child {\n    margin-bottom: 0;\n}\n\n.selected-vertex-item i {\n    color: #ec4899;\n    font-size: 0.8rem;\n}\n\n.selected-vertex-item strong {\n    color: var(--text-primary);\n    font-weight: 600;\n}\n\n.vertex-coords {\n    color: var(--text-muted);\n    font-size: 0.8rem;\n    margin-left: auto;\n}\n\n.coordinate-tooltip {\n    background: var(--bg-tertiary);\n    border: 1px solid var(--border-color);\n    border-radius: var(--radius-md);\n    padding: 0.75rem;\n    margin-top: 0.5rem;\n}\n\n.coordinate-tooltip-label {\n    color: var(--text-muted);\n    font-size: 0.8rem;\n    font-weight: 500;\n    margin-bottom: 0.5rem;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    gap: 0.5rem;\n}\n\n.coordinate-tooltip-value {\n    color: var(--text-primary);\n    font-size: 0.9rem;\n    font-weight: 600;\n    text-align: center;\n    font-family: \'Courier New\', monospace;\n}\n\n.coordinate-toggle-container {\n    margin-top: 0.5rem;\n    padding-top: 0.5rem;\n    border-top: 1px solid var(--border-color);\n}\n\n.coordinate-toggle-container .switch-label {\n    font-size: 0.8rem;\n    color: var(--text-muted);\n    margin: 0;\n    padding: 0;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    gap: 0.5rem;\n    cursor: pointer;\n}\n\n.coordinate-toggle-container .switch-label i {\n    font-size: 0.9rem;\n    color: var(--text-muted);\n}\n\n.coordinate-grid-controls {\n    margin-top: 0.5rem;\n    padding-top: 0.5rem;\n}\n\n.coordinate-grid-toggle {\n    margin-bottom: 1rem;\n}\n\n.coordinate-grid-toggle .switch-label {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    cursor: pointer;\n    font-size: 0.875rem;\n    color: var(--text-secondary);\n    transition: var(--transition);\n}\n\n.coordinate-grid-toggle .switch-label:hover {\n    color: var(--text-primary);\n}\n\n.coordinate-grid-toggle .switch-label i {\n    color: var(--accent-color);\n    margin-right: 0.5rem;\n}\n\n.coordinate-grid-density {\n    margin-top: 0.75rem;\n}\n\n.coordinate-grid-density label {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    font-size: 0.875rem;\n    color: var(--text-secondary);\n    margin-bottom: 0.5rem;\n}\n\n.coordinate-grid-density label i {\n    color: var(--accent-color);\n}\n\n\n\n\n\n\n\n\n\n/* Image Format Buttons - Adjacent Style */\n.image-format-buttons {\n    display: flex;\n    gap: 0;\n    margin-top: 0.5rem;\n}\n\n.format-option {\n    flex: 1;\n    cursor: pointer;\n    margin: 0;\n    padding: 0;\n}\n\n.format-option input[type="radio"] {\n    display: none;\n}\n\n.format-button {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    padding: 0.6rem 0.5rem;\n    background: var(--bg-secondary);\n    border: 1px solid var(--border-color);\n    border-radius: 0;\n    color: var(--text-secondary);\n    font-size: 0.875rem;\n    font-weight: 500;\n    transition: all 0.3s ease;\n    cursor: pointer;\n    min-height: 60px;\n    width: 100%;\n    margin: 0;\n    box-sizing: border-box;\n}\n\n.format-option:first-child .format-button {\n    border-top-left-radius: 6px;\n    border-bottom-left-radius: 6px;\n    border-right: 1px solid var(--border-color);\n}\n\n.format-option:last-child .format-button {\n    border-top-right-radius: 6px;\n    border-bottom-right-radius: 6px;\n    border-left: none;\n}\n\n.format-button i {\n    font-size: 1.25rem;\n    margin-bottom: 0.15rem;\n    opacity: 0.7;\n}\n\n.format-option input[type="radio"]:checked + .format-button {\n    background: var(--primary-color);\n    color: white;\n    transform: translateY(-1px);\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\n}\n\n.format-option input[type="radio"]:checked + .format-button i {\n    opacity: 1;\n}\n\n.format-button:hover {\n    background: var(--bg-tertiary);\n    transform: translateY(-1px);\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.format-option input[type="radio"]:checked + .format-button:hover {\n    background: var(--primary-dark);\n    transform: translateY(-1px);\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\n}\n\n/* Edge Type Buttons - Adjacent Style */\n.edge-type-buttons {\n    display: flex;\n    gap: 0;\n    margin-top: 0.5rem;\n}\n\n.edge-type-option {\n    flex: 1;\n    cursor: pointer;\n    margin: 0;\n    padding: 0;\n}\n\n.edge-type-option input[type="radio"] {\n    display: none;\n}\n\n.edge-type-button {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    padding: 0.6rem 0.5rem;\n    background: var(--bg-secondary);\n    border: 1px solid var(--border-color);\n    border-radius: 0;\n    color: var(--text-secondary);\n    font-size: 0.875rem;\n    font-weight: 500;\n    transition: all 0.3s ease;\n    cursor: pointer;\n    min-height: 60px;\n    width: 100%;\n    margin: 0;\n    box-sizing: border-box;\n}\n\n.edge-type-option:first-child .edge-type-button {\n    border-top-left-radius: 6px;\n    border-bottom-left-radius: 6px;\n    border-right: 1px solid var(--border-color);\n}\n\n.edge-type-option:last-child .edge-type-button {\n    border-top-right-radius: 6px;\n    border-bottom-right-radius: 6px;\n    border-left: none;\n}\n\n.edge-type-button i {\n    font-size: 1.25rem;\n    margin-bottom: 0.15rem;\n    opacity: 0.7;\n}\n\n.edge-type-option input[type="radio"]:checked + .edge-type-button {\n    background: var(--primary-color);\n    color: white;\n    transform: translateY(-1px);\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\n}\n\n.edge-type-option input[type="radio"]:checked + .edge-type-button i {\n    opacity: 1;\n}\n\n.edge-type-button:hover {\n    background: var(--bg-tertiary);\n    transform: translateY(-1px);\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.edge-type-option input[type="radio"]:checked + .edge-type-button:hover {\n    background: var(--primary-dark);\n    transform: translateY(-1px);\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\n}\n\n/* Edge Direction Buttons - Adjacent Style */\n.edge-direction-buttons {\n    display: flex;\n    gap: 0;\n    margin-top: 0.5rem;\n}\n\n.edge-direction-option {\n    flex: 1;\n    cursor: pointer;\n    margin: 0;\n    padding: 0;\n}\n\n.edge-direction-option input[type="radio"] {\n    display: none;\n}\n\n.edge-direction-button {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    padding: 0.6rem 0.5rem;\n    background: var(--bg-secondary);\n    border: 1px solid var(--border-color);\n    border-radius: 0;\n    color: var(--text-secondary);\n    font-size: 0.875rem;\n    font-weight: 500;\n    transition: all 0.3s ease;\n    cursor: pointer;\n    min-height: 60px;\n    width: 100%;\n    margin: 0;\n    box-sizing: border-box;\n}\n\n.edge-direction-option:first-child .edge-direction-button {\n    border-top-left-radius: 6px;\n    border-bottom-left-radius: 6px;\n    border-right: 1px solid var(--border-color);\n}\n\n.edge-direction-option:last-child .edge-direction-button {\n    border-top-right-radius: 6px;\n    border-bottom-right-radius: 6px;\n    border-left: none;\n}\n\n.edge-direction-button i {\n    font-size: 1.25rem;\n    margin-bottom: 0.15rem;\n    opacity: 0.7;\n}\n\n.edge-direction-option input[type="radio"]:checked + .edge-direction-button {\n    background: var(--primary-color);\n    color: white;\n    transform: translateY(-1px);\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\n}\n\n.edge-direction-option input[type="radio"]:checked + .edge-direction-button i {\n    opacity: 1;\n}\n\n.edge-direction-button:hover {\n    background: var(--bg-tertiary);\n    transform: translateY(-1px);\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.edge-direction-option input[type="radio"]:checked + .edge-direction-button:hover {\n    background: var(--primary-dark);\n    transform: translateY(-1px);\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\n}\n\n/* Panel Drag and Drop Styles */\n.draggable-panel {\n    transition: transform 0.2s ease, box-shadow 0.2s ease;\n    position: relative;\n}\n\n.draggable-panel:hover {\n    transform: translateY(-1px);\n    box-shadow: var(--shadow-lg);\n}\n\n.draggable-panel.dragging {\n    transition: none !important;\n    box-shadow: var(--shadow-xl);\n    z-index: 1001;\n    animation: dragShake 0.1s ease-in-out infinite;\n}\n\n@keyframes dragShake {\n    0% { transform: rotate(2deg) translateX(0px) translateY(0px); }\n    25% { transform: rotate(2deg) translateX(-1px) translateY(-1px); }\n    50% { transform: rotate(2deg) translateX(1px) translateY(1px); }\n    75% { transform: rotate(2deg) translateX(-1px) translateY(1px); }\n    100% { transform: rotate(2deg) translateX(0px) translateY(0px); }\n}\n\n/* Alternative shake effect with more variation */\n@keyframes dragShakeVariant {\n    0% { transform: rotate(2deg) translateX(0px) translateY(0px); }\n    20% { transform: rotate(2deg) translateX(-1px) translateY(0px); }\n    40% { transform: rotate(2deg) translateX(1px) translateY(-1px); }\n    60% { transform: rotate(2deg) translateX(0px) translateY(1px); }\n    80% { transform: rotate(2deg) translateX(-1px) translateY(-1px); }\n    100% { transform: rotate(2deg) translateX(0px) translateY(0px); }\n}\n\n.panel-drag-handle {\n    cursor: pointer !important;\n    user-select: none;\n    transition: background-color 0.2s ease;\n    background-color: transparent;\n    border-radius: var(--radius-sm);\n    position: relative;\n}\n\n.panel-drag-handle:hover {\n    background-color: rgba(99, 102, 241, 0.05);\n}\n\n.panel-drag-handle:active {\n    cursor: grabbing !important;\n    background-color: rgba(99, 102, 241, 0.08);\n}\n\n/* Visual feedback for clickable panels */\n.panel-drag-handle::after {\n    content: \'\';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    pointer-events: none;\n    border-radius: var(--radius-sm);\n    transition: all 0.2s ease;\n    z-index: 1;\n    background: linear-gradient(135deg, transparent 0%, rgba(99, 102, 241, 0.02) 100%);\n    opacity: 0;\n}\n\n.panel-drag-handle:hover::after {\n    opacity: 1;\n    background: linear-gradient(135deg, transparent 0%, rgba(99, 102, 241, 0.05) 100%);\n}\n\n/* Click feedback animation */\n.panel-drag-handle:active::after {\n    background: linear-gradient(135deg, transparent 0%, rgba(99, 102, 241, 0.1) 100%);\n    transform: scale(0.98);\n    transition: all 0.1s ease;\n}\n\n/* Hold feedback - shows when user is holding down but not yet dragging */\n.panel-drag-handle.holding::after {\n    background: linear-gradient(135deg, transparent 0%, rgba(99, 102, 241, 0.08) 100%);\n    opacity: 1;\n    animation: holdPulse 0.3s ease-in-out;\n}\n\n.panel-drag-handle.holding {\n    transform: scale(0.99);\n    transition: transform 0.1s ease;\n}\n\n@keyframes holdPulse {\n    0% { opacity: 0.3; }\n    50% { opacity: 0.6; }\n    100% { opacity: 0.3; }\n}\n\n/* Make expand/collapse button non-draggable with 5px border */\n.panel-drag-handle .expand-icon {\n    position: relative;\n    z-index: 10;\n    pointer-events: auto;\n    cursor: pointer;\n    padding: 5px;\n    margin: -5px;\n    border-radius: 4px;\n}\n\n.panel-drag-handle .expand-icon:hover {\n    background-color: rgba(255, 255, 255, 0.1);\n}\n\n/* Panel header container */\n.panel-header-container {\n    display: flex;\n    align-items: center;\n    width: 100%;\n    padding: 0;\n    box-sizing: border-box;\n}\n\n/* Drag handle area */\n.drag-handle-area {\n    flex-shrink: 0;\n    cursor: grab;\n    padding: 0.25rem;\n    border-radius: 4px;\n    transition: background-color 0.2s ease;\n    margin-left: 3px;\n    margin-top: -8px;\n    min-width: 2rem;\n    width: 2rem;\n}\n\n.drag-handle-area:hover {\n    background-color: rgba(99, 102, 241, 0.1);\n}\n\n/* Drag handle icon styling */\n.drag-handle-icon {\n    color: var(--primary-color);\n    font-size: 1.4rem;\n    font-weight: bold;\n    opacity: 1;\n    transition: opacity 0.2s ease;\n    display: block;\n    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);\n}\n\n.drag-handle-area:hover .drag-handle-icon {\n    opacity: 1;\n    color: var(--text-primary);\n}\n\n/* Adjust drag handle position for Controls and Algorithms panels */\n#basicControlsSection .drag-handle-area {\n    margin-top: -12px;\n}\n\n#searchSection .drag-handle-area {\n    margin-top: -12px;\n}\n\n/* Adjust title position for Controls and Algorithms panels */\n#basicControlsSection .expandable-header {\n    transform: translateY(3px);\n}\n\n#searchSection .expandable-header {\n    transform: translateY(3px);\n}\n\n\n\n/* Drop preview styles */\n.drop-preview {\n    animation: dropPreviewPulse 1s ease-in-out infinite;\n    box-shadow: 0 0 10px rgba(99, 102, 241, 0.3);\n    cursor: pointer;\n    transition: transform 0.2s ease;\n}\n\n.drop-preview:hover {\n    transform: scale(1.02);\n}\n\n.drop-indicator {\n    animation: dropIndicatorFade 1.5s ease-in-out infinite;\n}\n\n@keyframes dropPreviewPulse {\n    0% { \n        background-color: rgba(99, 102, 241, 0.1);\n        border-color: rgba(99, 102, 241, 0.6);\n        box-shadow: 0 0 10px rgba(99, 102, 241, 0.3);\n    }\n    50% { \n        background-color: rgba(99, 102, 241, 0.15);\n        border-color: rgba(99, 102, 241, 0.8);\n        box-shadow: 0 0 15px rgba(99, 102, 241, 0.4);\n    }\n    100% { \n        background-color: rgba(99, 102, 241, 0.1);\n        border-color: rgba(99, 102, 241, 0.6);\n        box-shadow: 0 0 10px rgba(99, 102, 241, 0.3);\n    }\n}\n\n@keyframes dropIndicatorFade {\n    0% { opacity: 0.7; }\n    50% { opacity: 1; }\n    100% { opacity: 0.7; }\n}\n\n\n\n/* Ensure proper spacing between panels */\n.draggable-panel + .draggable-panel {\n    margin-top: 1rem;\n}\n\n/* Animation for panel reordering */\n.sidebar-content {\n    transition: none;\n}\n\n.sidebar-content.reordering {\n    transition: all 0.3s ease;\n}\n\n/* Panel drag styling */\n.panel-drag-handle {\n    position: relative;\n}\n\n/* Ensure interactive elements stay above the drag overlay */\n.panel-drag-handle button,\n.panel-drag-handle input,\n.panel-drag-handle select,\n.panel-drag-handle textarea,\n.panel-drag-handle a,\n.panel-drag-handle label,\n.panel-drag-handle .control-group,\n.panel-drag-handle .button-group,\n.panel-drag-handle .slider-container,\n.panel-drag-handle .checkbox-label,\n.panel-drag-handle .checkmark {\n    position: relative;\n    z-index: 2;\n}\n\n/* Prevent text selection during drag */\n.draggable-panel.dragging * {\n    user-select: none;\n}\n\n/* Visual feedback for draggable panels - moved to header */\n/* Controls Panel */\n#basicControlsSection.draggable-panel .expandable-header::before {\n    content: \'\';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 2px;\n    background: linear-gradient(90deg, transparent, var(--primary-color), transparent);\n    opacity: 0;\n    transition: opacity 0.2s ease;\n}\n\n#basicControlsSection.draggable-panel:hover .expandable-header::before {\n    opacity: 1;\n}\n\n/* Edit Controls Panel */\n#editControlsSection.draggable-panel .expandable-header::before {\n    content: \'\';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 2px;\n    background: linear-gradient(90deg, transparent, var(--primary-color), transparent);\n    opacity: 0;\n    transition: opacity 0.2s ease;\n}\n\n#editControlsSection.draggable-panel:hover .expandable-header::before {\n    opacity: 1;\n}\n\n/* Search/Algorithms Panel */\n#searchSection.draggable-panel .expandable-header::before {\n    content: \'\';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 2px;\n    background: linear-gradient(90deg, transparent, var(--primary-color), transparent);\n    opacity: 0;\n    transition: opacity 0.2s ease;\n}\n\n#searchSection.draggable-panel:hover .expandable-header::before {\n    opacity: 1;\n}\n\n/* Save & Export Panel */\n#saveExportSection.draggable-panel .expandable-header::before {\n    content: \'\';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 2px;\n    background: linear-gradient(90deg, transparent, var(--primary-color), transparent);\n    opacity: 0;\n    transition: opacity 0.2s ease;\n}\n\n#saveExportSection.draggable-panel:hover .expandable-header::before {\n    opacity: 1;\n}\n\n/* Canvas Management Panel */\n#canvasManagementSection.draggable-panel .expandable-header::before {\n    content: \'\';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 2px;\n    background: linear-gradient(90deg, transparent, var(--primary-color), transparent);\n    opacity: 0;\n    transition: opacity 0.2s ease;\n}\n\n#canvasManagementSection.draggable-panel:hover .expandable-header::before {\n    opacity: 1;\n}\n\n/* Utilities Panel */\n#utilitiesSection.draggable-panel .expandable-header::before {\n    content: \'\';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 2px;\n    background: linear-gradient(90deg, transparent, var(--primary-color), transparent);\n    opacity: 0;\n    transition: opacity 0.2s ease;\n}\n\n#utilitiesSection.draggable-panel:hover .expandable-header::before {\n    opacity: 1;\n}\n\n/* Ensure panels maintain their expanded/collapsed state during drag */\n.draggable-panel .expandable-content {\n    transition: none;\n}\n\n.draggable-panel.dragging .expandable-content {\n    transition: none !important;\n}\n\n\n\n\n\n/* Ensure right sidebar panels have proper spacing */\n.right-sidebar .draggable-panel + .draggable-panel {\n    margin-top: 1rem;\n}\n\n/* Add styles for select options to make them smaller */\n.control-group select option {\n    font-size: 0.75rem;\n}\n\n.control-group select {\n    font-size: 0.875rem;\n}\n\n.btn-magenta {\n    background: linear-gradient(135deg, #f27eec 0%, #e85de0 100%);\n    border: 1px solid #d94dd4;\n    color: white;\n    box-shadow: 0 2px 4px rgba(242, 126, 236, 0.3);\n}\n\n.btn-magenta:hover:not(:disabled) {\n    background: linear-gradient(135deg, #e85de0 0%, #d94dd4 100%);\n    border-color: #c93dc8;\n    box-shadow: 0 4px 8px rgba(242, 126, 236, 0.4);\n    transform: translateY(-1px);\n}\n\n.btn-magenta:active:not(:disabled) {\n    background: linear-gradient(135deg, #d94dd4 0%, #c93dc8 100%);\n    transform: translateY(0);\n    box-shadow: 0 2px 4px rgba(242, 126, 236, 0.3);\n}\n\n.root-vertex-display {\n    position: relative;\n}\n\n.root-display {\n    background: var(--bg-tertiary);\n    border: 1px solid var(--border-color);\n    border-radius: var(--radius-md);\n    padding: 0.75rem;\n    min-height: 40px;\n    width: 100%;\n    display: flex;\n    align-items: center;\n    transition: var(--transition);\n    overflow: hidden; /* Prevent content from overflowing */\n}\n\n.root-display.has-root {\n    border-color: var(--primary-color);\n    background: var(--bg-secondary);\n}\n\n.root-placeholder {\n    color: var(--text-muted);\n    font-size: 0.75rem;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    max-width: 100%;\n}\n\n.root-vertex-label {\n    font-size: 0.875rem;\n    font-weight: 500;\n    color: var(--text-primary);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    max-width: 100%;\n}',""]);const s=a},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},601:e=>{e.exports=function(e){return e[1]}},659:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,exports:{}};return e[r](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0;var r=n(72),i=n.n(r),o=n(825),a=n.n(o),s=n(659),d=n.n(s),l=n(56),c=n.n(l),h=n(540),g=n.n(h),p=n(113),m=n.n(p),u=n(365),v={};v.styleTagTransform=m(),v.setAttributes=c(),v.insert=d().bind(null,"head"),v.domAPI=a(),v.insertStyleElement=g(),i()(u.A,v),u.A&&u.A.locals&&u.A.locals;class f{constructor(){this.canvas=document.getElementById("graphCanvas"),this.ctx=this.canvas.getContext("2d"),this.whiteBoxWidth=2e3,this.whiteBoxHeight=2e3,this.canvasColor="#374151",this.vertices=[],this.edges=[],this.nextVertexId=1,this.selectedVertices=[],this.flashingVertices=new Set,this.distanceFlashingVertices=new Set,this.visitedVertices=new Set,this.pathVertices=new Set,this.visitedEdges=new Set,this.pathEdges=new Set,this.currentTraversalEdge=null,this.traversalProgress=0,this.distanceModeVertices=[],this.isDistanceMode=!1,this.isDragging=!1,this.draggedVertex=null,this.dragStartX=0,this.dragStartY=0,this.hasDragged=!1,this.dragThreshold=5,this.justFinishedDragging=!1,this.draggedEdge=null,this.isDraggingEdge=!1,this.edgeControlPointSize=8,this.editModeElement=null,this.editModeType=null,this.longPressTimer=null,this.longPressDelay=2500,this.holdProgress=0,this.holdProgressVertex=null,this.holdStartTime=null,this.holdProgressAnimation=null,this.holdTimerWasActive=!1,this.shakeOffset=0,this.shakeAnimationId=null,this._editPreview=null,this.isDeleteMode=!1,this.verticesToDelete=new Set,this.originalVertices=[],this.originalEdges=[],this.isSearching=!1,this.targetVertex=null,this.selectedTargetVertex=null,this.animationSpeed=500,this.traversalDirection="forward",this.currentTheme=document.documentElement.getAttribute("data-theme")||"dark",this.vertexSize=25,this.vertexColor="#1f2937",this.vertexBorderColor="#111827",this.vertexFontSize=14,this.vertexFontFamily="Inter, sans-serif",this.vertexFontColor="#ffffff",this.edgeColor="#6b7280",this.edgeWidth=2,this.edgeFontSize=12,this.edgeFontFamily="Inter, sans-serif",this.edgeFontColor="#374151",this.edgeType="straight",this.edgeDirection="undirected",this.autosaveEnabled=!0,this.autosaveInterval=null,this.savedGraphs=[],this.lastSavedState=null,this.pendingAction=null,this.rootUserSelected=!1,this.showMouseCoordinates=!0,this.mouseX=0,this.mouseY=0,this.showCoordinateGrid=!1,this.gridDensity=50,this.showVertices=!0,this.showEdges=!0,this.gridSpacing=50,this.debugMode=!1,this.vertexDrawCount=new Map,this.hideLabels=!1,this.timeDisplayMode="digital",this.initializeCanvas(),this.initializeEventListeners(),this.startAutoSave(),this.loadSavedGraphs(),this.setupExpandableSections(),this.setupMouseCoordinateTracking(),this.setupMinimalEditModeEvents(),this.updateInfo(),this.updateRootVertexDisplay(),this.updateTime(),setInterval(()=>this.updateTime(),1e3),this.draw(),this.lastVertexClick=null,setTimeout(()=>{this.hideSharedConfirmation()},0);const e=document.getElementById("sharedConfirmation");e&&e.style.setProperty("display","none","important")}startEditModeTimer(e){this.longPressTimer&&clearTimeout(this.longPressTimer),this.holdProgressAnimation&&cancelAnimationFrame(this.holdProgressAnimation),this.holdStartTime=Date.now(),this.holdProgressVertex=e,this.holdTimerWasActive=!1,this.startHoldProgressAnimation(),this.longPressTimer=setTimeout(()=>{this.editModeElement||this.hasDragged||this.draggedVertex!==e||(this.enterEditMode(e),this.updateStatus(`Editing vertex "${e.label}"`)),this.clearHoldProgress()},this.longPressDelay)}startHoldProgressAnimation(){const e=()=>{if(this.holdProgressVertex&&this.holdStartTime){const t=Date.now()-this.holdStartTime,n=this.longPressDelay;if(t>=1e3){const e=Math.min(1,(t-1e3)/(n-1e3));this.holdProgress=e,t>=1250&&(this.holdTimerWasActive=!0),this.draw()}t<n&&this.holdProgressVertex&&(this.holdProgressAnimation=requestAnimationFrame(e))}};this.holdProgressAnimation=requestAnimationFrame(e)}clearHoldProgress(){this.holdStartTime=null,this.holdProgressVertex=null,this.holdProgress=0,this.holdTimerWasActive=!1,this.holdProgressAnimation&&(cancelAnimationFrame(this.holdProgressAnimation),this.holdProgressAnimation=null),this.draw()}initializeCanvas(){this.resizeCanvas(),window.addEventListener("resize",()=>{this.resizeCanvas(),this.draw()}),window.matchMedia&&window.matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`).addEventListener("change",()=>{this.resizeCanvas(),this.draw()}),this.updateRootDropdown()}resizeCanvas(){const e=window.devicePixelRatio||1;this.canvas.width=this.whiteBoxWidth*e,this.canvas.height=this.whiteBoxHeight*e,this.canvas.style.width=this.whiteBoxWidth+"px",this.canvas.style.height=this.whiteBoxHeight+"px",this.ctx.setTransform(1,0,0,1,0,0),this.ctx.scale(e,e),this.forceRedraw()}initializeEventListeners(){this.canvas.addEventListener("click",e=>this.handleCanvasClick(e)),this.canvas.addEventListener("contextmenu",e=>this.handleRightClick(e)),this.canvas.addEventListener("mousedown",e=>this.handleMouseDown(e)),this.canvas.addEventListener("mousemove",e=>this.handleMouseMove(e)),this.canvas.addEventListener("mouseup",e=>this.handleMouseUp(e)),document.getElementById("vertexSize").addEventListener("input",e=>{this.vertexSize=parseInt(e.target.value),document.getElementById("vertexSizeValue").textContent=this.vertexSize});const e=document.getElementById("edgeWeight");e?(e.disabled=!1,e.readOnly=!1,e.style.pointerEvents="auto",e.style.opacity="1",e.addEventListener("input",e=>{this.updateStatus("Edge weight set - will be applied to next edge created")}),e.addEventListener("focus",e=>{console.log("Edge weight input focused")}),e.addEventListener("click",e=>{console.log("Edge weight input clicked")}),console.log("Edge weight input initialized successfully")):console.error("Edge weight input not found!");const t=document.getElementById("edgeTypeStraight"),n=document.getElementById("edgeTypeCurved");t&&t.addEventListener("change",()=>{t.checked&&(this.edgeType="straight",this.forceRedraw(),this.updateStatus("Edge type set to Straight"))}),n&&n.addEventListener("change",()=>{n.checked&&(this.edgeType="curved",this.forceRedraw(),this.updateStatus("Edge type set to Curved"))});const r=document.getElementById("edgeDirectionUndirected"),i=document.getElementById("edgeDirectionDirected");r&&r.addEventListener("change",()=>{r.checked&&(this.edgeDirection="undirected",this.forceRedraw(),this.updateStatus("Edge direction set to Undirected"))}),i&&i.addEventListener("change",()=>{i.checked&&(this.edgeDirection="directed-forward",this.forceRedraw(),this.updateStatus("Edge direction set to Directed"))}),document.getElementById("autosaveToggle").addEventListener("change",e=>{this.autosaveEnabled=e.target.checked,this.updateStatus("Auto-save "+(this.autosaveEnabled?"enabled":"disabled"))});const o=document.getElementById("mouseCoordinateToggle");if(o){o.checked=this.showMouseCoordinates,console.log("Mouse coordinate checkbox found and initialized:",this.showMouseCoordinates);const e=document.getElementById("mousePositionDisplay");e&&(e.style.display=this.showMouseCoordinates?"block":"none"),o.addEventListener("change",e=>{this.showMouseCoordinates=e.target.checked,this.updateMouseCoordinateDisplay(),this.updateStatus("Mouse coordinates "+(this.showMouseCoordinates?"enabled":"disabled")),console.log("Mouse coordinate checkbox changed to:",this.showMouseCoordinates)}),o.addEventListener("click",e=>{e.stopPropagation(),console.log("Mouse coordinate checkbox clicked")})}else console.error("Mouse coordinate checkbox not found!");const a=document.getElementById("coordinateGridToggle");a?a.addEventListener("change",e=>{this.showCoordinateGrid=e.target.checked;const t=document.getElementById("gridDensityContainer");t&&(t.style.display=this.showCoordinateGrid?"block":"none"),this.forceRedraw()}):console.error("Coordinate grid toggle not found!");const s=document.getElementById("gridDensity");s?s.addEventListener("input",e=>{this.gridDensity=parseInt(e.target.value),this.updateGridSpacing(),this.draw()}):console.error("Grid density slider not found!");const d=document.getElementById("hideLabelsToggle");d?(d.checked=!this.hideLabels,d.addEventListener("change",e=>{this.hideLabels=!e.target.checked,this.draw(),this.updateStatus("Vertex labels "+(this.hideLabels?"hidden":"shown"))})):console.error("Show labels toggle not found!");const l=document.getElementById("vertexVisibilityToggle");l?(l.checked=this.showVertices,l.addEventListener("change",e=>{this.showVertices=e.target.checked,this.draw(),this.updateStatus("Vertices "+(this.showVertices?"shown":"hidden"))})):console.error("Vertex visibility toggle not found!");const c=document.getElementById("edgeVisibilityToggle");c?(c.checked=this.showEdges,c.addEventListener("change",e=>{this.showEdges=e.target.checked,this.draw(),this.updateStatus("Edges "+(this.showEdges?"shown":"hidden"))})):console.error("Edge visibility toggle not found!"),document.getElementById("hideInstructions").addEventListener("click",()=>{this.hideInstructions()}),document.getElementById("themeToggle").addEventListener("click",()=>{this.toggleTheme()}),document.getElementById("helpBtn").addEventListener("click",()=>{window.showInstructionsModal?window.showInstructionsModal():console.error("showInstructionsModal function not found")}),document.getElementById("runBFS").addEventListener("click",()=>{this.runBFS()}),document.getElementById("runDFS").addEventListener("click",()=>{this.runDFS()}),document.getElementById("stopSearch").addEventListener("click",()=>{this.stopSearch()}),document.getElementById("animationSpeed").addEventListener("input",e=>{const t=parseInt(e.target.value);this.animationSpeed=2100-t}),document.getElementById("contactBtn").addEventListener("click",()=>{this.showContactModal()});const h=document.getElementById("formatJpg"),g=document.getElementById("formatPng");h&&h.addEventListener("change",()=>{h.checked&&(this.screenshotFormat="jpg",console.log("Screenshot format changed to JPG"))}),g&&g.addEventListener("change",()=>{g.checked&&(this.screenshotFormat="png",console.log("Screenshot format changed to PNG"))});const p=document.getElementById("clockBtn");p&&p.addEventListener("click",()=>{this.toggleTimeDisplay()}),document.getElementById("contactForm").addEventListener("submit",e=>{e.preventDefault(),this.handleContactSubmit()});const m=document.getElementById("newGraph"),u=document.getElementById("saveGraph"),v=document.getElementById("loadGraph"),f=document.getElementById("takeScreenshot");m?m.addEventListener("click",()=>{console.log("New Graph button clicked"),this.createNewGraph()}):console.error("New Graph button not found!"),u?u.addEventListener("click",()=>{console.log("Save Graph button clicked"),this.saveGraph()}):console.error("Save Graph button not found!"),v?v.addEventListener("click",()=>{console.log("Load Graph button clicked"),this.showLoadConfirmation()}):console.error("Load Graph button not found!"),f?f.addEventListener("click",()=>{console.log("Take Screenshot button clicked"),this.takeScreenshot()}):console.error("Take Screenshot button not found!");const b=document.getElementById("shareGraph");b?b.addEventListener("click",()=>{console.log("Share Graph button clicked"),this.shareGraph()}):console.error("Share Graph button not found!");const y=document.getElementById("deleteAllGraphs");y?y.addEventListener("click",()=>{this.showSharedConfirmation("deleteAllGraphs")}):console.error("Delete All Graphs button not found!");const x=document.getElementById("clearGraph");x?x.addEventListener("click",()=>{this.showSharedConfirmation("clearGraph")}):console.error("Clear Graph button not found!");const w=document.getElementById("confirmAction"),S=document.getElementById("cancelAction");w?w.addEventListener("click",()=>{this.confirmPendingAction()}):console.error("Confirm Action button not found!"),S?S.addEventListener("click",()=>{this.hideSharedConfirmation(),this.updateStatus("Operation cancelled")}):console.error("Cancel Action button not found!");const E=document.getElementById("deleteNodesBtn"),k=document.getElementById("saveDeleteChanges"),M=document.getElementById("cancelDeleteChanges");E?E.addEventListener("click",()=>{this.enterDeleteMode()}):console.error("Delete Nodes button not found!"),k?k.addEventListener("click",()=>{this.saveDeleteChanges()}):console.error("Save Delete Changes button not found!"),M?M.addEventListener("click",()=>{this.cancelDeleteChanges()}):console.error("Cancel Delete Changes button not found!"),document.getElementById("loadFileInput").addEventListener("change",e=>{this.handleFileLoad(e)}),document.addEventListener("keydown",e=>{"Escape"===e.key&&this.editModeElement&&this.exitEditMode()});const C=document.getElementById("searchRoot");C&&C.addEventListener("change",()=>{this.rootUserSelected=!0}),this.canvas.addEventListener("contextmenu",e=>e.preventDefault())}startAutoSave(){this.autoSaveInterval=setInterval(()=>{this.vertices.length>0&&this.autoSave()},3e4)}autoSave(){if(!this.hasUnsavedChanges())return;const e=this.exportGraph(),t=(new Date).toISOString(),n={name:`Graph ${(new Date).toLocaleDateString()}`,data:e,timestamp:t,vertices:this.vertices.length,edges:this.edges.length,isAutoSave:!0};try{localStorage.setItem("graph_autosave_current",JSON.stringify(n)),this.updateStatus("Graph auto-saved")}catch(e){console.error("Auto-save failed:",e)}}loadSavedGraphs(){try{const e=localStorage.getItem("savedGraphs");if(e){const t=JSON.parse(e);this.savedGraphs=t.map(e=>e.data?e:{name:e.name||"Unnamed Graph",data:e,timestamp:e.timestamp||(new Date).toISOString(),vertices:e.vertices||0,edges:e.edges||0}),this.updateSavedGraphsList()}}catch(e){console.error("Failed to load saved graphs:",e)}}updateSavedGraphsList(){const e=document.getElementById("savedGraphsList");e.innerHTML="",this.savedGraphs.slice(0,5).forEach((t,n)=>{const r=document.createElement("div");r.className="saved-graph-item",t.pendingDelete&&r.classList.add("pending-delete"),r.innerHTML=`\n                <div class="saved-graph-info">\n                    <div class="saved-graph-name" data-index="${n}">${t.name}</div>\n                    <div class="saved-graph-details">${t.vertices} vertices, ${t.edges} edges</div>\n                    <div class="saved-graph-time">Last edited: ${new Date(t.timestamp).toLocaleString()}</div>\n                </div>\n                <div class="saved-graph-actions">\n                    ${t.pendingDelete?'<button class="confirm-delete-btn btn btn-sm btn-success" title="Confirm Delete"><i class="fas fa-check"></i></button>':'<button class="edit-name-btn btn btn-sm btn-outline-primary" title="Rename"><i class="fas fa-edit"></i></button>'}\n                    <button class="delete-btn btn btn-sm btn-outline-danger" title="${t.pendingDelete?"Undo Delete":"Delete"}">\n                        <i class="fas fa-${t.pendingDelete?"undo":"trash"}"></i>\n                    </button>\n                </div>\n            `,r.addEventListener("click",()=>{t.pendingDelete||this.loadSavedGraphWithConfirmation(t)});const i=r.querySelector(".edit-name-btn"),o=r.querySelector(".saved-graph-name");i&&i.addEventListener("click",e=>{e.stopPropagation();const r=document.createElement("input");r.type="text",r.value=t.name,r.style.cssText="width: 100%; padding: 0.25rem 0.5rem; border: 1px solid var(--primary-color); border-radius: var(--radius-sm); background: var(--bg-secondary); color: var(--text-primary); font-size: 0.875rem; font-weight: 500;";const i=o.innerHTML;o.innerHTML="",o.appendChild(r),r.focus(),r.select();const a=()=>{const e=r.value.trim();if(e&&e!==t.name){if(this.savedGraphs.some((t,r)=>r!==n&&t.name===e))return void this.updateStatus(`Name "${e}" already exists!`);t.name=e,o.innerHTML=e,this.updateStatus(`Graph renamed to "${e}"`),localStorage.setItem("savedGraphs",JSON.stringify(this.savedGraphs)),this.updateSavedGraphsList()}else o.innerHTML=i};r.addEventListener("blur",a),r.addEventListener("keydown",e=>{"Enter"===e.key?a():"Escape"===e.key&&(o.innerHTML=i)})});const a=r.querySelector(".confirm-delete-btn");a&&a.addEventListener("click",e=>{e.stopPropagation(),this.currentGraphId===t.id&&(this.currentGraphId=null),this.savedGraphs.splice(n,1),localStorage.setItem("savedGraphs",JSON.stringify(this.savedGraphs)),this.updateSavedGraphsList(),this.updateStatus("Graph deleted.")}),r.querySelector(".delete-btn").addEventListener("click",e=>{e.stopPropagation(),t.pendingDelete?(t.pendingDelete=!1,this.updateSavedGraphsList(),this.updateStatus("Graph deletion cancelled.")):(t.pendingDelete=!0,this.updateSavedGraphsList(),this.updateStatus("Graph marked for deletion. Click check to confirm."))}),e.appendChild(r)})}getTimestampString(){const e=new Date;return e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0")+"-"+String(e.getDate()).padStart(2,"0")+" "+String(e.getHours()).padStart(2,"0")+":"+String(e.getMinutes()).padStart(2,"0")+":"+String(e.getSeconds()).padStart(2,"0")}saveGraph(e=!1){console.log("saveGraph function called",e?"(auto-save)":"(manual)");let t,n=this.currentGraphId;if(n){const e=this.savedGraphs.find(e=>e.id===n);t=e?e.name:this.getTimestampString()}else n=Date.now(),this.currentGraphId=n,t=this.getTimestampString();const r=this.exportGraph(),i=(new Date).toISOString(),o={id:n,name:t,data:r,timestamp:i,vertices:this.vertices.length,edges:this.edges.length},a=this.savedGraphs.findIndex(e=>e.id===n);-1!==a?this.savedGraphs[a]=o:this.savedGraphs.unshift(o),this.savedGraphs.length>10&&(this.savedGraphs=this.savedGraphs.slice(0,10));try{localStorage.setItem("savedGraphs",JSON.stringify(this.savedGraphs)),this.updateSavedGraphsList(),this.lastSavedState=JSON.stringify({vertices:this.vertices.map(e=>({id:e.id,x:e.x,y:e.y,label:e.label})),edges:this.edges.map(e=>({from:e.from.id,to:e.to.id,weight:e.weight,type:e.type}))}),e||this.updateStatus(`Graph "${t}" saved successfully!`)}catch(e){console.error("Failed to save graph:",e),this.updateStatus("Failed to save graph")}}loadSavedGraphWithConfirmation(e){console.log("loadSavedGraphWithConfirmation called",e),this.hasUnsavedChanges()?this.saveCurrentGraphAndLoadSpecific(e):this.loadSavedGraph(e)}loadSavedGraph(e){console.log("loadSavedGraph called",e);try{this.vertices=[],this.edges=[],this.nextVertexId=1,this.selectedVertices=[],this.draggedVertex=null,this.isDragging=!1,this.distanceModeVertices=[],this.isDistanceMode=!1,this.visitedVertices.clear(),this.pathVertices.clear(),this.isSearching=!1,this.editingVertex=null,this.selectedTargetVertex=null,this.currentGraphId=e.id,this.importGraph(e.data),this.updateTargetVertexDisplay(),this.updateInfo(),this.updateRootDropdown(),this.draw(),this.updateStatus(`Loaded graph: "${e.name}"`),console.log("Graph loaded successfully")}catch(e){console.error("Failed to load saved graph:",e),this.updateStatus("Failed to load saved graph")}}saveCurrentGraphAndLoadSpecific(e){let t,n=this.currentGraphId;if(n){const e=this.savedGraphs.find(e=>e.id===n);t=e?e.name:this.getTimestampString()}else n=Date.now(),this.currentGraphId=n,t=this.getTimestampString();const r=this.exportGraph(),i=(new Date).toISOString(),o={id:n,name:t,data:r,timestamp:i,vertices:this.vertices.length,edges:this.edges.length},a=this.savedGraphs.findIndex(e=>e.id===n);-1!==a?this.savedGraphs[a]=o:this.savedGraphs.unshift(o),this.savedGraphs.length>10&&(this.savedGraphs=this.savedGraphs.slice(0,10));try{localStorage.setItem("savedGraphs",JSON.stringify(this.savedGraphs)),this.updateSavedGraphsList(),this.updateStatus(`Current graph saved before loading "${e.name}"`)}catch(e){console.error("Failed to save current graph:",e),this.updateStatus("Failed to save current graph")}this.loadSavedGraph(e)}loadGraph(){document.getElementById("loadFileInput").click()}handleFileLoad(e){const t=e.target.files[0];if(!t)return;const n=new FileReader;n.onload=e=>{try{const n=JSON.parse(e.target.result);this.importGraph(n),this.currentGraphId=null,this.updateStatus(`Loaded graph from file: ${t.name}`)}catch(e){console.error("Failed to parse graph file:",e),this.updateStatus("Invalid graph file format")}},n.readAsText(t),e.target.value=""}takeScreenshot(){console.log("takeScreenshot function called"),console.log("White box dimensions:",this.whiteBoxWidth,"x",this.whiteBoxHeight),console.log("Number of vertices:",this.vertices.length),console.log("Number of edges:",this.edges.length);try{const e=document.createElement("canvas"),t=e.getContext("2d");console.log("Created temporary canvas"),e.width=this.whiteBoxWidth,e.height=this.whiteBoxHeight,console.log("Set temp canvas size to:",e.width,"x",e.height),document.getElementById("formatJpg");const n=document.getElementById("formatPng"),r=n&&n.checked?"png":"jpg";"png"===r?t.clearRect(0,0,e.width,e.height):(t.fillStyle="dark"===this.currentTheme?"#374151":"#e0f2fe",t.fillRect(0,0,e.width,e.height)),console.log("Filled background"),console.log("Drawing graph on screenshot canvas..."),this.drawOnCanvas(t,this.whiteBoxWidth,this.whiteBoxHeight),console.log("Starting blob conversion..."),e.toBlob(e=>{if(console.log("Blob callback executed, blob:",e),e){console.log("Blob size:",e.size,"bytes");const t=URL.createObjectURL(e);console.log("Created object URL:",t);const n=document.createElement("a");n.href=t,n.download=`graph-screenshot-${(new Date).toISOString().slice(0,19).replace(/:/g,"-")}.${r}`,n.style.display="none",document.body.appendChild(n),console.log("Triggering download..."),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t),this.updateStatus(`Screenshot saved as ${r.toUpperCase()}!`),console.log("Screenshot downloaded successfully")}else console.error("Failed to create blob for screenshot"),this.updateStatus("Failed to create screenshot")},"png"===r?"image/png":"image/jpeg","png"===r?1:.9),console.log("toBlob called, waiting for callback...")}catch(e){console.error("Error taking screenshot:",e),console.error("Error stack:",e.stack),this.updateStatus("Error taking screenshot")}}shareGraph(){console.log("shareGraph function called");try{const e=document.createElement("canvas"),t=e.getContext("2d");console.log("Created temporary canvas for sharing"),e.width=this.whiteBoxWidth,e.height=this.whiteBoxHeight,console.log("Set temp canvas size to:",e.width,"x",e.height),document.getElementById("formatJpg");const n=document.getElementById("formatPng"),r=n&&n.checked?"png":"jpg";"png"===r?t.clearRect(0,0,e.width,e.height):(t.fillStyle="dark"===this.currentTheme?"#374151":"#e0f2fe",t.fillRect(0,0,e.width,e.height)),console.log("Filled background for sharing"),console.log("Drawing graph on share canvas..."),this.drawOnCanvas(t,this.whiteBoxWidth,this.whiteBoxHeight),console.log("Starting blob conversion for sharing..."),e.toBlob(e=>{if(console.log("Share blob callback executed, blob:",e),e){console.log("Share blob size:",e.size,"bytes");const t=`graph-${(new Date).toISOString().slice(0,19).replace(/:/g,"-")}.${r}`,n=new File([e],t,{type:"png"===r?"image/png":"image/jpeg"});navigator.share&&navigator.canShare&&navigator.canShare({files:[n]})?navigator.share({title:"Graph Visualizer Pro - My Graph",text:"Hey, check out this cool graph I made with Graph Visualizer Pro",files:[n]}).then(()=>{console.log("Share successful"),this.updateStatus("Graph shared successfully!")}).catch(e=>{}):(console.log("Web Share API not supported"),this.updateStatus("Sharing not supported on this device"))}else console.error("Failed to create blob for sharing"),this.updateStatus("Failed to create share image")},"png"===r?"image/png":"image/jpeg","png"===r?1:.9),console.log("toBlob called for sharing, waiting for callback...")}catch(e){console.error("Error sharing graph:",e),console.error("Error stack:",e.stack),this.updateStatus("Error sharing graph")}}drawSimpleEdge(e,t){if(e.strokeStyle="#000000",e.lineWidth=2,e.lineCap="round",e.beginPath(),e.moveTo(t.from.x,t.from.y),e.lineTo(t.to.x,t.to.y),e.stroke(),"undirected"!==t.direction&&this.drawSimpleArrow(e,t),null!==t.weight&&""!==t.weight){const n=(t.from.x+t.to.x)/2,r=(t.from.y+t.to.y)/2;e.fillStyle="#ffffff",e.fillRect(n-15,r-8,30,16),e.fillStyle="#000000",e.font="12px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText(t.weight.toString(),n,r)}}drawSimpleArrow(e,t){const n=Math.PI/6,r=t.to.x-t.from.x,i=t.to.y-t.from.y,o=Math.atan2(i,r);let a,s;if("directed-forward"!==t.direction)return;a=t.to.x,s=t.to.y;const d=this.vertexSize,l=t.to,c=a-l.x,h=s-l.y,g=Math.sqrt(c*c+h*h);let p,m;g>0?(p=l.x+c/g*d,m=l.y+h/g*d):(p=l.x+d*Math.cos(o),m=l.y+d*Math.sin(o)),e.strokeStyle="#000000",e.lineWidth=2,e.lineCap="round",e.beginPath(),e.moveTo(p,m),e.lineTo(p-10*Math.cos(o-n),m-10*Math.sin(o-n)),e.moveTo(p,m),e.lineTo(p-10*Math.cos(o+n),m-10*Math.sin(o+n)),e.stroke()}drawSimpleVertex(e,t){const n=this.vertexSize;e.beginPath(),e.arc(t.x,t.y,n,0,2*Math.PI),e.fillStyle="#ffffff",e.fill(),e.strokeStyle="#000000",e.lineWidth=2,e.stroke(),e.font="14px Arial",e.fillStyle="#000000",e.textAlign="center",e.textBaseline="middle",e.fillText(t.label,t.x,t.y)}drawEdgeForScreenshot(e,t){const n=t.color||this.edgeColor,r=t.width||this.edgeWidth,i=t.fontSize||this.edgeFontSize,o=t.fontFamily||this.edgeFontFamily,a=t.fontColor||this.edgeFontColor;if(e.strokeStyle=n,e.lineWidth=r,e.lineCap="round",e.lineJoin="round",e.beginPath(),"curved"===t.type){const n={x:(t.from.x+t.to.x)/2,y:(t.from.y+t.to.y)/2-40};e.moveTo(t.from.x,t.from.y),e.quadraticCurveTo(n.x,n.y,t.to.x,t.to.y)}else e.moveTo(t.from.x,t.from.y),e.lineTo(t.to.x,t.to.y);if(e.stroke(),"undirected"!==t.direction&&this.drawArrowForScreenshot(e,t),null!==t.weight&&""!==t.weight){let n,r;"curved"===t.type?(n=(t.from.x+t.to.x)/2,r=(t.from.y+t.to.y)/2-60):(n=(t.from.x+t.to.x)/2,r=(t.from.y+t.to.y)/2),e.fillStyle="dark"===this.currentTheme?"rgba(15, 23, 42, 0.9)":"rgba(255, 255, 255, 0.9)",e.fillRect(n-20,r-12,40,24),e.fillStyle=a,e.font=`bold ${i}px ${o}`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.weight.toString(),n,r)}}drawArrowForScreenshot(e,t){const n=Math.PI/6;let r,i,o;if("curved"===t.type){const e={x:(t.from.x+t.to.x)/2,y:(t.from.y+t.to.y)/2-40},n=t.to.x-e.x,r=t.to.y-e.y;o=Math.atan2(r,n)}else{const e=t.to.x-t.from.x,n=t.to.y-t.from.y;o=Math.atan2(n,e)}if("directed-forward"!==t.direction)return;r=t.to.x,i=t.to.y;const a=t.from.size||this.vertexSize,s=t.to,d=r-s.x,l=i-s.y,c=Math.sqrt(d*d+l*l);let h,g;c>0?(h=s.x+d/c*-a,g=s.y+l/c*-a):(h=s.x+-a*Math.cos(o),g=s.y+-a*Math.sin(o)),e.strokeStyle=t.color||this.edgeColor,e.lineWidth=t.width||this.edgeWidth,e.lineCap="round",e.lineJoin="round",e.beginPath(),e.moveTo(h,g),e.lineTo(h-15*Math.cos(o-n),g-15*Math.sin(o-n)),e.moveTo(h,g),e.lineTo(h-15*Math.cos(o+n),g-15*Math.sin(o+n)),e.stroke()}drawVertexForScreenshot(e,t){const n=t.color||this.vertexColor,r=t.borderColor||this.vertexBorderColor,i=t.fontSize||this.vertexFontSize,o=t.fontFamily||this.vertexFontFamily,a=t.fontColor||this.vertexFontColor,s=t.size||this.vertexSize;e.beginPath(),e.arc(t.x,t.y,s,0,2*Math.PI),e.fillStyle=n,e.fill(),e.strokeStyle=r,e.lineWidth=2,e.stroke(),this.hideLabels||(e.font=`${i}px ${o}`,e.fillStyle=a,e.textAlign="center",e.textBaseline="middle",e.shadowColor="rgba(0, 0, 0, 0.5)",e.shadowBlur=2,e.shadowOffsetX=1,e.shadowOffsetY=1,e.fillText(t.label,t.x,t.y),e.shadowColor="transparent",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0)}drawOnCanvas(e,t,n){e.clearRect(0,0,t,n),this.edges.forEach(t=>this.drawEdgeOnCanvas(e,t)),this.showVertices&&this.vertices.forEach(t=>this.drawVertexOnCanvas(e,t))}drawEdgeOnCanvas(e,t){const n=t.color||this.edgeColor,r=t.width||this.edgeWidth,i=t.fontSize||this.edgeFontSize,o=t.fontFamily||this.edgeFontFamily,a=t.fontColor||this.edgeFontColor;if(e.strokeStyle=n,e.lineWidth=r,e.lineCap="round",e.lineJoin="round","dashed"===t.lineStyle?e.setLineDash([8,4]):e.setLineDash([]),e.beginPath(),"curved"===t.type){const n={x:(t.from.x+t.to.x)/2,y:(t.from.y+t.to.y)/2-40};e.moveTo(t.from.x,t.from.y),e.quadraticCurveTo(n.x,n.y,t.to.x,t.to.y)}else e.moveTo(t.from.x,t.from.y),e.lineTo(t.to.x,t.to.y);if(e.stroke(),e.setLineDash([]),"undirected"!==t.direction&&this.drawArrowOnCanvas(e,t),null!==t.weight&&""!==t.weight){let n,r;"curved"===t.type?(n=(t.from.x+t.to.x)/2,r=(t.from.y+t.to.y)/2-60):(n=(t.from.x+t.to.x)/2,r=(t.from.y+t.to.y)/2),e.fillStyle="dark"===this.currentTheme?"rgba(15, 23, 42, 0.9)":"rgba(255, 255, 255, 0.9)",e.fillRect(n-20,r-12,40,24),e.fillStyle=a,e.font=`bold ${i}px ${o}`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.weight.toString(),n,r)}}drawArrowOnCanvas(e,t){const n=Math.PI/6;let r,i,o;if("curved"===t.type&&t.controlPoint){const e=t.controlPoint,n=t.to.x-e.x,r=t.to.y-e.y;o=Math.atan2(r,n)}else{const e=t.to.x-t.from.x,n=t.to.y-t.from.y;o=Math.atan2(n,e)}if("directed-forward"!==t.direction)return;r=t.to.x,i=t.to.y;const a=t.from.size||this.vertexSize,s=t.to,d=r-s.x,l=i-s.y,c=Math.sqrt(d*d+l*l);let h,g;c>0?(h=s.x+d/c*-a,g=s.y+l/c*-a):(h=s.x+-a*Math.cos(o),g=s.y+-a*Math.sin(o)),e.strokeStyle=t.color||this.edgeColor,e.lineWidth=t.width||this.edgeWidth,e.lineCap="round",e.lineJoin="round",e.beginPath(),e.moveTo(h,g),e.lineTo(h-15*Math.cos(o-n),g-15*Math.sin(o-n)),e.moveTo(h,g),e.lineTo(h-15*Math.cos(o+n),g-15*Math.sin(o+n)),e.stroke()}drawVertexOnCanvas(e,t){const n=t.color||this.vertexColor,r=t.borderColor||this.vertexBorderColor,i=t.fontSize||this.vertexFontSize,o=t.fontFamily||this.vertexFontFamily,a=t.fontColor||this.vertexFontColor,s=t.size||this.vertexSize;e.beginPath(),e.arc(t.x,t.y,s,0,2*Math.PI),e.fillStyle=n,e.fill(),e.strokeStyle=r,e.lineWidth=2,e.stroke(),this.hideLabels||(e.font=`${i}px ${o}`,e.fillStyle=a,e.textAlign="center",e.textBaseline="middle",e.shadowColor="rgba(0, 0, 0, 0.5)",e.shadowBlur=2,e.shadowOffsetX=1,e.shadowOffsetY=1,e.fillText(t.label,t.x,t.y),e.shadowColor="transparent",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),e.fillText(t.label,t.x,t.y),e.shadowColor="transparent",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0}exportGraph(){return{vertices:this.vertices.map(e=>({id:e.id,x:e.x,y:e.y,label:e.label,size:e.size,color:e.color,borderColor:e.borderColor,fontSize:e.fontSize,fontFamily:e.fontFamily,fontColor:e.fontColor})),edges:this.edges.map(e=>({from:e.from.id,to:e.to.id,weight:e.weight,type:e.type,direction:e.direction,controlPoint:e.controlPoint,color:e.color,width:e.width,fontSize:e.fontSize,fontFamily:e.fontFamily,fontColor:e.fontColor,lineStyle:e.lineStyle||"solid"})),nextVertexId:this.nextVertexId,vertexSize:this.vertexSize,edgeType:this.edgeType,edgeDirection:this.edgeDirection,theme:this.currentTheme,vertexColor:this.vertexColor,vertexBorderColor:this.vertexBorderColor,vertexFontSize:this.vertexFontSize,vertexFontFamily:this.vertexFontFamily,vertexFontColor:this.vertexFontColor,edgeColor:this.edgeColor,edgeWidth:this.edgeWidth,edgeFontSize:this.edgeFontSize,edgeFontFamily:this.edgeFontFamily,edgeFontColor:this.edgeFontColor}}importGraph(e){if(console.log("importGraph called",e),this.vertices=[],this.edges=[],this.selectedVertices=[],this.draggedVertex=null,this.visitedVertices.clear(),this.pathVertices.clear(),this.editingVertex=null,this.vertices=e.vertices.map(e=>({id:e.id,x:e.x,y:e.y,label:e.label,size:e.size,color:e.color,borderColor:e.borderColor,fontSize:e.fontSize,fontFamily:e.fontFamily,fontColor:e.fontColor})),this.edges=e.edges.map(e=>({from:this.vertices.find(t=>t.id===e.from),to:this.vertices.find(t=>t.id===e.to),weight:e.weight,type:e.type,direction:e.direction||"undirected",controlPoint:e.controlPoint,color:e.color,width:e.width,fontSize:e.fontSize,fontFamily:e.fontFamily,fontColor:e.fontColor,lineStyle:e.lineStyle||"solid"})),this.nextVertexId=e.nextVertexId||this.vertices.length+1,this.vertexSize=e.vertexSize||25,this.edgeType=e.edgeType||"straight",this.edgeDirection=e.edgeDirection||"undirected",this.vertexColor=e.vertexColor||"#1e293b",this.vertexBorderColor=e.vertexBorderColor||"#475569",this.vertexFontSize=e.vertexFontSize||14,this.vertexFontFamily=e.vertexFontFamily||"Inter",this.vertexFontColor=e.vertexFontColor||"#ffffff",this.edgeColor=e.edgeColor||"#6366f1",this.edgeWidth=e.edgeWidth||3,this.edgeFontSize=e.edgeFontSize||14,this.edgeFontFamily=e.edgeFontFamily||"Inter",this.edgeFontColor=e.edgeFontColor||"#06b6d4",e.theme&&e.theme!==this.currentTheme){this.currentTheme=e.theme,document.documentElement.setAttribute("data-theme",this.currentTheme);const t=document.getElementById("themeToggle"),n=t.querySelector("i");"light"===this.currentTheme?(n.className="fas fa-sun",t.title="Switch to dark mode"):(n.className="fas fa-moon",t.title="Switch to light mode")}this.lastSavedState=JSON.stringify({vertices:this.vertices.map(e=>({id:e.id,x:e.x,y:e.y,label:e.label})),edges:this.edges.map(e=>({from:e.from.id,to:e.to.id,weight:e.weight,type:e.type,direction:e.direction,controlPoint:e.controlPoint,lineStyle:e.lineStyle||"solid"})),vertexSize:this.vertexSize,edgeType:this.edgeType,edgeDirection:this.edgeDirection,vertexColor:this.vertexColor,vertexBorderColor:this.vertexBorderColor,vertexFontSize:this.vertexFontSize,vertexFontFamily:this.vertexFontFamily,vertexFontColor:this.vertexFontColor,edgeColor:this.edgeColor,edgeWidth:this.edgeWidth,edgeFontSize:this.edgeFontSize,edgeFontFamily:this.edgeFontFamily,edgeFontColor:this.edgeFontColor}),this.updateInfo(),this.draw(),this.updateRootDropdown()}toggleTheme(){this.currentTheme="dark"===this.currentTheme?"light":"dark",document.documentElement.setAttribute("data-theme",this.currentTheme);const e=document.getElementById("themeToggle"),t=e.querySelector("i");"light"===this.currentTheme?(t.className="fas fa-sun",e.title="Switch to dark mode"):(t.className="fas fa-moon",e.title="Switch to light mode"),this.draw(),this.updateStatus(`Switched to ${this.currentTheme} mode`)}getMousePos(e){const t=this.canvas.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}handleCanvasClick(e){const t=this.getMousePos(e);if(this.handleDeleteButtonClick(t))return;if(this.justFinishedDragging)return void console.log("Click prevented - just finished dragging");const n=this.getVertexAt(t.x,t.y);if(n)return this.editModeElement&&"vertex"===this.editModeType?void this.enterEditMode(n):void 0;if(this.editModeElement)return void console.log("Click prevented - in edit mode");if(this.isDeleteMode)return void console.log("Click prevented - in delete mode");const r=this.getEdgeAt(t.x,t.y);if(!r)return this.selectedVertices.length>0?(this.selectedVertices=[],this.flashingVertices.clear(),this.draw(),void this.updateStatus("Vertex selection cleared")):void this.addVertex(t.x,t.y);this.toggleEdgeLineStyle(r)}handleRightClick(e){if(e.preventDefault(),this.simultaneousClickDetected)return;if(this.isSearching)return;if(this.isDeleteMode||this.editModeElement)return;const t=this.getMousePos(e),n=this.getVertexAt(t.x,t.y);n&&this.handleVertexRightSelect(n)}handleVertexLeftEdge(e){if(this.editModeElement||this.isDragging||this.hasDragged)return;const t=Date.now();if(this.lastVertexClick&&this.lastVertexClick.vertexId===e.id&&t-this.lastVertexClick.time<1e3){const t=document.getElementById("edgeWeight"),n=t.value.trim()?parseFloat(t.value):null;return this.addSelfLoop(e,n),t&&(t.value=""),this.selectedVertices=[],this.flashVertices(e,e),void(this.lastVertexClick=null)}if(this.lastVertexClick={vertexId:e.id,time:t},0===this.selectedVertices.length)this.selectedVertices.push(e),this.flashingVertices.add(e),this.updateStatus(`Selected vertex "${e.label}" for edge creation - left-click another vertex to create edge (or double-click for self-loop)`),this.draw();else if(1===this.selectedVertices.length){const t=this.selectedVertices[0],n=e;if("curved"!==this.edgeType&&this.edges.find(e=>e.from.id===t.id&&e.to.id===n.id||e.from.id===n.id&&e.to.id===t.id))return this.updateStatus("Straight line edge already exists between these vertices"),this.selectedVertices=[],this.flashingVertices.clear(),void this.draw();this.selectedVertices.push(n),this.draw();const r=document.getElementById("edgeWeight"),i=r.value.trim()?parseFloat(r.value):null;this.addEdge(t,n,i),r&&(r.value=""),this.selectedVertices=[],this.flashVertices(t,n),this.lastVertexClick=null}}handleVertexRightSelect(e){this.selectTargetVertex(e),this.isDistanceMode?this.handleDistanceModeClick(e):this.updateStatus(`Target vertex set to "${e.label}" (right-click)`)}handleVertexRightClick(e){if(!this.editModeElement){if(this.isDistanceMode)return this.selectTargetVertex(e),void this.updateStatus(`Target vertex set to "${e.label}"`);if(0===this.selectedVertices.length)this.selectedVertices.push(e),this.flashingVertices.add(e),this.updateStatus(`Selected vertex "${e.label}" for edge creation - right-click another vertex to create edge`),this.draw();else if(1===this.selectedVertices.length){const t=this.selectedVertices[0],n=e;if(t.id===n.id){this.selectedVertices.push(n),this.draw();const e=document.getElementById("edgeWeight"),r=e.value.trim()?parseFloat(e.value):null;return this.addSelfLoop(t,r),e&&(e.value=""),this.selectedVertices=[],void this.flashVertices(t,t)}if("curved"!==this.edgeType&&this.edges.find(e=>e.from.id===t.id&&e.to.id===n.id||e.from.id===n.id&&e.to.id===t.id))return this.updateStatus("Straight line edge already exists between these vertices"),this.selectedVertices=[],this.flashingVertices.clear(),void this.draw();this.selectedVertices.push(n),this.draw();const r=document.getElementById("edgeWeight"),i=r.value.trim()?parseFloat(r.value):null;this.addEdge(t,n,i),r&&(r.value=""),this.selectedVertices=[],this.flashVertices(t,n)}}}handleVertexClick(e){this.selectTargetVertex(e),this.isDistanceMode?this.handleDistanceModeClick(e):this.updateStatus(`Target vertex set to "${e.label}"`)}handleDistanceModeClick(e){if(this.distanceModeVertices.push(e),2===this.distanceModeVertices.length){this.flashDistanceVertices(this.distanceModeVertices[0],this.distanceModeVertices[1]);const{distance:e,path:t}=this.calculateShortestPathDistance(this.distanceModeVertices[0],this.distanceModeVertices[1]);this.showDistanceInfo(e,t),this.distanceModeVertices=[],this.isDistanceMode=!1,this.updateStatus("Distance calculated!")}else this.updateStatus("Click another vertex to calculate distance");this.draw()}calculateShortestPathDistance(e,t){if(e.id===t.id)return{distance:0,path:[e]};const n=this.getAdjacencyList(),r=[{vertex:e,distance:0}],i=new Set,o={};for(i.add(e.id);r.length>0;){const{vertex:e,distance:a}=r.shift();if(e.id===t.id){const t=[];let n=e;for(;n;)t.unshift(n),n=o[n.id];return{distance:a,path:t}}const s=n[e.id]||[];for(const t of s)i.has(t.id)||(i.add(t.id),o[t.id]=e,r.push({vertex:t,distance:a+1}))}return{distance:-1,path:[]}}handleMouseDown(e){const t=this.getMousePos(e),n=this.getVertexAt(t.x,t.y);if(n){if(this.editModeElement||this.isDeleteMode||this.isSearching)return;if(0!==e.button)return;this.selectedVertices.includes(n)&&(this.selectedVertices=[],this.draw()),this.draggedVertex=n,this.isDragging=!1,this.dragStartX=t.x,this.dragStartY=t.y,this.hasDragged=!1,this.holdTimerWasActive=!1,this.mouseDownOnVertex=n,this.mouseDownPos={x:t.x,y:t.y},this.canvas.style.cursor="grabbing",this.globalMouseMoveHandler=e=>this.handleMouseMove(e),this.globalMouseUpHandler=e=>this.handleMouseUp(e),document.addEventListener("mousemove",this.globalMouseMoveHandler),document.addEventListener("mouseup",this.globalMouseUpHandler),this.startEditModeTimer(n),e.preventDefault()}}isVertexTouchingCanvasBoundary(e,t,n){const r=n,i=n,o=this.whiteBoxWidth-n,a=this.whiteBoxHeight-n;return e<=r||e>=o||t<=i||t>=a}handleMouseMove(e){if(!this.isSearching)if(this.draggedVertex){const t=this.getMousePos(e),n=Math.sqrt(Math.pow(t.x-this.dragStartX,2)+Math.pow(t.y-this.dragStartY,2));n>this.dragThreshold&&!this.hasDragged&&(this.hasDragged=!0,this.isDragging=!0,console.log("Drag started - distance:",n),this.longPressTimer&&(clearTimeout(this.longPressTimer),this.longPressTimer=null),this.clearHoldProgress()),n<=this.dragThreshold&&this.hasDragged&&(this.hasDragged=!1,console.log("Drag stopped - restarting edit mode timer"),this.startEditModeTimer(this.draggedVertex));let r=this.draggedVertex.size||this.vertexSize;if(this.editModeElement===this.draggedVertex&&this._editPreview&&(r=this._editPreview.size),this.isVertexTouchingCanvasBoundary(t.x,t.y,r))return;const i=this.draggedVertex.x,o=this.draggedVertex.y;this.draggedVertex.x=t.x,this.draggedVertex.y=t.y,!this.debugMode||i===this.draggedVertex.x&&o===this.draggedVertex.y||console.log(`Vertex ${this.draggedVertex.label} moved from (${i}, ${this.draggedVertex.x}) to (${this.draggedVertex.x}, ${this.draggedVertex.y})`),this.editModeElement===this.draggedVertex&&"vertex"===this.editModeType&&this.updateEditModeInfo(),this.draw()}else if(this.isDraggingEdge&&this.draggedEdge){const t=this.getMousePos(e);this.draggedEdge.controlPoint={x:t.x,y:t.y},this.draw()}else{const t=this.getMousePos(e),n=this.getVertexAt(t.x,t.y),r=this.getEdgeAt(t.x,t.y,10);this.isSearching?this.canvas.style.cursor="not-allowed":this.canvas.style.cursor=n?"grab":r?"pointer":"crosshair"}}forceRedraw(){if(this.vertexDrawCount.clear(),this.draw(),this.debugMode){const e=new Map;this.vertices.forEach(t=>{const n=`${t.x},${t.y}`;e.has(n)?console.warn(`DUPLICATE POSITION DETECTED: ${t.label} and ${e.get(n)} at (${t.x}, ${t.y})`):e.set(n,t.label)})}}handleMouseUp(e){if(this.longPressTimer&&(clearTimeout(this.longPressTimer),this.longPressTimer=null),this.clearHoldProgress(),this.draggedVertex){if(this.isDragging)return this.isDragging=!1,this.draggedVertex=null,this.canvas.style.cursor="crosshair",this.hasDragged=!1,this.justFinishedDragging=!0,setTimeout(()=>{this.justFinishedDragging=!1},100),this.globalMouseMoveHandler&&(document.removeEventListener("mousemove",this.globalMouseMoveHandler),this.globalMouseMoveHandler=null),void(this.globalMouseUpHandler&&(document.removeEventListener("mouseup",this.globalMouseUpHandler),this.globalMouseUpHandler=null));{const t=this.getMousePos(e),n=this.getVertexAt(t.x,t.y);return n&&this.mouseDownOnVertex&&n.id===this.mouseDownOnVertex.id&&(this.editModeElement&&"vertex"===this.editModeType?this.enterEditMode(n):this.handleVertexLeftEdge(n)),this.draggedVertex=null,this.mouseDownOnVertex=null,this.mouseDownPos=null,this.canvas.style.cursor="crosshair",this.globalMouseMoveHandler&&(document.removeEventListener("mousemove",this.globalMouseMoveHandler),this.globalMouseMoveHandler=null),void(this.globalMouseUpHandler&&(document.removeEventListener("mouseup",this.globalMouseUpHandler),this.globalMouseUpHandler=null))}}this.isDraggingEdge&&this.draggedEdge&&(this.isDraggingEdge=!1,this.draggedEdge=null,this.canvas.style.cursor="crosshair",this.updateStatus("Edge curve adjusted"))}enterEditMode(e){console.log("[EditMode] Entering edit mode for vertex:",e.label),this.exitEditMode(),this.editModeElement=e,this.editModeType="vertex",this._editOriginal={label:e.label,size:e.size||this.vertexSize},this._editPreview={label:e.label,size:e.size||this.vertexSize,pendingDelete:!1},this._originalAllVertexSizes=this.vertices.map(e=>e.size||this.vertexSize),this.startShakeAnimation();const t=document.getElementById("editControlsSection");t&&(t.style.display="block"),document.querySelectorAll(".control-section").forEach(e=>{"editControlsSection"!==e.id&&(e.style.display="none")});const n=t.querySelector("h3");n&&(n.innerHTML=`<i class="fas fa-edit"></i> Edit Vertex "${e.label}"`);const r=document.getElementById("editVertexLabel"),i=document.getElementById("editVertexSize"),o=document.getElementById("editVertexSizeValue");r&&i&&o&&(r.value=e.label,i.value=e.size||this.vertexSize,o.textContent=e.size||this.vertexSize),r.style.borderColor="",r.style.boxShadow="";const a=document.getElementById("editVertexLabelWarning");a&&(a.textContent="");const s=document.getElementById("applyToAllToggle");s&&(s.checked=!1),setTimeout(()=>{r&&(r.focus(),r.select())},100),this._setupApplyToAllImmediateListeners(),this._updateEditPanelForPendingDelete(!1),this._updateDeleteButtonText(),this.draw()}_updateEditPanelForPendingDelete(e){const t=document.getElementById("editVertexLabel"),n=document.getElementById("editVertexSize"),r=document.getElementById("applyToAllToggle"),i=document.getElementById("saveVertexEdit");if(e){if(t){const e=t.closest(".control-group");if(e){let n=e.querySelector(".label-display");n||(n=document.createElement("div"),n.className="label-display",n.style.cssText="\n                            color: #8b5cf6;\n                            font-weight: 500;\n                            padding: 8px 12px;\n                            background: transparent;\n                            border: none;\n                            font-size: 14px;\n                            font-family: inherit;\n                        ",t.parentNode.insertBefore(n,t)),n.textContent=t.value||"No label",n.style.display="block",t.style.display="none"}}if(n&&(n.style.display="none"),r){const e=r.closest(".control-group");e&&(e.style.display="none")}i&&(i.innerHTML='<i class="fas fa-trash"></i> Confirm Deletion')}else{if(t){const e=t.closest(".control-group");if(e){const n=e.querySelector(".label-display");n&&(n.style.display="none"),t.style.display="block",t.disabled=!1,t.style.backgroundColor="",t.style.color=""}}if(n&&(n.style.display="block"),r){const e=r.closest(".control-group");e&&(e.style.display="block")}i&&(i.innerHTML='<i class="fas fa-check"></i> Save Edits')}this._updateDeleteButtonText()}_updateDeleteButtonText(){const e=document.getElementById("deleteCurrentVertex");e&&(this._editPreview&&this._editPreview.pendingDelete?e.innerHTML='<i class="fas fa-undo"></i> Un-delete Current Node':e.innerHTML='<i class="fas fa-trash"></i> Delete Current Node',e.disabled=!1)}exitEditMode(){this.stopShakeAnimation(),this.editModeElement=null,this.editModeType=null,this._editOriginal=null,this._editPreview=null,this._originalAllVertexSizes=null;const e=document.getElementById("editControlsSection");e&&(e.style.display="none");const t=document.getElementById("deleteModePanel");t&&(t.style.display="none"),document.querySelectorAll(".control-section").forEach(e=>{"editControlsSection"!==e.id&&"deleteModePanel"!==e.id&&(e.style.display="block")});const n=e?.querySelector("h3");n&&(n.innerHTML='<i class="fas fa-edit"></i> Edit Vertex'),this.draw()}startShakeAnimation(){this.editGlowProgress=0;const e=()=>{this.editModeElement&&(this.editGlowProgress=(this.editGlowProgress+.02)%(2*Math.PI),this.draw(),this.shakeAnimation=requestAnimationFrame(e))};this.shakeAnimation=requestAnimationFrame(e)}stopShakeAnimation(){this.shakeAnimation&&(cancelAnimationFrame(this.shakeAnimation),this.shakeAnimation=null),this.editGlowProgress=0,this.draw()}showEditControls(){const e=document.getElementById("stylingSection");e&&(e.style.display="none");const t=document.getElementById("editControlsSection");t&&(t.style.display="block");const n=document.getElementById("basicControlsSection");n&&(n.style.display="block");const r=document.getElementById("toolsSection");r&&(r.style.display="block");const i=document.getElementById("infoSection");i&&(i.style.display="block");const o=document.getElementById("saveLoadSection");o&&(o.style.display="block");const a=document.getElementById("searchSection");a&&(a.style.display="block"),document.getElementById("applyToAllVertices").checked=!1,document.getElementById("applyToAllEdges").checked=!1,this.applyToAllVertices=!1,this.applyToAllEdges=!1;const s=document.getElementById("editModeInfo");if(s)if("vertex"===this.editModeType){const e=this.edges.filter(e=>e.from.id===this.editModeElement.id||e.to.id===this.editModeElement.id).length;s.innerHTML=`\n                    <div class="edit-mode-item">\n                        <i class="fas fa-circle"></i>\n                        <strong>Vertex:</strong> ${this.editModeElement.label}\n                    </div>\n                    <div class="edit-mode-item">\n                        <i class="fas fa-map-marker-alt"></i>\n                        <strong>Position:</strong> (${Math.round(this.editModeElement.x)}, ${Math.round(this.editModeElement.y)})\n                    </div>\n                    <div class="edit-mode-item">\n                        <i class="fas fa-link"></i>\n                        <strong>Connected Edges:</strong> ${e}\n                    </div>\n                `,document.getElementById("vertexEditControls").style.display="block",document.getElementById("edgeEditControls").style.display="none",document.getElementById("editVertexColor").value=this.editModeElement.color||this.vertexColor,document.getElementById("editVertexBorderColor").value=this.editModeElement.borderColor||this.vertexBorderColor,document.getElementById("editVertexSize").value=this.editModeElement.size||this.vertexSize,document.getElementById("editVertexSizeValue").textContent=this.editModeElement.size||this.vertexSize,document.getElementById("editVertexFontSize").value=this.editModeElement.fontSize||this.vertexFontSize,document.getElementById("editVertexFontSizeValue").textContent=this.editModeElement.fontSize||this.vertexFontSize,document.getElementById("editVertexFontFamily").value=this.editModeElement.fontFamily||this.vertexFontFamily,document.getElementById("editVertexFontColor").value=this.editModeElement.fontColor||this.vertexFontColor,document.getElementById("editVertexLabel").value=this.editModeElement.label}else"edge"===this.editModeType&&(s.innerHTML=`\n                    <div class="edit-mode-item">\n                        <i class="fas fa-minus"></i>\n                        <strong>Edge:</strong> ${this.editModeElement.from.label} → ${this.editModeElement.to.label}\n                    </div>\n                    <div class="edit-mode-item">\n                        <i class="fas fa-weight-hanging"></i>\n                        <strong>Weight:</strong> ${this.editModeElement.weight||"None"}\n                    </div>\n                    <div class="edit-mode-item">\n                        <i class="fas fa-wave-square"></i>\n                        <strong>Type:</strong> ${this.editModeElement.type||"straight"}\n                    </div>\n                    <div class="edit-mode-item">\n                        <i class="fas fa-arrow-right"></i>\n                        <strong>Direction:</strong> ${this.editModeElement.direction||"undirected"}\n                    </div>\n                `,document.getElementById("edgeEditControls").style.display="block",document.getElementById("vertexEditControls").style.display="none",document.getElementById("editEdgeColor").value=this.editModeElement.color||this.edgeColor,document.getElementById("editEdgeWidth").value=this.editModeElement.width||this.edgeWidth,document.getElementById("editEdgeWidthValue").textContent=this.editModeElement.width||this.edgeWidth,document.getElementById("editEdgeFontSize").value=this.editModeElement.fontSize||this.edgeFontSize,document.getElementById("editEdgeFontSizeValue").textContent=this.editModeElement.fontSize||this.edgeFontSize,document.getElementById("editEdgeFontFamily").value=this.editModeElement.fontFamily||this.edgeFontFamily,document.getElementById("editEdgeFontColor").value=this.editModeElement.fontColor||this.edgeFontColor)}hideEditControls(){const e=document.getElementById("editControlsSection");e&&(e.style.display="none"),document.querySelectorAll(".control-section").forEach(e=>{"editControlsSection"!==e.id&&(e.style.display="block")})}deleteSelectedElement(){this.editModeElement&&this.editModeType&&("vertex"===this.editModeType?(this.edges=this.edges.filter(e=>e.from.id!==this.editModeElement.id&&e.to.id!==this.editModeElement.id),this.vertices=this.vertices.filter(e=>e.id!==this.editModeElement.id),this.updateStatus(`Vertex "${this.editModeElement.label}" deleted`)):"edge"===this.editModeType&&(this.edges=this.edges.filter(e=>e!==this.editModeElement),this.updateStatus("Edge deleted")),this.exitEditMode(),this.updateInfo(),this.updateRootVertexDisplay(),this.draw(),this.updateRootDropdown())}getVertexAt(e,t){return this.vertices.find(n=>{const r=Math.sqrt((n.x-e)**2+(n.y-t)**2);let i=n.size||this.vertexSize;return this.editModeElement===n&&this._editPreview&&(i=this._editPreview.size),r<=i})}getEdgeAt(e,t,n=null){return this.edges.find(r=>{if("self-loop"===r.type){const i=(r.from.size||this.vertexSize)+15,o=Math.sqrt((r.from.x-e)**2+(r.from.y-t)**2),a=null!==n?n:8;return Math.abs(o-i)<=a}if("curved"===r.type){let i=r.controlPoint;if(!i){const e=r.edgeIndex||0,t=40+50*e,n=Math.abs(r.from.x-r.to.x),o=Math.abs(r.from.y-r.to.y);if(n<.3*o&&o>20){const n=e%2==0?1:-1;i={x:(r.from.x+r.to.x)/2+t*n,y:(r.from.y+r.to.y)/2}}else{const n=e%2==0?1:-1;i={x:(r.from.x+r.to.x)/2,y:(r.from.y+r.to.y)/2-t*n}}}const o=null!==n?n:8;return this.isPointNearQuadraticCurve(e,t,r.from.x,r.from.y,i.x,i.y,r.to.x,r.to.y,o)}{const i=null!==n?n:8;return this.isPointNearLine(e,t,r.from.x,r.from.y,r.to.x,r.to.y,i)}})}isPointNearLine(e,t,n,r,i,o,a){const s=i-n,d=o-r,l=s*s+d*d;if(0===l)return!1;let c,h,g=((e-n)*s+(t-r)*d)/l;g<0?(c=n,h=r):g>1?(c=i,h=o):(c=n+g*s,h=r+g*d);const p=e-c,m=t-h;return Math.sqrt(p*p+m*m)<=a}toggleEdgeLineStyle(e){"dashed"===e.lineStyle?e.lineStyle="solid":e.lineStyle="dashed";const t="dashed"===e.lineStyle?"dashed":"solid";this.updateStatus(`Edge line style changed to ${t}`),this.draw()}addVertex(e,t){if(this.isDeleteMode)return void this.updateStatus("Cannot add vertices while in delete mode");const n=this.vertexSize;if(this.isVertexTouchingCanvasBoundary(e,t,n))return;let r=document.getElementById("vertexLabel").value.trim();if(r){if(this.vertices.find(e=>e.label===r))return void this.updateStatus(`Label "${r}" already exists! Each vertex must have a unique label.`)}else r=this.findNextAvailableLabel();const i={id:this.nextVertexId++,x:e,y:t,label:r,size:n,color:this.vertexColor,borderColor:this.vertexBorderColor,fontSize:this.vertexFontSize,fontFamily:this.vertexFontFamily,fontColor:this.vertexFontColor};this.vertices.push(i),this.updateInfo(),this.updateStatus(`Vertex "${r}" added!`),this.startVertexFadeInAnimation(i),document.getElementById("vertexLabel").value="",this.updateRootVertexDisplay(),this.autosaveEnabled&&this.saveGraph(!0)}findNextAvailableLabel(){const e=this.vertices.map(e=>e.label);let t=1;for(;e.includes(t.toString());)t++;return t.toString()}addEdge(e,t,n=null){if("curved"===this.edgeType){const r=this.edges.filter(n=>n.from===e&&n.to===t||n.from===t&&n.to===e),i=r.length,o={from:e,to:t,weight:n,type:this.edgeType,direction:this.edgeDirection,edgeIndex:i,lineStyle:"solid"};this.edges.push(o);const a=n?` (weight: ${n})`:"",s=i>0?` (edge ${i+1})`:"";this.updateStatus(`Curved edge created between vertices "${e.label}" and "${t.label}"${a}${s}`)}else if(this.edges.find(n=>n.from===e&&n.to===t||n.from===t&&n.to===e))this.updateStatus(`Edge already exists between vertices "${e.label}" and "${t.label}"`);else{const r={from:e,to:t,weight:n,type:this.edgeType,direction:this.edgeDirection,lineStyle:"solid"};this.edges.push(r);const i=n?` (weight: ${n})`:"";this.updateStatus(`Edge created between vertices "${e.label}" and "${t.label}"${i}`)}this.forceRedraw(),this.updateInfo(),this.autosaveEnabled&&this.saveGraph(!0)}addSelfLoop(e,t=null){if(this.edges.find(t=>t.from===e&&t.to===e))this.updateStatus(`Self-loop already exists on vertex "${e.label}"`);else{const n={from:e,to:e,weight:t,type:"self-loop",direction:this.edgeDirection,lineStyle:"solid"};this.edges.push(n);const r=t?` (weight: ${t})`:"";this.updateStatus(`Self-loop created on vertex "${e.label}"${r}`)}this.forceRedraw(),this.updateInfo(),this.autosaveEnabled&&this.saveGraph(!0)}getAdjacencyList(){const e={};return this.vertices.forEach(t=>{e[t.id]=[]}),this.edges.forEach(t=>{"undirected"===t.direction?(e[t.from.id].push(t.to),e[t.to.id].push(t.from)):"directed-forward"===t.direction?e[t.from.id].push(t.to):(e[t.from.id].push(t.to),e[t.to.id].push(t.from))}),e}findEdge(e,t){return this.edges.find(n=>!!(n.from.id===e.id&&n.to.id===t.id||n.from.id===t.id&&n.to.id===e.id)&&("directed-forward"!==n.direction||n.from.id===e.id&&n.to.id===t.id))}findVertexByLabel(e){return this.vertices.find(t=>t.label===e)}findMostRecentVertex(){return 0===this.vertices.length?null:this.vertices[this.vertices.length-1]}findMostUpwardVertex(){if(0===this.vertices.length)return null;const e=this.getAdjacencyList(),t=this.vertices.filter(t=>e[t.id]&&e[t.id].length>0);return 0===t.length?this.vertices.reduce((e,t)=>t.y<e.y?t:e):t.reduce((e,t)=>t.y<e.y?t:e)}isVertexReachable(e,t){if(!e||!t)return!1;if(e.id===t.id)return!0;const n=this.getAdjacencyList(),r=new Set,i=[e];for(r.add(e.id);i.length>0;){const e=n[i.shift().id]||[];for(const n of e){if(n.id===t.id)return!0;r.has(n.id)||(r.add(n.id),i.push(n))}}return!1}async runBFS(){if(!this.selectedTargetVertex)return void this.updateStatus("Please select a target vertex first");const e=document.getElementById("searchRoot").value,t=this.selectedTargetVertex;if(0===this.vertices.length)return void this.updateStatus("No vertices to search");let n;if(e){if(n=this.findVertexByLabel(e),!n)return void this.updateStatus(`Root vertex "${e}" not found`)}else n=this.findMostRecentVertex();const r=this.getAdjacencyList();r[n.id]&&0!==r[n.id].length&&this.isVertexReachable(n,t)?(this.startSearch(),await this.animateBFS(t,n)):this.updateStatus(`Target vertex "${t.label}" is not reachable from root vertex "${n.label}"`)}async runDFS(){if(!this.selectedTargetVertex)return void this.updateStatus("Please select a target vertex first");const e=document.getElementById("searchRoot").value,t=this.selectedTargetVertex;if(0===this.vertices.length)return void this.updateStatus("No vertices to search");let n;if(e){if(n=this.findVertexByLabel(e),!n)return void this.updateStatus(`Root vertex "${e}" not found`)}else n=this.findMostRecentVertex();const r=this.getAdjacencyList();r[n.id]&&0!==r[n.id].length?this.isVertexReachable(n,t)?(this.startSearch(),await this.animateDFS(t,n)):this.updateStatus(`Target vertex "${t.label}" is not reachable from root vertex "${n.label}"`):this.updateStatus("Root node must be connected to at least one other node")}startSearch(){this.isSearching=!0,this.visitedVertices.clear(),this.pathVertices.clear(),this.visitedEdges.clear(),this.pathEdges.clear(),document.getElementById("runBFS").disabled=!0,document.getElementById("runDFS").disabled=!0,document.getElementById("stopSearch").disabled=!1,this.updateStatus("Searching...")}stopSearch(e=!0){this.isSearching=!1,this.visitedVertices.clear(),this.pathVertices.clear(),this.visitedEdges.clear(),this.pathEdges.clear(),this.currentTraversalEdge=null,this.traversalProgress=0,document.getElementById("runBFS").disabled=!1,document.getElementById("runDFS").disabled=!1,document.getElementById("stopSearch").disabled=!0,this.draw(),e&&this.updateStatus("Search stopped")}async animateBFS(e,t){const n=new Set,r={},i={},o=[],a=[t];for(this.visitedVertices.clear(),this.pathVertices.clear(),this.visitedEdges.clear(),this.pathEdges.clear(),this.currentTraversalEdge=null,this.traversalProgress=0,n.add(t.id),i[t.id]=0,o.push(t);a.length>0&&this.isSearching;){const t=a.shift();if(this.visitedVertices.add(t),this.draw(),await this.sleep(),t.id===e.id){this.reconstructPath(r,e);const a=i[t.id],s=n.size;return void this.showSearchResult(!0,"BFS",a,s,o)}for(const e of this.edges){let s=null;e.from.id===t.id?"undirected"!==e.direction&&"directed-forward"!==e.direction||(s=e.to):e.to.id===t.id&&"undirected"===e.direction&&(s=e.from),s&&!n.has(s.id)&&(n.add(s.id),r[s.id]=t,i[s.id]=i[t.id]+1,a.push(s),o.push(s),await this.animateEdgeTraversal(e,null,()=>{this.visitedVertices.add(s),this.draw()},t,s),await this.sleep())}}if(this.isSearching){const e=n.size;this.showSearchResult(!1,"BFS",null,e,o)}}async animateDFS(e,t){const n=new Set,r={},i=[];this.visitedVertices.clear(),this.pathVertices.clear(),this.visitedEdges.clear(),this.pathEdges.clear(),this.currentTraversalEdge=null,this.traversalProgress=0;const o=async t=>{if(!this.isSearching)return!1;if(n.add(t.id),this.visitedVertices.add(t),i.push(t),this.draw(),await this.sleep(),t.id===e.id){this.reconstructPath(r,e),window&&window.console&&console.log("DFS pathVertices size:",this.pathVertices.size,Array.from(this.pathVertices).map(e=>e.label));const t=n.size;return this.showSearchResult(!0,"DFS",null,t,i),!0}for(const e of this.edges){let i=null;if(e.from.id===t.id?"undirected"!==e.direction&&"directed-forward"!==e.direction||(i=e.to):e.to.id===t.id&&"undirected"===e.direction&&(i=e.from),i&&!n.has(i.id)&&(r[i.id]=t,await this.animateEdgeTraversal(e,null,()=>{this.visitedVertices.add(i),this.draw()},t,i),await this.sleep(),await o(i)))return!0}return!1};if(!await o(t)&&this.isSearching){const e=n.size;this.showSearchResult(!1,"DFS",null,e,i)}}reconstructPath(e,t){const n=[];let r=t;for(;r;)n.unshift(r),r=e[r.id];this.pathVertices=new Set(n);for(let e=0;e<n.length-1;e++){const t=this.findEdge(n[e],n[e+1]);t&&this.pathEdges.add(t)}this.draw()}showSearchResult(e,t,n=null,r=null,i=null){this.isSearching=!1,this.visitedVertices.clear(),this.pathVertices.clear(),this.visitedEdges.clear(),this.pathEdges.clear(),this.currentTraversalEdge=null,this.traversalProgress=0,document.getElementById("runBFS").disabled=!1,document.getElementById("runDFS").disabled=!1,document.getElementById("stopSearch").disabled=!0;const o=document.getElementById("searchInfo");let a="";if(e){let e;e="DFS"===t?Math.max(0,r-1):Math.max(0,this.pathVertices.size-1),a=`${t} found target! ${null!==n?`Distance: ${n} edges`:`Path length: ${e} edges`}${null!==r?`, Visited: ${r} vertices`:""}`,this.updateStatus(`${t} found target vertex!`)}else a=`${t} did not find target vertex${null!==r?` (Visited ${r} vertices)`:""}`,this.updateStatus(`${t} completed - target not found`);i&&i.length>0&&(a+=`\n\nVisited path: ${i.map(e=>e.label).join(" → ")}`),o.textContent=a,o.classList.add("show"),setTimeout(()=>{o.classList.remove("show")},8e3),this.draw()}sleep(e=null){const t=null!==e?e:this.animationSpeed;return new Promise(e=>setTimeout(e,t))}async animateEdgeTraversal(e,t=null,n=null,r=null,i=null){if(!e)return;this.currentTraversalEdge=e,this.traversalProgress=0,r&&i?e.from.id===r.id&&e.to.id===i.id?this.traversalDirection="forward":e.from.id===i.id&&e.to.id===r.id?this.traversalDirection="backward":this.traversalDirection="forward":this.traversalDirection="forward";const o=t?t/20:this.animationSpeed/20;for(let e=0;e<=20&&this.isSearching;e++)this.traversalProgress=e/20,this.draw(),await new Promise(e=>setTimeout(e,o));this.visitedEdges.add(e),this.currentTraversalEdge=null,this.traversalProgress=0,this.traversalDirection="forward",n&&n()}hasUnsavedChanges(){return this.lastSavedState?JSON.stringify({vertices:this.vertices.map(e=>({id:e.id,x:e.x,y:e.y,label:e.label})),edges:this.edges.map(e=>({from:e.from.id,to:e.to.id,weight:e.weight,type:e.type,direction:e.direction,controlPoint:e.controlPoint,lineStyle:e.lineStyle||"solid"})),vertexSize:this.vertexSize,edgeType:this.edgeType,edgeDirection:this.edgeDirection,vertexColor:this.vertexColor,vertexBorderColor:this.vertexBorderColor,vertexFontSize:this.vertexFontSize,vertexFontFamily:this.vertexFontFamily,vertexFontColor:this.vertexFontColor,edgeColor:this.edgeColor,edgeWidth:this.edgeWidth,edgeFontSize:this.edgeFontSize,edgeFontFamily:this.edgeFontFamily,edgeFontColor:this.edgeFontColor})!==this.lastSavedState:this.vertices.length>0||this.edges.length>0}showLoadConfirmation(){console.log("showLoadConfirmation function called"),this.hasUnsavedChanges()?this.saveCurrentGraphAndLoad():this.showLoadDialog()}saveCurrentGraphAndLoad(){let e,t=this.currentGraphId;if(t){const n=this.savedGraphs.find(e=>e.id===t);e=n?n.name:this.getTimestampString()}else t=Date.now(),this.currentGraphId=t,e=this.getTimestampString();const n=this.exportGraph(),r=(new Date).toISOString(),i={id:t,name:e,data:n,timestamp:r,vertices:this.vertices.length,edges:this.edges.length},o=this.savedGraphs.findIndex(e=>e.id===t);-1!==o?this.savedGraphs[o]=i:this.savedGraphs.unshift(i),this.savedGraphs.length>10&&(this.savedGraphs=this.savedGraphs.slice(0,10));try{localStorage.setItem("savedGraphs",JSON.stringify(this.savedGraphs)),this.updateSavedGraphsList(),this.updateStatus("Current graph saved before loading new graph")}catch(e){console.error("Failed to save graph:",e),this.updateStatus("Failed to save current graph")}this.showLoadDialog()}showLoadDialog(){this.originalSavedGraphs=JSON.parse(JSON.stringify(this.savedGraphs));const e=document.createElement("div");e.className="modal-overlay",e.innerHTML=`\n            <div class="modal-content">\n                <h3><i class="fas fa-folder-open"></i> Load</h3>\n                <div class="load-options">\n                    <div class="load-section">\n                        <h4><i class="fas fa-history"></i> Recent Graphs</h4>\n                        <div id="loadRecentGraphs" class="load-graphs-list">\n                            ${0===this.savedGraphs.length?'<p class="no-graphs">No saved graphs found</p>':""}\n                        </div>\n                    </div>\n                    <div class="load-section">\n                        <h4><i class="fas fa-upload"></i> Import from File</h4>\n                        <input type="file" id="loadFileInputModal" accept=".json" style="display: none;">\n                        <button class="btn btn-secondary" id="browseFileBtn">\n                            <i class="fas fa-folder"></i> Browse Files\n                        </button>\n                    </div>\n                </div>\n                <div class="modal-buttons">\n                    <button class="btn btn-success" id="saveRenamesDeletionsBtn">\n                        <i class="fas fa-save"></i> Save Changes & Exit\n                    </button>\n                    <button class="btn btn-secondary" id="cancelLoadDialogBtn">\n                        <i class="fas fa-times"></i> Cancel\n                    </button>\n                </div>\n            </div>\n        `,document.body.appendChild(e),this.populateLoadRecentGraphs(),document.getElementById("browseFileBtn").addEventListener("click",()=>{document.getElementById("loadFileInputModal").click()}),document.getElementById("loadFileInputModal").addEventListener("change",t=>{this.handleFileLoad(t),document.body.removeChild(e)}),document.getElementById("cancelLoadDialogBtn").addEventListener("click",()=>{this.revertAllChanges(),document.body.removeChild(e)});const t=document.getElementById("saveRenamesDeletionsBtn");t.disabled=!1,t.addEventListener("click",()=>{this.commitAllChanges(),document.body.removeChild(e)})}populateLoadRecentGraphs(){const e=document.getElementById("loadRecentGraphs");e&&(e.innerHTML="",this.savedGraphs.forEach((t,n)=>{const r=document.createElement("div");r.className="load-graph-item",t.pendingDelete&&r.classList.add("pending-delete"),r.innerHTML=`\n                <div class="load-graph-info">\n                    <div class="load-graph-name" data-index="${n}">${t.name}</div>\n                    <div class="load-graph-details">${t.vertices} vertices, ${t.edges} edges</div>\n                    <div class="load-graph-time">${new Date(t.timestamp).toLocaleString()}</div>\n                </div>\n                <div class="load-graph-actions">\n                    ${t.pendingDelete?'<button class="confirm-delete-btn btn btn-sm btn-success" title="Confirm Delete"><i class="fas fa-check"></i></button>':'<button class="edit-name-btn btn btn-sm btn-outline-primary" title="Rename"><i class="fas fa-edit"></i></button>'}\n                    <button class="delete-btn btn btn-sm btn-outline-danger" title="${t.pendingDelete?"Undo Delete":"Delete"}">\n                        <i class="fas fa-${t.pendingDelete?"undo":"trash"}"></i>\n                    </button>\n                    <button class="btn btn-primary load-graph-btn" data-index="${n}" ${t.pendingDelete?"disabled":""}>\n                        <i class="fas fa-download"></i> Load\n                    </button>\n                </div>\n            `,r.querySelector(".load-graph-btn").addEventListener("click",()=>{t.pendingDelete||(this.loadSavedGraphWithConfirmation(t),document.body.removeChild(document.querySelector(".modal-overlay")))});const i=r.querySelector(".edit-name-btn"),o=r.querySelector(".load-graph-name");i&&i.addEventListener("click",e=>{e.stopPropagation(),t.pendingDelete||this.editSavedGraphName(n,o)});const a=r.querySelector(".confirm-delete-btn");a&&a.addEventListener("click",e=>{e.stopPropagation(),this.currentGraphId===t.id&&(this.currentGraphId=null),this.savedGraphs.splice(n,1),this.populateLoadRecentGraphs(),this.updateStatus("Graph deleted."),localStorage.setItem("savedGraphs",JSON.stringify(this.savedGraphs))}),r.querySelector(".delete-btn").addEventListener("click",e=>{e.stopPropagation(),t.pendingDelete?(t.pendingDelete=!1,this.populateLoadRecentGraphs(),this.updateStatus("Graph deletion cancelled.")):(t.pendingDelete=!0,this.populateLoadRecentGraphs(),this.updateStatus("Graph marked for deletion. Click check to confirm."))}),e.appendChild(r)}))}toggleDistanceMode(){this.isDistanceMode=!this.isDistanceMode,this.distanceModeVertices=[],this.selectedVertices=[],this.isDistanceMode?this.updateStatus("Distance mode: Click two vertices to calculate shortest path distance"):this.updateStatus("Distance mode disabled"),this.draw()}showDistanceInfo(e,t){const n=document.getElementById("distanceInfo"),r=document.getElementById("pathInfo");-1===e?(n.textContent="No path exists between these vertices",r.textContent=""):0===e?(n.textContent="Same vertex selected",r.textContent=""):(n.textContent=`Shortest path distance: ${e} edge${1!==e?"s":""}`,r.textContent=`Path: ${t.map(e=>e.label).join(" -> ")}`),n.classList.add("show"),r.classList.add("show"),setTimeout(()=>{n.classList.remove("show"),r.classList.remove("show")},5e3)}clearGraph(){this.showSharedConfirmation("clearGraph")}createNewGraph(){this.vertices.length>0||this.edges.length>0?(this.saveGraph(!0),this.updateStatus("Current graph saved, starting new graph")):this.updateStatus("Starting new graph"),this.vertices=[],this.edges=[],this.selectedVertices=[],this.targetVertex=null,this.distanceMode=!1,this.stopSearch(!1),this.exitEditMode(),this.flashingVertices.clear(),this.distanceFlashingVertices=null,this.currentGraphId=null,this.rootUserSelected=!1,this.updateInfo(),this.updateRootVertexDisplay(),this.updateTargetVertexDisplay(),this.draw()}hideInstructions(){const e=document.getElementById("instructionsOverlay");e&&(e.style.display="none")}updateInfo(){const e=document.getElementById("deleteNodesBtn");e&&(0===this.vertices.length?e.style.display="none":e.style.display="block")}updateStatus(e){const t=document.getElementById("statusMessageTop");t&&(t.textContent=e)}updateTime(){const e=new Date,t=`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}`,n=document.getElementById("digitalTime");n&&(n.textContent=t),"analog"===this.timeDisplayMode&&this.updateAnalogClock(e)}updateAnalogClock(e){const t=e.getHours()%12,n=e.getMinutes(),r=e.getSeconds(),i=(30*t+.5*n)*Math.PI/180,o=6*n*Math.PI/180,a=6*r*Math.PI/180,s=document.getElementById("hourHand");if(s){const e=50+20*Math.sin(i),t=50-20*Math.cos(i);s.setAttribute("x2",e),s.setAttribute("y2",t)}const d=document.getElementById("minuteHand");if(d){const e=50+27*Math.sin(o),t=50-27*Math.cos(o);d.setAttribute("x2",e),d.setAttribute("y2",t)}const l=document.getElementById("secondHand");if(l){const e=50+33*Math.sin(a),t=50-33*Math.cos(a);l.setAttribute("x2",e),l.setAttribute("y2",t)}}draw(){this.ctx.clearRect(0,0,this.whiteBoxWidth,this.whiteBoxHeight),this.ctx.globalAlpha=1,this.ctx.globalCompositeOperation="source-over",this.ctx.shadowColor="transparent",this.ctx.shadowBlur=0,this.ctx.shadowOffsetX=0,this.ctx.shadowOffsetY=0,this.ctx.setLineDash([]),this.drawCoordinateGrid(),this.showEdges&&this.edges.forEach(e=>this.drawEdge(e)),this.showVertices&&this.vertices.forEach(e=>{if(this.debugMode){console.log(`Drawing vertex: ${e.label} at (${e.x}, ${e.y})`);const t=`${e.label}-${e.x}-${e.y}`;this.vertexDrawCount.set(t,(this.vertexDrawCount.get(t)||0)+1),this.vertexDrawCount.get(t)>1&&console.warn(`VERTEX DRAWN MULTIPLE TIMES: ${e.label} at (${e.x}, ${e.y}) - drawn ${this.vertexDrawCount.get(t)} times`)}this.drawVertex(e)}),this.isDeleteMode&&this.showVertices&&this.vertices.forEach(e=>this.drawDeleteButton(e)),this.ctx.globalAlpha=1,this.ctx.globalCompositeOperation="source-over",this.ctx.shadowColor="transparent",this.ctx.shadowBlur=0,this.ctx.shadowOffsetX=0,this.ctx.shadowOffsetY=0}drawEdge(e){let t=e.from.x,n=e.from.y,r=e.to.x,i=e.to.y;this.editModeElement===e&&"edge"===this.editModeType&&(t+=this.shakeX,n+=this.shakeY,r+=this.shakeX,i+=this.shakeY);let o=e.color||this.edgeColor,a=e.width||this.edgeWidth,s=e.fontSize||this.edgeFontSize,d=e.fontFamily||this.edgeFontFamily,l=e.fontColor||this.edgeFontColor;if(this.editModeElement===e&&"edge"===this.editModeType&&(o="#ef4444"),this.currentTraversalEdge===e&&this.traversalProgress>0){let o,s,d,l;if(this.ctx.save(),"backward"===this.traversalDirection?(o=r,s=i,d=t,l=n):(o=t,s=n,d=r,l=i),this.ctx.strokeStyle=e.color||this.edgeColor,this.ctx.lineWidth=a,this.ctx.lineCap="round",this.ctx.beginPath(),"curved"===e.type){let o=e.controlPoint;if(!o){const a=e.edgeIndex||0,s=40+50*a,d=Math.abs(t-r),l=Math.abs(n-i);o=d<.3*l&&l>20?{x:(t+r)/2+s*(a%2==0?1:-1),y:(n+i)/2}:{x:(t+r)/2,y:(n+i)/2-s*(a%2==0?1:-1)}}this.ctx.moveTo(t,n),this.ctx.quadraticCurveTo(o.x,o.y,r,i)}else this.ctx.moveTo(t,n),this.ctx.lineTo(r,i);this.ctx.stroke();const c=this.ctx.createLinearGradient(o,s,d,l);let h,g;if(c.addColorStop(0,"#10b981"),c.addColorStop(.5,"#34d399"),c.addColorStop(1,"#10b981"),this.ctx.strokeStyle=c,this.ctx.lineWidth=Math.max(a,4),"curved"===e.type){let o=e.controlPoint;if(!o){const a=e.edgeIndex||0,s=40+50*a,d=Math.abs(t-r),l=Math.abs(n-i);o=d<.3*l&&l>20?{x:(t+r)/2+s*(a%2==0?1:-1),y:(n+i)/2}:{x:(t+r)/2,y:(n+i)/2-s*(a%2==0?1:-1)}}const a=this.traversalProgress;"backward"===this.traversalDirection?(h=Math.pow(1-a,2)*r+2*(1-a)*a*o.x+Math.pow(a,2)*t,g=Math.pow(1-a,2)*i+2*(1-a)*a*o.y+Math.pow(a,2)*n):(h=Math.pow(1-a,2)*t+2*(1-a)*a*o.x+Math.pow(a,2)*r,g=Math.pow(1-a,2)*n+2*(1-a)*a*o.y+Math.pow(a,2)*i)}else this.traversalDirection,h=o+(d-o)*this.traversalProgress,g=s+(l-s)*this.traversalProgress;if(this.ctx.beginPath(),"curved"===e.type){let a=e.controlPoint;if(!a){const o=e.edgeIndex||0,s=40+50*o,d=Math.abs(t-r),l=Math.abs(n-i);a=d<.3*l&&l>20?{x:(t+r)/2+s*(o%2==0?1:-1),y:(n+i)/2}:{x:(t+r)/2,y:(n+i)/2-s*(o%2==0?1:-1)}}this.traversalDirection,this.ctx.moveTo(o,s),this.ctx.quadraticCurveTo(a.x,a.y,h,g)}else this.ctx.moveTo(o,s),this.ctx.lineTo(h,g);return this.ctx.stroke(),this.ctx.shadowColor="rgba(16, 185, 129, 0.6)",this.ctx.shadowBlur=6,this.ctx.stroke(),void this.ctx.restore()}if(this.pathEdges.has(e)){this.ctx.save();const e=this.ctx.createLinearGradient(t,n,r,i);e.addColorStop(0,"#f59e0b"),e.addColorStop(.5,"#fbbf24"),e.addColorStop(1,"#f59e0b"),o=e,a=Math.max(a,4);const s=.005*Date.now(),d=.3*Math.sin(s)+.7;this.ctx.shadowColor="rgba(245, 158, 11, 0.6)",this.ctx.shadowBlur=8*d}else if(this.visitedEdges.has(e)){this.ctx.save();const e=this.ctx.createLinearGradient(t,n,r,i);e.addColorStop(0,"#10b981"),e.addColorStop(.5,"#34d399"),e.addColorStop(1,"#10b981"),o=e,a=Math.max(a,3),this.ctx.shadowColor="rgba(16, 185, 129, 0.4)",this.ctx.shadowBlur=4}if(this.ctx.strokeStyle=o,this.ctx.lineWidth=a,this.ctx.lineCap="round","dashed"===e.lineStyle?this.ctx.setLineDash([8,4]):this.ctx.setLineDash([]),this.ctx.beginPath(),"self-loop"===e.type){const r=e.from.size||this.vertexSize,i=t,o=n,a=.25*Math.PI,s=1.75*Math.PI,d=i+r*Math.cos(a),l=o+r*Math.sin(a),c=i+r*Math.cos(s),h=o+r*Math.sin(s),g=(d+c)/2,p=(l+h)/2,m=h-l,u=d-c,v=Math.sqrt(m*m+u*u),f=1.2*r,b=g+m/v*f,y=p+u/v*f,x=Math.sqrt((b-d)**2+(y-l)**2),w=Math.atan2(l-y,d-b),S=Math.atan2(h-y,c-b);this.ctx.beginPath(),this.ctx.arc(b,y,x,w,S,!1),this.ctx.stroke()}else if("curved"===e.type){const o=e.edgeIndex||0,a=40+50*o,s=Math.abs(t-r),d=Math.abs(n-i);let l;l=s<.3*d&&d>20?{x:(t+r)/2+a*(o%2==0?1:-1),y:(n+i)/2}:{x:(t+r)/2,y:(n+i)/2-a*(o%2==0?1:-1)},this.ctx.moveTo(t,n),this.ctx.quadraticCurveTo(l.x,l.y,r,i)}else this.ctx.moveTo(t,n),this.ctx.lineTo(r,i);if(this.ctx.stroke(),"undirected"!==e.direction&&(console.log("Drawing arrow for edge:",e.direction,"type:",e.type),this.drawArrow(e)),null!==e.weight&&""!==e.weight){let o,a;if("self-loop"===e.type)o=t+((e.from.size||this.vertexSize)+15)+20,a=n;else if("curved"===e.type){const s=e.edgeIndex||0,d=40+50*s,l=Math.abs(t-r),c=Math.abs(n-i);l<.3*c&&c>20?(o=(t+r)/2+d*(s%2==0?1:-1)+20,a=(n+i)/2):(o=(t+r)/2,a=(n+i)/2-d*(s%2==0?1:-1)-20)}else o=(t+r)/2,a=(n+i)/2;this.ctx.fillStyle="dark"===this.currentTheme?"rgba(15, 23, 42, 0.9)":"rgba(255, 255, 255, 0.9)",this.ctx.fillRect(o-20,a-12,40,24),this.ctx.fillStyle=l,this.ctx.font=`bold ${s}px ${d}`,this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(e.weight.toString(),o,a)}(this.pathEdges.has(e)||this.visitedEdges.has(e))&&this.ctx.restore(),this.editModeElement===e&&"edge"===this.editModeType&&(this.ctx.shadowColor="#ef4444",this.ctx.shadowBlur=15,this.ctx.stroke(),this.ctx.shadowBlur=0),this.ctx.shadowColor="transparent",this.ctx.shadowBlur=0,this.ctx.shadowOffsetX=0,this.ctx.shadowOffsetY=0,this.ctx.setLineDash([])}drawVertex(e){const t=this.ctx;t.setLineDash([]);let n=e.size||this.vertexSize,r=e.label,i=!1;this.editModeElement===e&&this._editPreview&&(n=this._editPreview.size,r=this._editPreview.label,i=!!this._editPreview.pendingDelete);const o=this.selectedVertices.includes(e),a=this.flashingVertices.has(e),s=this.distanceFlashingVertices&&this.distanceFlashingVertices.has(e),d=this.editModeElement===e&&"vertex"===this.editModeType,l=this.isDeleteMode&&this.verticesToDelete.has(e.id),c=this.holdProgressVertex===e&&this.holdProgress>0;let h=e.x,g=e.y,p=e.color||this.vertexColor,m=e.borderColor||this.vertexBorderColor;if(o||a){let t=0;void 0!==e.flashOpacity&&(t=e.flashOpacity),p=this.interpolateColor("#8b5cf6",e.color||this.vertexColor,t),m=this.interpolateColor("#a855f7",e.borderColor||this.vertexBorderColor,t)}else if(s){let t=1;void 0!==e.distanceFlashOpacity&&(t=1-e.distanceFlashOpacity),p=this.interpolateColor("#3b82f6",e.color||this.vertexColor,t),m=this.interpolateColor("#60a5fa",e.borderColor||this.vertexBorderColor,t)}else if(this.visitedVertices.has(e)){t.save();const e=t.createRadialGradient(h,g,0,h,g,1.5*n);e.addColorStop(0,"#10b981"),e.addColorStop(.7,"#059669"),e.addColorStop(1,"#047857"),p=e,m="#34d399";const r=.003*Date.now(),i=.3*Math.sin(r)+.7,o=t.createRadialGradient(h,g,n,h,g,2.5*n);o.addColorStop(0,`rgba(16, 185, 129, ${.3*i})`),o.addColorStop(.5,`rgba(16, 185, 129, ${.1*i})`),o.addColorStop(1,"rgba(16, 185, 129, 0)"),t.beginPath(),t.arc(h,g,2.5*n,0,2*Math.PI),t.fillStyle=o,t.fill()}else if(this.pathVertices.has(e)){t.save();const e=t.createRadialGradient(h,g,0,h,g,1.5*n);e.addColorStop(0,"#f59e0b"),e.addColorStop(.7,"#d97706"),e.addColorStop(1,"#b45309"),p=e,m="#fbbf24";const r=.004*Date.now(),i=.4*Math.sin(r)+.6,o=t.createRadialGradient(h,g,n,h,g,3*n);o.addColorStop(0,`rgba(245, 158, 11, ${.4*i})`),o.addColorStop(.5,`rgba(245, 158, 11, ${.2*i})`),o.addColorStop(1,"rgba(245, 158, 11, 0)"),t.beginPath(),t.arc(h,g,3*n,0,2*Math.PI),t.fillStyle=o,t.fill()}else this.distanceModeVertices.includes(e)&&(p="#3b82f6",m="#60a5fa");if(c){t.save();const e=n+(2*n-n)*this.holdProgress,r=.3+.4*this.holdProgress,i=.5+.5*this.holdProgress,o=t.createRadialGradient(h,g,n,h,g,e);o.addColorStop(0,`rgba(239, 68, 68, ${r*i})`),o.addColorStop(.5,`rgba(239, 68, 68, ${.7*r})`),o.addColorStop(1,"rgba(239, 68, 68, 0)"),t.beginPath(),t.arc(h,g,e,0,2*Math.PI),t.fillStyle=o,t.fill(),t.restore()}if(d&&void 0!==this.editGlowProgress){t.save();const e=2.5*n,r=.3*Math.sin(this.editGlowProgress)+.7,i=n+(e-n)*r,o=.4+.3*r,a=t.createRadialGradient(h,g,n,h,g,i);a.addColorStop(0,`rgba(239, 68, 68, ${o})`),a.addColorStop(.5,`rgba(239, 68, 68, ${.7*o})`),a.addColorStop(1,"rgba(239, 68, 68, 0)"),t.beginPath(),t.arc(h,g,i,0,2*Math.PI),t.fillStyle=a,t.fill(),t.restore()}if((l||i)&&(t.save(),t.globalAlpha=.6,p="#ec4899",m="#f472b6"),void 0!==e.fadeInOpacity&&(t.save(),t.globalAlpha=e.fadeInOpacity),t.beginPath(),t.arc(h,g,n,0,2*Math.PI),t.fillStyle=p,t.fill(),t.strokeStyle=m,t.lineWidth=2,t.stroke(),(this.visitedVertices.has(e)||this.pathVertices.has(e)||void 0!==e.flashOpacity||void 0!==e.distanceFlashOpacity||void 0!==e.fadeInOpacity)&&t.restore(),!this.hideLabels){const n=e.fontSize||this.vertexFontSize,i=e.fontFamily||this.vertexFontFamily,o=e.fontColor||this.vertexFontColor;t.font=`${n}px ${i}`,t.fillStyle=o,t.textAlign="center",t.textBaseline="middle",t.shadowColor="rgba(0, 0, 0, 0.5)",t.shadowBlur=2,t.shadowOffsetX=1,t.shadowOffsetY=1,t.fillText(r,h,g),t.shadowColor="transparent",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0}(l||i)&&t.restore()}drawArrow(e){const t=Math.PI/6;let n,r,i;if("self-loop"===e.type){const t=e.from.size||this.vertexSize,o=1.3*t,a=1.1*t,s=e.from.x,d=e.from.y-a,l=.25*Math.PI;n=s+o*Math.cos(l),r=d+o*Math.sin(l),i=l+Math.PI/2}else if("curved"===e.type){const t=e.edgeIndex||0,o=40+50*t,a=Math.abs(e.from.x-e.to.x),s=Math.abs(e.from.y-e.to.y);let d;if(a<.3*s&&s>20){const n=t%2==0?1:-1;d={x:(e.from.x+e.to.x)/2+o*n,y:(e.from.y+e.to.y)/2}}else{const n=t%2==0?1:-1;d={x:(e.from.x+e.to.x)/2,y:(e.from.y+e.to.y)/2-o*n}}const l=.85-.1*t,c=Math.max(.3,l);n=Math.pow(1-c,2)*e.from.x+2*(1-c)*c*d.x+Math.pow(c,2)*e.to.x,r=Math.pow(1-c,2)*e.from.y+2*(1-c)*c*d.y+Math.pow(c,2)*e.to.y;const h=e.to.x-d.x,g=e.to.y-d.y;i=Math.atan2(g,h)}else{const t=e.to.x-e.from.x,o=e.to.y-e.from.y;i=Math.atan2(o,t),n=e.to.x,r=e.to.y}if("directed-forward"!==e.direction)return;const o=e.from.size||this.vertexSize;let a,s;if("self-loop"===e.type)a=n,s=r-o;else{const t=e.to;if("curved"===e.type){const e=n-t.x,d=r-t.y,l=Math.sqrt(e*e+d*d);l>0?(a=t.x+e/l*o,s=t.y+d/l*o):(a=t.x+o*Math.cos(i),s=t.y+o*Math.sin(i))}else{const e=n-t.x,d=r-t.y,l=Math.sqrt(e*e+d*d);l>0?(a=t.x+e/l*-o,s=t.y+d/l*-o):(a=t.x+-o*Math.cos(i),s=t.y+-o*Math.sin(i))}}this.ctx.strokeStyle=e.color||this.edgeColor,this.ctx.lineWidth=e.width||this.edgeWidth,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.beginPath(),this.ctx.moveTo(a,s),this.ctx.lineTo(a-15*Math.cos(i-t),s-15*Math.sin(i-t)),this.ctx.moveTo(a,s),this.ctx.lineTo(a-15*Math.cos(i+t),s-15*Math.sin(i+t)),this.ctx.stroke()}adjustColor(e,t){const n=e.replace("#",""),r=parseInt(n,16);return`#${(Math.max(0,Math.min(255,(r>>16)+t))<<16|Math.max(0,Math.min(255,(r>>8&255)+t))<<8|Math.max(0,Math.min(255,(255&r)+t))).toString(16).padStart(6,"0")}`}updateRootDropdown(){const e=document.getElementById("searchRoot");if(!e)return;const t=e.value;for(;e.options.length>1;)e.remove(1);if(this.vertices.forEach(t=>{const n=document.createElement("option");n.value=t.label,n.textContent=t.label,e.appendChild(n)}),t&&Array.from(e.options).some(e=>e.value===t))e.value=t;else if(!t){const t=this.findMostRecentVertex();e.value=t?t.label:""}}selectTargetVertex(e){this.selectedTargetVertex=e,this.updateTargetVertexDisplay()}updateTargetVertexDisplay(){const e=document.getElementById("targetVertexDisplay");this.selectedTargetVertex?(e.innerHTML=`<span class="target-vertex-label">${this.selectedTargetVertex.label}</span>`,e.classList.add("has-target")):(e.innerHTML='<span class="target-placeholder">Unselected</span>',e.classList.remove("has-target"))}clearTargetVertex(){this.selectedTargetVertex=null,this.updateTargetVertexDisplay()}applyVertexEdit(e,t){if("vertex"===this.editModeType){if(this.applyToAllVertices)this.vertices.forEach(n=>{"size"===e?n.size=t:"label"===e?t&&t.trim()&&(this.vertices.find(e=>e.id!==n.id&&e.label===t.trim())||(n.label=t.trim())):n[e]=t}),this.updateStatus(`Applied ${e} to all vertices`),"label"===e&&this.selectedTargetVertex&&this.updateTargetVertexDisplay();else{if("size"===e)this.editModeElement.size=t;else if("label"===e){if(t&&t.trim()){if(this.vertices.find(e=>e.id!==this.editModeElement.id&&e.label===t.trim()))return void this.updateStatus(`Label "${t.trim()}" already exists!`);this.editModeElement.label=t.trim()}}else this.editModeElement[e]=t;this.updateStatus(`Updated vertex ${e}`),"label"===e&&this.selectedTargetVertex&&this.selectedTargetVertex.id===this.editModeElement.id&&this.updateTargetVertexDisplay()}this.draw(),this.updateEditModeInfo(),this.updateRootVertexDisplay()}}applyEdgeEdit(e,t){"edge"===this.editModeType&&(this.applyToAllEdges?(this.edges.forEach(n=>{n[e]=t}),this.updateStatus(`Applied ${e} to all edges`)):(this.editModeElement[e]=t,this.updateStatus(`Updated edge ${e}`)),this.draw(),this.updateEditModeInfo())}saveAndExitEditMode(){this.editModeElement&&this.editModeType&&(this.updateStatus(("vertex"===this.editModeType?"Vertex":"Edge")+" changes saved"),this.exitEditMode())}updateEditModeInfo(){if(!this.editModeElement||!this.editModeType)return;const e=document.getElementById("editModeInfo");if(e)if("vertex"===this.editModeType){const t=this.applyToAllVertices?'<div class="edit-mode-item" style="color: var(--warning-color); font-weight: 600;"><i class="fas fa-exclamation-triangle"></i> <strong>⚠️ APPLYING TO ALL VERTICES</strong></div>':"";e.innerHTML=`\n                ${t}\n                <div class="edit-mode-item">\n                    <i class="fas fa-circle"></i>\n                    <strong>Vertex:</strong> ${this.editModeElement.label}\n                </div>\n                <div class="edit-mode-item">\n                    <i class="fas fa-map-marker-alt"></i>\n                    <strong>Position:</strong> (${Math.round(this.editModeElement.x)}, ${Math.round(this.editModeElement.y)})\n                </div>\n                <div class="edit-mode-item">\n                    <i class="fas fa-expand-arrows-alt"></i>\n                    <strong>Size:</strong> ${this.editModeElement.size||this.vertexSize}\n                </div>\n            `}else if("edge"===this.editModeType){const t=this.applyToAllEdges?'<div class="edit-mode-item" style="color: var(--warning-color); font-weight: 600;"><i class="fas fa-exclamation-triangle"></i> <strong>⚠️ APPLYING TO ALL EDGES</strong></div>':"";e.innerHTML=`\n                ${t}\n                <div class="edit-mode-item">\n                    <i class="fas fa-minus"></i>\n                    <strong>Edge:</strong> ${this.editModeElement.from.label} → ${this.editModeElement.to.label}\n                </div>\n                <div class="edit-mode-item">\n                    <i class="fas fa-weight-hanging"></i>\n                    <strong>Weight:</strong> ${this.editModeElement.weight||"None"}\n                </div>\n            `}}enterEditMode(e){if(console.log("[EditMode] Entering edit mode for vertex:",e.label),this.selectedVertices.length>0&&(this.selectedVertices=[],this.flashingVertices.clear(),this.updateStatus("Edge creation cancelled - entering edit mode")),this.editModeElement&&"vertex"===this.editModeType)return void this.switchEditModeVertex(e);this.exitEditMode(),this.editModeElement=e,this.editModeType="vertex",this._editOriginal={label:e.label,size:e.size||this.vertexSize},this._editPreview={label:e.label,size:e.size||this.vertexSize,pendingDelete:!1},this._originalAllVertexSizes=this.vertices.map(e=>e.size||this.vertexSize),this._pendingChanges={deletedVertices:[],modifiedVertices:new Map,originalVertices:[...this.vertices],originalEdges:[...this.edges]},this.startShakeAnimation();const t=document.getElementById("themeToggle"),n=document.getElementById("mousePositionDisplay");t&&(t.style.display="none"),n&&(n.style.display="none");const r=document.getElementById("editControlsSection");r&&(r.style.display="block"),document.querySelectorAll(".control-section").forEach(e=>{"editControlsSection"!==e.id&&(e.style.display="none")});const i=r.querySelector("h3");i&&(i.innerHTML=`<i class="fas fa-edit"></i> Edit Vertex "${e.label}" <small style="color: var(--text-muted);">(Click other vertices to switch)</small>`);const o=document.getElementById("editVertexLabel"),a=document.getElementById("editVertexSize"),s=document.getElementById("editVertexSizeValue");o&&a&&s&&(o.value=e.label,a.value=e.size||this.vertexSize,s.textContent=e.size||this.vertexSize),o.style.borderColor="",o.style.boxShadow="";const d=document.getElementById("editVertexLabelWarning");d&&(d.textContent="");const l=document.getElementById("applyToAllToggle");l&&(l.checked=!1),setTimeout(()=>{o&&(o.focus(),o.select())},100),this._setupApplyToAllImmediateListeners(),this._updateEditPanelForPendingDelete(!1),this._updateDeleteButtonText(),this.draw()}switchEditModeVertex(e){console.log("[EditMode] Switching to vertex:",e.label),this.editModeElement&&this._editPreview&&(this.editModeElement.label=this._editPreview.label,this.editModeElement.size=this._editPreview.size,this._pendingChanges.modifiedVertices.set(this.editModeElement.id,{original:{...this._editOriginal},current:{...this._editPreview}})),this.editModeElement=e,this._editOriginal={label:e.label,size:e.size||this.vertexSize},this._editPreview={label:e.label,size:e.size||this.vertexSize,pendingDelete:!1};const t=document.querySelector("#editControlsSection h3");t&&(t.innerHTML=`<i class="fas fa-edit"></i> Edit Vertex "${e.label}" <small style="color: var(--text-muted);">(Click other vertices to switch)</small>`);const n=document.getElementById("editVertexLabel"),r=document.getElementById("editVertexSize"),i=document.getElementById("editVertexSizeValue");n&&r&&i&&(n.value=e.label,r.value=e.size||this.vertexSize,i.textContent=e.size||this.vertexSize),n.style.borderColor="",n.style.boxShadow="";const o=document.getElementById("editVertexLabelWarning");o&&(o.textContent="");const a=document.getElementById("applyToAllToggle");a&&(a.checked=!1),this._updateEditPanelForPendingDelete(!1),this._updateDeleteButtonText(),this.draw(),setTimeout(()=>{n&&(n.focus(),n.select())},100)}handleVertexDeletionInEditMode(){if(this.updateInfo(),this.updateRootVertexDisplay(),this.updateRootDropdown(),this.draw(),this.autosaveEnabled&&this.saveGraph(!0),0===this.vertices.length)return this.exitEditMode(),void this.updateStatus("No vertices left to edit - exiting edit mode");const e=this.findMostRecentVertex();e?(this.switchEditModeVertex(e),this.updateStatus(`Switched to editing vertex "${e.label}"`)):(this.exitEditMode(),this.updateStatus("No suitable vertex found - exiting edit mode"))}applyPendingChanges(){this._pendingChanges.deletedVertices.forEach(e=>{console.log(`[EditMode] Confirming deletion of vertex: ${e.label}`)}),this._pendingChanges.modifiedVertices.forEach((e,t)=>{const n=this.vertices.find(e=>e.id===t);n&&(n.label=e.current.label,n.size=e.current.size,console.log(`[EditMode] Applied modification to vertex: ${n.label}`))}),this._pendingChanges=null}revertPendingChanges(){this._pendingChanges&&(this._pendingChanges.deletedVertices.forEach(e=>{this.vertices.push(e.vertex),e.connectedEdges?(e.connectedEdges.forEach(e=>{this.edges.push(e)}),console.log(`[EditMode] Restored deleted vertex: ${e.label} with ${e.connectedEdges.length} connected edges`)):console.log(`[EditMode] Restored deleted vertex: ${e.label}`)}),this._pendingChanges.modifiedVertices.forEach((e,t)=>{const n=this.vertices.find(e=>e.id===t);n&&(n.label=e.original.label,n.size=e.original.size,console.log(`[EditMode] Reverted modification for vertex: ${n.label}`))}),this._originalAllVertexSizes&&this.vertices.forEach((e,t)=>{void 0!==this._originalAllVertexSizes[t]&&(e.size=this._originalAllVertexSizes[t])}),this.selectedTargetVertex&&this.selectedTargetVertex.id===this.editModeElement.id&&this.updateTargetVertexDisplay(),this._pendingChanges=null)}_setupApplyToAllImmediateListeners(){const e=document.getElementById("editVertexSize"),t=document.getElementById("applyToAllToggle");e&&t&&(this._applyToAllSizeListener&&e.removeEventListener("input",this._applyToAllSizeListener),this._applyToAllToggleListener&&t.removeEventListener("change",this._applyToAllToggleListener),this._applyToAllSizeListener=e=>{const n=parseInt(e.target.value);document.getElementById("editVertexSizeValue").textContent=n,this.editModeElement&&(this.editModeElement.size=n,t.checked&&this.vertices.forEach((e,t)=>{e!==this.editModeElement&&(e.size=n)}),this.draw())},e.addEventListener("input",this._applyToAllSizeListener),this._applyToAllToggleListener=t=>{const n=t.target.checked,r=parseInt(e.value);n?this.vertices.forEach((e,t)=>{e!==this.editModeElement&&(e.size=r)}):this.vertices.forEach((e,t)=>{e!==this.editModeElement&&this._originalAllVertexSizes&&(e.size=this._originalAllVertexSizes[t])}),this.draw()},t.addEventListener("change",this._applyToAllToggleListener))}exitEditMode(){this.stopShakeAnimation(),this.editModeElement=null,this.editModeType=null,this._editOriginal=null,this._editPreview=null,this._originalAllVertexSizes=null,this._pendingChanges=null;const e=document.getElementById("themeToggle"),t=document.getElementById("mousePositionDisplay");if(e&&(e.style.display="block"),t){const e=document.getElementById("mouseCoordinateToggle");e&&e.checked&&(t.style.display="block")}const n=document.getElementById("editControlsSection");n&&(n.style.display="none");const r=document.getElementById("deleteModePanel");r&&(r.style.display="none"),document.querySelectorAll(".control-section").forEach(e=>{"editControlsSection"!==e.id&&"deleteModePanel"!==e.id&&(e.style.display="block")});const i=n?.querySelector("h3");i&&(i.innerHTML='<i class="fas fa-edit"></i> Edit Vertex'),this.draw()}setupMinimalEditModeEvents(){const e=document.getElementById("editVertexLabel"),t=document.getElementById("saveVertexEdit");let n=document.getElementById("editVertexLabelWarning");n||(n=document.createElement("div"),n.id="editVertexLabelWarning",n.style.color="var(--danger-color)",n.style.fontSize="0.8rem",n.style.marginTop="0.25rem",n.style.fontWeight="500",e.parentElement.appendChild(n)),e.addEventListener("input",r=>{if(this.editModeElement&&this._editPreview&&!this._editPreview.pendingDelete){this._editPreview.label=r.target.value,this.draw(),this.updateRootDropdown();const i=r.target.value.trim();let o="";i?this.vertices.some(e=>e!==this.editModeElement&&e.label===i)&&(o=`Label "${i}" already exists! Each vertex must have a unique label.`):o="Label cannot be empty.",o?(e.style.borderColor="var(--danger-color)",e.style.boxShadow="0 0 0 3px rgba(239, 68, 68, 0.1)",n.textContent=o,t.disabled=!0):(e.style.borderColor="",e.style.boxShadow="",n.textContent="",t.disabled=!1)}}),document.getElementById("editVertexSize").addEventListener("input",e=>{if(this.editModeElement&&this._editPreview&&!this._editPreview.pendingDelete){const t=parseInt(e.target.value);document.getElementById("editVertexSizeValue").textContent=t,this._editPreview.size=t,this.draw()}}),document.getElementById("applyToAllToggle").addEventListener("change",e=>{const t=e.target.checked,n=parseInt(document.getElementById("editVertexSize").value);t?this.vertices.forEach(e=>{e!==this.editModeElement&&(e.size=n)}):this.vertices.forEach(e=>{if(e!==this.editModeElement&&this._originalAllVertexSizes){const t=this.vertices.findIndex(t=>t===e);-1!==t&&this._originalAllVertexSizes[t]&&(e.size=this._originalAllVertexSizes[t])}}),this.draw()}),t.addEventListener("click",e=>{if(e.preventDefault(),this.editModeElement&&this._editPreview){if(this._editPreview.pendingDelete){const e=this.editModeElement,t=e.label,n=this.edges.filter(t=>t.from.id===e.id||t.to.id===e.id);return this._pendingChanges.deletedVertices.push({vertex:e,label:t,connectedEdges:n}),this.edges=this.edges.filter(t=>t.from.id!==e.id&&t.to.id!==e.id),this.vertices=this.vertices.filter(t=>t.id!==e.id),this.updateStatus(`Vertex "${t}" marked for deletion`),void this.handleVertexDeletionInEditMode()}this.editModeElement.label=this._editPreview.label,this.editModeElement.size=this._editPreview.size,this._pendingChanges.modifiedVertices.set(this.editModeElement.id,{original:{...this._editOriginal},current:{...this._editPreview}}),this.applyPendingChanges(),this.selectedTargetVertex&&this.selectedTargetVertex.id===this.editModeElement.id&&this.updateTargetVertexDisplay(),this.updateStatus("All changes saved successfully!"),this.exitEditMode(),this.updateRootDropdown(),this.draw(),this.autosaveEnabled&&this.saveGraph(!0)}}),document.getElementById("cancelVertexEdit").addEventListener("click",e=>{if(e.preventDefault(),this.editModeElement&&this._editPreview){this.revertPendingChanges();const e=document.getElementById("editVertexLabel");e&&(e.style.borderColor="",e.style.boxShadow="");let t=document.getElementById("editVertexLabelWarning");t&&(t.textContent=""),this.exitEditMode(),this.updateRootDropdown(),this.draw(),this.updateStatus("Edit cancelled - all changes reverted.")}}),document.getElementById("vertexEditForm").addEventListener("submit",e=>{e.preventDefault(),t.click()}),e.addEventListener("keydown",e=>{"Enter"===e.key?(e.preventDefault(),t.click()):"Escape"===e.key&&(e.preventDefault(),document.getElementById("cancelVertexEdit").click())}),document.getElementById("deleteCurrentVertex").addEventListener("click",e=>{e.preventDefault(),this.editModeElement&&this._editPreview&&(this._editPreview.pendingDelete=!this._editPreview.pendingDelete,this._updateEditPanelForPendingDelete(this._editPreview.pendingDelete),this.draw())})}flashVertices(e,t){this.flashingVertices.add(e),this.flashingVertices.add(t),this.startFadeOutAnimation(e,t)}startFadeOutAnimation(e,t){const n=Date.now(),r=()=>{const i=Date.now()-n,o=Math.min(1,i/500),a=o;e.flashOpacity=a,t.flashOpacity=a,this.draw(),o<1?requestAnimationFrame(r):(this.flashingVertices.delete(e),this.flashingVertices.delete(t),delete e.flashOpacity,delete t.flashOpacity,this.draw())};requestAnimationFrame(r)}flashDistanceVertices(e,t){this.distanceFlashingVertices.add(e),this.distanceFlashingVertices.add(t),this.startDistanceFadeOutAnimation(e,t)}startDistanceFadeOutAnimation(e,t){const n=Date.now(),r=()=>{const i=Date.now()-n,o=Math.min(1,i/500),a=1-o;e.distanceFlashOpacity=a,t.distanceFlashOpacity=a,this.draw(),o<1?requestAnimationFrame(r):(this.distanceFlashingVertices.delete(e),this.distanceFlashingVertices.delete(t),delete e.distanceFlashOpacity,delete t.distanceFlashOpacity,this.draw())};requestAnimationFrame(r)}startVertexFadeInAnimation(e){const t=Date.now();e.fadeInOpacity=0;const n=()=>{const r=Date.now()-t,i=Math.min(1,r/800);e.fadeInOpacity=i,this.draw(),i<1?requestAnimationFrame(n):(delete e.fadeInOpacity,this.draw())};requestAnimationFrame(n)}editSavedGraphName(e,t){const n=this.savedGraphs[e];if(!n)return;const r=document.createElement("input");r.type="text",r.value=n.name,r.style.cssText="\n            width: 100%;\n            padding: 0.25rem 0.5rem;\n            border: 1px solid var(--primary-color);\n            border-radius: var(--radius-sm);\n            background: var(--bg-secondary);\n            color: var(--text-primary);\n            font-size: 0.875rem;\n            font-weight: 500;\n        ";const i=t.innerHTML;t.innerHTML="",t.appendChild(r),r.focus(),r.select();const o=()=>{const o=r.value.trim();if(o&&o!==n.name){if(this.savedGraphs.some((t,n)=>n!==e&&t.name===o))return void this.updateStatus(`Name "${o}" already exists!`);n.name=o,n.pendingRename=!0,t.innerHTML=o,this.updateStatus(`Graph renamed to "${o}" (pending save)`)}else t.innerHTML=i};r.addEventListener("blur",o),r.addEventListener("keydown",e=>{"Enter"===e.key?o():"Escape"===e.key&&(t.innerHTML=i)})}setupExpandableSections(){document.querySelectorAll(".expandable-header").forEach(e=>{e.addEventListener("click",t=>{const n=e.getAttribute("data-target"),r=document.getElementById(n),i=e.querySelector(".expand-icon");r&&i&&(r.classList.contains("show")?(r.classList.remove("show"),i.classList.remove("fa-chevron-down"),i.classList.add("fa-chevron-right")):(r.classList.add("show"),i.classList.remove("fa-chevron-right"),i.classList.add("fa-chevron-down")))})})}setupMouseCoordinateTracking(){this.canvas.addEventListener("mousemove",e=>{const t=this.getMousePos(e);this.mouseCoordinates=t,this.mouseOverCanvas=!0,this.updateMouseCoordinateDisplay()}),this.canvas.addEventListener("mouseenter",()=>{this.mouseOverCanvas=!0,this.updateMouseCoordinateDisplay()}),this.canvas.addEventListener("mouseleave",()=>{this.mouseOverCanvas=!1,this.updateMouseCoordinateDisplay()})}updateMouseCoordinateDisplay(){const e=document.getElementById("mouseCoordinates"),t=document.getElementById("mousePositionDisplay"),n=document.getElementById("mousePositionTop"),r=null!==document.querySelector(".draggable-panel.dragging");if(e)if(!this.showMouseCoordinates||r)e.textContent="";else if(this.mouseOverCanvas){const t=Math.round(this.mouseCoordinates.x),n=Math.round(this.mouseCoordinates.y);e.textContent=`(${t}, ${n})`}else e.textContent="";if(t&&n)if(this.showMouseCoordinates&&this.mouseOverCanvas&&!r){t.style.display="block";const e=Math.round(this.mouseCoordinates.x),r=Math.round(this.mouseCoordinates.y);n.textContent=`(${e}, ${r})`}else t.style.display="none"}updateGridSpacing(){this.gridSpacing=Math.max(10,110-this.gridDensity)}drawCoordinateGrid(){if(!this.showCoordinateGrid)return;const e=this.ctx,t=this.whiteBoxWidth,n=this.whiteBoxHeight;e.strokeStyle="dark"===this.currentTheme?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)",e.lineWidth=1;for(let r=0;r<=t;r+=this.gridSpacing)e.beginPath(),e.moveTo(r,0),e.lineTo(r,n),e.stroke();for(let r=0;r<=n;r+=this.gridSpacing)e.beginPath(),e.moveTo(0,r),e.lineTo(t,r),e.stroke()}markSavedGraphForDeletion(e){e>=0&&e<this.savedGraphs.length&&(this.savedGraphs[e].pendingDelete=!0,this.updateStatus('Graph marked for deletion. Click "Save Renames and Deletions" to confirm.'))}cancelDeleteSavedGraph(e){e>=0&&e<this.savedGraphs.length&&(this.savedGraphs[e].pendingDelete=!1,this.updateStatus("Graph deletion cancelled."))}commitAllChanges(){const e=this.savedGraphs.filter(e=>e.pendingDelete);this.currentGraphId&&e.some(e=>e.id===this.currentGraphId)&&(this.currentGraphId=null),this.savedGraphs=this.savedGraphs.filter(e=>!e.pendingDelete),this.savedGraphs.forEach(e=>{delete e.pendingDelete,delete e.pendingRename});try{localStorage.setItem("savedGraphs",JSON.stringify(this.savedGraphs)),this.updateSavedGraphsList();let t="";e.length>0&&(t+=`${e.length} graph(s) deleted`);const n=this.savedGraphs.filter(e=>e.pendingRename);n.length>0&&(t&&(t+=" and "),t+=`${n.length} graph(s) renamed`),t&&(t+=" successfully",this.updateStatus(t))}catch(e){console.error("Failed to save changes:",e),this.updateStatus("Failed to save changes")}}revertAllChanges(){this.originalSavedGraphs&&(this.savedGraphs=JSON.parse(JSON.stringify(this.originalSavedGraphs)),this.updateSavedGraphsList(),this.updateStatus("All changes reverted"))}deleteSavedGraph(e){if(!confirm("Are you sure you want to delete this saved graph?"))return;const t=this.savedGraphs.findIndex(t=>t.id===e);if(-1!==t){this.currentGraphId===e&&(this.currentGraphId=null),this.savedGraphs.splice(t,1);try{localStorage.setItem("savedGraphs",JSON.stringify(this.savedGraphs)),this.updateSavedGraphsList(),this.updateStatus("Saved graph deleted")}catch(e){console.error("Failed to delete saved graph:",e),this.updateStatus("Failed to delete saved graph")}}}showSharedConfirmation(e){if(this.pendingAction=e,"deleteAllGraphs"===e){if(0===this.savedGraphs.length)return void this.updateStatus("No saved graphs to delete");this.updateStatus(`Click confirm to delete all ${this.savedGraphs.length} saved graphs`)}else if("clearGraph"===e){if(0===this.vertices.length&&0===this.edges.length)return void this.updateStatus("Graph is already empty");this.updateStatus("Click confirm to clear the current canvas")}const t=document.getElementById("deleteAllGraphs"),n=document.getElementById("clearGraph"),r=document.getElementById("sharedConfirmation");t&&n&&r&&(t.style.display="none",n.style.display="none",r.style.setProperty("display","flex","important"))}hideSharedConfirmation(){const e=document.getElementById("deleteAllGraphs"),t=document.getElementById("clearGraph"),n=document.getElementById("sharedConfirmation");e&&t&&n&&(e.style.display="block",t.style.display="block",n.style.setProperty("display","none","important"),this.pendingAction=null)}confirmPendingAction(){"deleteAllGraphs"===this.pendingAction?this.confirmDeleteAllGraphs():"clearGraph"===this.pendingAction&&this.confirmClearGraph()}confirmDeleteAllGraphs(){const e=this.savedGraphs.length;try{this.currentGraphId&&this.savedGraphs.some(e=>e.id===this.currentGraphId)&&(this.currentGraphId=null),this.savedGraphs=[],localStorage.setItem("savedGraphs",JSON.stringify(this.savedGraphs)),this.updateSavedGraphsList(),this.hideSharedConfirmation(),this.updateStatus(`All ${e} saved graphs deleted`)}catch(e){console.error("Failed to delete all saved graphs:",e),this.updateStatus("Failed to delete saved graphs")}}confirmClearGraph(){this.vertices=[],this.edges=[],this.selectedVertices=[],this.targetVertex=null,this.distanceMode=!1,this.stopSearch(),this.exitEditMode(),this.flashingVertices.clear(),this.distanceFlashingVertices=null,this.rootUserSelected=!1,this.updateInfo(),this.updateRootVertexDisplay(),this.updateTargetVertexDisplay(),this.draw(),this.hideSharedConfirmation(),this.updateStatus("Current canvas cleared")}deleteAllSavedGraphs(){if(0===this.savedGraphs.length)return void this.updateStatus("No saved graphs to delete");const e=this.savedGraphs.length;if(confirm(`Are you sure you want to delete all ${e} saved graphs? This action cannot be undone.`))try{this.currentGraphId&&this.savedGraphs.some(e=>e.id===this.currentGraphId)&&(this.currentGraphId=null),this.savedGraphs=[],localStorage.setItem("savedGraphs",JSON.stringify(this.savedGraphs)),this.updateSavedGraphsList(),this.updateStatus(`All ${e} saved graphs deleted`)}catch(e){console.error("Failed to delete all saved graphs:",e),this.updateStatus("Failed to delete saved graphs")}}showContactModal(){document.getElementById("contactForm").reset(),new bootstrap.Modal(document.getElementById("contactModal")).show()}handleContactSubmit(){const e={name:document.getElementById("contactName").value,email:document.getElementById("contactEmail").value,subject:document.getElementById("contactSubject").value,message:document.getElementById("contactMessage").value};console.log("Contact form submitted:",e),this.updateStatus("Thank you for your message! I'll get back to you soon."),bootstrap.Modal.getInstance(document.getElementById("contactModal")).hide(),document.getElementById("contactForm").reset()}enterDeleteMode(){this.selectedVertices.length>0&&(this.selectedVertices=[],this.flashingVertices.clear(),this.updateStatus("Edge creation cancelled - entering delete mode")),this.isDeleteMode=!0,this.verticesToDelete=new Set,this.originalVertices=this.vertices.map(e=>({...e})),this.originalEdges=this.edges.map(e=>({...e})),document.body.classList.add("delete-mode-active"),document.getElementById("deleteNodesControls").style.display="none";const e=document.getElementById("themeToggle"),t=document.getElementById("mousePositionDisplay");e&&(e.style.display="none"),t&&(t.style.display="none"),this.showDeleteModePanel(),this.draw()}saveDeleteChanges(){this.vertices=this.vertices.filter(e=>!this.verticesToDelete.has(e.id)),this.edges=this.edges.filter(e=>!this.verticesToDelete.has(e.from.id)&&!this.verticesToDelete.has(e.to.id)),this.isDeleteMode=!1,this.verticesToDelete=new Set,document.body.classList.remove("delete-mode-active"),document.getElementById("deleteNodesControls").style.display="flex";const e=document.getElementById("themeToggle"),t=document.getElementById("mousePositionPanel");if(e&&(e.style.display="block"),t){const e=document.getElementById("mouseCoordinateToggle");e&&e.checked&&(t.style.display="block")}this.hideDeleteModePanel();const n=document.getElementById("editControlsSection");n&&(n.style.display="none"),document.querySelectorAll(".control-section").forEach(e=>{"editControlsSection"!==e.id&&"deleteModePanel"!==e.id&&(e.style.display="block")}),this.updateInfo(),this.updateRootVertexDisplay(),this.updateRootDropdown(),this.draw(),this.updateStatus("Deleted selected nodes"),this.autosaveEnabled&&this.saveGraph(!0)}cancelDeleteChanges(){this.vertices=this.originalVertices.map(e=>({...e})),this.edges=this.originalEdges.map(e=>({...e})),this.isDeleteMode=!1,this.verticesToDelete=new Set,document.body.classList.remove("delete-mode-active"),document.getElementById("deleteNodesControls").style.display="flex";const e=document.getElementById("themeToggle"),t=document.getElementById("mousePositionDisplay");if(e&&(e.style.display="block"),t){const e=document.getElementById("mouseCoordinateToggle");e&&e.checked&&(t.style.display="block")}this.hideDeleteModePanel();const n=document.getElementById("editControlsSection");n&&(n.style.display="none"),document.querySelectorAll(".control-section").forEach(e=>{"editControlsSection"!==e.id&&"deleteModePanel"!==e.id&&(e.style.display="block")}),this.updateInfo(),this.updateRootDropdown(),this.draw(),this.updateStatus("Cancelled node deletion")}showDeleteModePanel(){document.querySelectorAll(".control-section").forEach(e=>{"deleteModePanel"!==e.id&&(e.style.display="none")});const e=document.getElementById("deleteModePanel");e&&(e.style.display="block",this.updateDeleteModeInfo())}hideDeleteModePanel(){const e=document.getElementById("deleteModePanel");e&&(e.style.display="none"),document.querySelectorAll(".control-section").forEach(e=>{"deleteModePanel"!==e.id&&(e.style.display="block")})}updateDeleteModeInfo(){const e=document.getElementById("deleteModePanel");if(!e)return;const t=this.verticesToDelete.size,n=this.vertices.length,r=e.querySelector(".delete-mode-info-text");r&&(r.textContent=`Delete Mode Active - ${t} of ${n} vertices selected for deletion`);const i=e.querySelector(".selected-vertices-list");i&&(i.innerHTML="",this.vertices.forEach(e=>{if(this.verticesToDelete.has(e.id)){const t=document.createElement("div");t.className="selected-vertex-item",t.innerHTML=`\n                        <i class="fas fa-circle" style="color: #ec4899;"></i>\n                        <strong>${e.label}</strong>\n                        <span class="vertex-coords">(${Math.round(e.x)}, ${Math.round(e.y)})</span>\n                    `,i.appendChild(t)}}))}drawDeleteButton(e){let t=e.size||this.vertexSize;this.editModeElement===e&&this._editPreview&&(t=this._editPreview.size);const n=e.x+.7*t,r=e.y-.7*t;this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n,r,10,0,2*Math.PI),this.ctx.fillStyle="#ef4444",this.ctx.strokeStyle="#fff",this.ctx.lineWidth=2,this.ctx.fill(),this.ctx.stroke(),this.ctx.strokeStyle="#fff",this.ctx.lineWidth=2,this.ctx.beginPath(),this.ctx.moveTo(n-4,r-4),this.ctx.lineTo(n+4,r+4),this.ctx.moveTo(n+4,r-4),this.ctx.lineTo(n-4,r+4),this.ctx.stroke(),this.ctx.restore()}handleDeleteButtonClick(e){if(!this.isDeleteMode)return!1;for(const t of this.vertices){let n=t.size||this.vertexSize;this.editModeElement===t&&this._editPreview&&(n=this._editPreview.size);const r=t.x+.7*n,i=t.y-.7*n,o=10;if(Math.sqrt((e.x-r)**2+(e.y-i)**2)<=o)return this.verticesToDelete.has(t.id)?(this.verticesToDelete.delete(t.id),this.updateStatus(`Unselected vertex "${t.label}" from deletion`)):(this.verticesToDelete.add(t.id),this.updateStatus(`Marked vertex "${t.label}" for deletion`)),this.updateDeleteModeInfo(),this.draw(),!0}const t=this.getVertexAt(e.x,e.y);return!!t&&(this.verticesToDelete.has(t.id)?(this.verticesToDelete.delete(t.id),this.updateStatus(`Unselected vertex "${t.label}" from deletion`)):(this.verticesToDelete.add(t.id),this.updateStatus(`Marked vertex "${t.label}" for deletion`)),this.updateDeleteModeInfo(),this.draw(),!0)}toggleTimeDisplay(){const e=document.getElementById("digitalTime"),t=document.getElementById("analogClock");e&&t&&("digital"===this.timeDisplayMode?(this.timeDisplayMode="analog",e.style.display="none",t.style.display="inline-block"):(this.timeDisplayMode="digital",e.style.display="inline-block",t.style.display="none"),this.updateTime())}hasUnsavedRenameOrDeleteChanges(){return!0===this._pendingRenameOrDelete}saveRenamesAndDeletions(){this._pendingRenameOrDelete=!1,localStorage.setItem("savedGraphs",JSON.stringify(this.savedGraphs)),this.updateSavedGraphsList()}interpolateColor(e,t,n){const r=this.hexToRgb(e),i=this.hexToRgb(t);return`rgb(${Math.round(r.r+(i.r-r.r)*n)},${Math.round(r.g+(i.g-r.g)*n)},${Math.round(r.b+(i.b-r.b)*n)})`}hexToRgb(e){3===(e=e.replace("#","")).length&&(e=e.split("").map(e=>e+e).join(""));const t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:255&t}}_handleDeleteProximity(e,t){const n=document.getElementById("deleteNodesBtn");if(!n)return;const r=n.getBoundingClientRect(),i=e.clientX,o=e.clientY,a=Math.max(r.left,Math.min(i,r.right)),s=Math.max(r.top,Math.min(o,r.bottom)),d=Math.sqrt((i-a)**2+(o-s)**2);let l=!0;if(this.deleteProximityLastPos){const e=t.x-this.deleteProximityLastPos.x,n=t.y-this.deleteProximityLastPos.y;Math.sqrt(e*e+n*n)>8&&(l=!1)}this.deleteProximityLastPos={x:t.x,y:t.y},d<=300&&l?this.deleteProximityTimer||(this.deleteProximityStart=performance.now(),this.deleteProximityActive=!0,this.deleteProximityProgress=0,this.deleteProximityTimer=requestAnimationFrame(this._deleteProximityTick.bind(this))):this._clearDeleteProximity()}isPointNearQuadraticCurve(e,t,n,r,i,o,a,s,d){for(let l=0;l<=1;l+=1/32){const c=e-((1-l)*(1-l)*n+2*(1-l)*l*i+l*l*a),h=t-((1-l)*(1-l)*r+2*(1-l)*l*o+l*l*s);if(Math.sqrt(c*c+h*h)<=d)return!0}return!1}updateRootVertexDisplay(){const e=document.getElementById("rootVertexDisplay"),t=document.getElementById("searchRoot");0===this.vertices.length?(e.innerHTML='<span class="root-placeholder">Unselected</span>',e.classList.remove("has-root"),e.style.display="flex",t.style.display="none"):(t.style.display="block",e.style.display="none",this.updateRootDropdown())}updateRootDropdown(){const e=document.getElementById("searchRoot");if(!e)return;const t=e.value;if(e.innerHTML="",this.vertices.forEach(t=>{const n=document.createElement("option");n.value=t.label,n.textContent=t.label,e.appendChild(n)}),t&&Array.from(e.options).some(e=>e.value===t))e.value=t;else if(this.rootUserSelected)e.value="";else{const t=this.findMostRecentVertex();e.value=t?t.label:""}}}document.addEventListener("DOMContentLoaded",()=>{var e=document.getElementById("instructionsOverlay"),t=document.querySelector(".modal-content.instructions-content"),n=document.getElementById("closeInstructionsX"),r=document.getElementById("hideInstructions");function i(){e&&(e.classList.remove("show"),e.style.display="none"),document.querySelector(".app-container").classList.remove("instructions-active")}window.showInstructionsModal=function(){e&&(e.classList.add("show"),e.style.display="flex"),document.querySelector(".app-container").classList.add("instructions-active")},n&&n.addEventListener("click",i),r&&r.addEventListener("click",i),t&&t.addEventListener("click",function(e){e.target.closest("button, input, select, textarea, a")||i()});let o=[],a=Date.now(),s=0,d=!1,l=null;document.addEventListener("mousemove",e=>{!function(e,t){const n=Date.now(),r=n-a;if(o.length>0){const n=o[o.length-1],i=Math.sqrt(Math.pow(e-n.x,2)+Math.pow(t-n.y,2));s=i/r;const a=.95;s=s*a+s*(1-a),s=Math.min(s,2),s=Math.max(s,0)}o.push({x:e,y:t,time:n}),o.length>5&&o.shift(),a=n,d&&l&&function(e){if(!l)return;const t=Math.min(.5*e,1),n=240+20*e;l.style.setProperty("--glow-intensity",t),l.style.setProperty("--glow-hue",n)}(s)}(e.clientX,e.clientY)}),l=document.querySelector(".logo"),l&&(l.addEventListener("mouseenter",()=>{d=!0,l.classList.add("logo-hover")}),l.addEventListener("mouseleave",()=>{d=!1,l.classList.remove("logo-hover"),l.style.setProperty("--glow-intensity","0.3"),l.style.setProperty("--glow-hue","240")}));let c=null,h={x:0,y:0},g=new Map;let p=0,m={x:0,y:0},u=!1,v=null;const b=450;function y(e){const t=e.target.closest(".drag-handle-area");if(!t)return;const n=t.closest(".draggable-panel");if(!n)return;e.preventDefault(),e.stopPropagation(),p=Date.now(),m={x:e.clientX,y:e.clientY},u=!1,c=n;const r=n.getBoundingClientRect();h={x:e.clientX-r.left,y:e.clientY-r.top},c.setAttribute("data-dragging-sidebar",c.getAttribute("data-sidebar")),n.classList.add("holding"),v=setTimeout(()=>{c&&!u&&(u=!0,c.classList.remove("holding"),c.classList.add("dragging"),c.style.zIndex="1001",c.style.position="fixed",c.style.left=r.left+"px",c.style.top=r.top+"px",c.style.width=r.width+"px",c.style.opacity="0.8")},b)}function x(e){if(!c||!u)return;const t=e.clientX-h.x,n=e.clientY-h.y;c.style.left=t+"px",c.style.top=n+"px";const r=c.getAttribute("data-dragging-sidebar");let i;if("left"===r){const t=document.querySelector(".sidebar").getBoundingClientRect(),n=document.querySelector(".sidebar-content");i=S(e.clientY-t.top+n.scrollTop,"left"),E("left",i,c)}else if("right"===r){const t=document.querySelector(".right-sidebar").getBoundingClientRect(),n=document.querySelector(".right-sidebar-content");i=S(e.clientY-t.top+n.scrollTop,"right"),E("right",i,c)}}function w(e){if(c){if(v&&(clearTimeout(v),v=null),u){const t=c.getAttribute("data-dragging-sidebar");let n;if("left"===t){const t=document.querySelector(".sidebar").getBoundingClientRect(),r=document.querySelector(".sidebar-content");n=S(e.clientY-t.top+r.scrollTop,"left")}else if("right"===t){const t=document.querySelector(".right-sidebar").getBoundingClientRect(),r=document.querySelector(".right-sidebar-content");n=S(e.clientY-t.top+r.scrollTop,"right")}!function(e,t,n){const r=Array.from(document.querySelectorAll(".draggable-panel")).filter(e=>e.getAttribute("data-sidebar")===n);let i,o;"left"===n?(i=document.querySelector(".sidebar-content"),o=document.getElementById("scrollIndicator")):"right"===n&&(i=document.querySelector(".right-sidebar-content"),o=null);const a=r.map(e=>e.getAttribute("data-panel-id")),s=(document.getElementById(e),a.indexOf(e));s>-1&&a.splice(s,1),t>=a.length?a.push(e):a.splice(t,0,e);const d=a.map(e=>document.getElementById(e)).filter(Boolean);i.querySelectorAll(".draggable-panel").forEach(e=>e.remove()),"left"===n&&o&&o.remove(),d.forEach(e=>{i.appendChild(e)}),"left"===n&&o&&i.appendChild(o);const l=Array.from(document.querySelectorAll('.draggable-panel[data-sidebar="left"]')).map(e=>e.getAttribute("data-panel-id")),c=Array.from(document.querySelectorAll('.draggable-panel[data-sidebar="right"]')).map(e=>e.getAttribute("data-panel-id"));localStorage.setItem("leftSidebarPanelOrder",JSON.stringify(l)),localStorage.setItem("rightSidebarPanelOrder",JSON.stringify(c))}(c.getAttribute("data-panel-id"),n,t)}c.classList.remove("dragging","holding"),c.style.zIndex="",c.style.position="",c.style.left="",c.style.top="",c.style.width="",c.style.opacity="",c.style.transform="",M(),c.removeAttribute("data-dragging-sidebar"),c=null,u=!1}}function S(e,t){const n=document.querySelector(".draggable-panel.dragging"),r=Array.from(document.querySelectorAll(".draggable-panel")).filter(e=>e.getAttribute("data-sidebar")===t&&e!==n);let i,o;"left"===t?(i=document.querySelector(".sidebar-content"),o=document.getElementById("scrollIndicator")):"right"===t&&(i=document.querySelector(".right-sidebar-content"),o=null);const a=r.map(e=>{const t=e.getBoundingClientRect(),n=i.getBoundingClientRect();return{id:e.getAttribute("data-panel-id"),top:t.top-n.top+i.scrollTop,bottom:t.bottom-n.top+i.scrollTop}});for(let t=0;t<a.length;t++)if(e<a[t].top+(a[t].bottom-a[t].top)/2)return t;return a.length}function E(e,t,n){M();const r=Array.from(document.querySelectorAll(".draggable-panel")).filter(t=>t.getAttribute("data-sidebar")===e&&t!==n);if(0===r.length)return;const i=n.offsetHeight+16;0===t?k(r[0],"before",i):t>=r.length?k(r[r.length-1],"after",i):k(r[t-1],"after",i)}function k(e,t,n){const r=document.createElement("div");r.className="drop-preview",r.style.height=n+"px",r.style.margin="8px 0",r.style.border="2px dashed var(--primary-color)",r.style.borderRadius="8px",r.style.backgroundColor="rgba(99, 102, 241, 0.1)",r.style.transition="all 0.2s ease",r.style.position="relative",r.style.zIndex="999";const i=document.createElement("div");i.className="drop-indicator",i.style.position="absolute",i.style.left="50%",i.style.top="50%",i.style.transform="translate(-50%, -50%)",i.style.color="var(--primary-color)",i.style.fontSize="0.875rem",i.style.fontWeight="500",i.innerHTML='<i class="fas fa-plus"></i> Drop here',r.appendChild(i),"before"===t?e.parentNode.insertBefore(r,e):e.parentNode.insertBefore(r,e.nextSibling)}function M(){document.querySelectorAll(".drop-preview").forEach(e=>e.remove())}setTimeout(()=>{[{id:"basicControlsSection",title:"Controls",sidebar:"left"},{id:"editControlsSection",title:"Edit Vertex",sidebar:"left"},{id:"deleteModePanel",title:"Delete Mode",sidebar:"left"},{id:"searchSection",title:"Search Algorithms",sidebar:"left"},{id:"saveExportSection",title:"Save & Export",sidebar:"right"},{id:"canvasManagementSection",title:"Canvas Management",sidebar:"right"},{id:"utilitiesSection",title:"Utilities",sidebar:"right"}].forEach(e=>{const t=document.getElementById(e.id);if(t){t.classList.add("draggable-panel"),t.setAttribute("data-panel-id",e.id),t.setAttribute("data-panel-title",e.title),t.setAttribute("data-sidebar",e.sidebar),t.style.position="relative";const n=t.querySelector(".drag-handle-area");n&&(n.classList.add("panel-drag-handle"),n.style.cursor="grab"),g.set(e.id,{element:t,rect:t.getBoundingClientRect()})}}),document.addEventListener("mousedown",y),document.addEventListener("mousemove",x),document.addEventListener("mouseup",w),function(){const e=localStorage.getItem("panelOrder");if(e)try{JSON.parse(e),localStorage.setItem("leftSidebarPanelOrder",e),localStorage.removeItem("panelOrder")}catch(e){console.error("Failed to migrate old panel order:",e)}const t=localStorage.getItem("leftSidebarPanelOrder");if(t)try{const e=JSON.parse(t),n=document.querySelector(".sidebar-content"),r=e.map(e=>document.getElementById(e)).filter(Boolean);n.querySelectorAll('.draggable-panel[data-sidebar="left"]').forEach(e=>e.remove()),r.forEach(e=>{n.appendChild(e)})}catch(e){console.error("Failed to load left sidebar panel order:",e)}const n=localStorage.getItem("rightSidebarPanelOrder");if(n)try{const e=JSON.parse(n),t=document.querySelector(".right-sidebar-content"),r=e.map(e=>document.getElementById(e)).filter(Boolean);t.querySelectorAll('.draggable-panel[data-sidebar="right"]').forEach(e=>e.remove()),r.forEach(e=>{t.appendChild(e)})}catch(e){console.error("Failed to load right sidebar panel order:",e)}}()},100),new f})})();